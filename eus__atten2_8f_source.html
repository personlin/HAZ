<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HAZ: D:/Git/HAZ/HAZ files/eus_atten2.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HAZ
   &#160;<span id="projectnumber">45.2</span>
   </div>
   <div id="projectbrief">Probabilistic Seismic Hazard Analysis written by Norm Abrahamson.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('eus__atten2_8f_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">eus_atten2.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="eus__atten2_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">C     Various CEUS attenuation Models</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">C *** Silva et al. (2002) 2-Corner, Horizontal *************</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                                                                        <span class="comment">       </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a3ee501c18b63c599d10680c0ca5890db">pea2c</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a3ee501c18b63c599d10680c0ca5890db">    9</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                                                        <span class="comment">       </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      <span class="keywordtype">character*80</span> attenName </div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      </div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)  </div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                                                                        <span class="comment">                                                                                        </span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">      </span><span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">     1              0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">     1              0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 3.54103, 5.06834, 5.03119, 4.86717, 4.69293, 4.0767, 3.9<span class="comment">9907, 3.92454, 3.7751,</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">     1          3.624, 3.30684, 2.60454, 2.14018, 1.99361, 1.42831, 0.86777, 0.1092, -0.96872,</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">     1         -1.95968, -3.77355, -5.47019, -7.68301, -8.7688, -11.04809, -13.88893, -17.74463 /</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.18904, 0.14806, 0.15779, 0.17018, 0.18262, 0.22547, 0.<span class="comment">23357, 0.24169, 0.25773,</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">     1          0.27369, 0.30373, 0.35667, 0.39715, 0.41219, 0.46988, 0.52085, 0.59537, 0.7137,</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">     1          0.8081, 0.98718, 1.1259, 1.34978, 1.452, 1.64665, 1.89859, 2.22485 /</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.7, 2.8, 2.8, 2.8, 2.8, 2.7, 2.7, 2.7, 2.7,</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;     1          2.7, 2.7, 2.6, 2.6, 2.6, 2.6, 2.6, 2.6, 2.6,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;     1          2.6, 2.6, 2.5, 2.5, 2.5, 2.4, 2.3, 2.1 /</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keyword">data</span> c6 / -2.97418, -3.08409, -3.06134, -3.03252, -3.00672, -2.900<span class="comment">4, -2.88734, -2.87495, -2.85226,</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">     1          -2.83163, -2.79751, -2.69927, -2.66676, -2.6551, -2.6138, -2.58506, -2.5412, -2.465,</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">     1          -2.41132, -2.28113, -2.13473, -1.94573, -1.86494, -1.7001, -1.54772, -1.40084 /</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.19819, 0.19935, 0.19746, 0.1956, 0.19396, 0.1872, 0.18<span class="comment">619, 0.18521, 0.18339,</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">     1          0.1817, 0.17893, 0.17238, 0.16973, 0.16868, 0.16486, 0.16235, 0.15808, 0.15003,</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">     1          0.14449, 0.13007, 0.1171, 0.09603, 0.08722, 0.07272, 0.06068, 0.05305 /</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.05814, -0.05361, -0.05377, -0.05434, -0.0552, -0.056<span class="comment">47, -0.05717, -0.05791, -0.05952,</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">     1          -0.06128, -0.06512, -0.06929, -0.07573, -0.07801, -0.08671, -0.09484, -0.10506, -0.11749,</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">     1          -0.12529, -0.13323, -0.1383, -0.16127, -0.18125, -0.22943, -0.2896, -0.31641 /</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c      data sigma / 0.84, 0.8939, 0.8902, 0.8869, 0.8795, 0.8675, 0.8604, 0.8602, 0.8521,</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">c     1          0.8476, 0.8468, 0.8485, 0.8339, 0.829, 0.826, 0.8272, 0.8358, 0.832,</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c     1          0.8426, 0.8815, 0.8739, 0.945, 1.0095, 1.0871, 1.2228, 1.3429 /</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keyword">data</span> sigma / 0.7353, 0.7776, 0.7823, 0.7858, 0.7817, 0.7711, 0.764<span class="comment">4, 0.7656, 0.7585,</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">     1       0.7534, 0.7507, 0.7503, 0.7328, 0.7271, 0.7247, 0.7274, 0.7395, 0.7396,</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">     1       0.7551, 0.805, 0.8021, 0.8874, 0.9591, 1.0462, 1.1933, 1.3243 /</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      nper = 26</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;               count1 = i</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;               count2 = i+1</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        </div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 2 Corner atttenuation model&#39;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      stop 99</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 2-Corner&#39;</span>                      </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">C *** Silva et al. (2002) 2-Corner-Saturation, Horizontal *************</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a083d76574f09ec6b9d1ccd534f8ac598">pea2cs</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a083d76574f09ec6b9d1ccd534f8ac598">  121</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span>      </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordtype">character*80</span> attenName</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26) </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)          <span class="comment">                                                                         </span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">      </span><span class="keyword">data</span> period /0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, 0<span class="comment">.07,</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 5.91196, 7.55648, 7.51145, 7.33736, 6.61204, 6.42423, 6.<span class="comment">34238, 6.26384, 6.10708,</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">     1       5.94942, 5.13706, 4.81663, 4.34277, 4.19281, 3.61568, 3.04705, 2.27626, 1.17695,</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">     1       0.17104, -1.6801, -3.10841, -5.75016, -6.86049, -9.24347, -12.1791, -16.16329 /</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.15727, -0.20898, -0.19862, -0.18563, -0.1337, -0.1172<span class="comment">6, -0.10886, -0.10044, -0.08387,</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">     1       -0.06741, -0.00173, 0.02793, 0.06911, 0.08441, 0.14311, 0.19471, 0.27031, 0.39078,</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">     1       0.48663, 0.66971, 0.79561, 1.05061, 1.15548, 1.36201, 1.62451, 1.96535 /</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.9, 3, 3, 3, 2.9, 2.9, 2.9, 2.9, 2.9,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;     1       2.9, 2.8, 2.8, 2.8, 2.8, 2.8, 2.8, 2.8, 2.8,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     1       2.8, 2.8, 2.8, 2.7, 2.7, 2.6, 2.5, 2.3 /</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keyword">data</span> c6 / -3.42401, -3.55306, -3.52888, -3.49824, -3.37593, -3.346<span class="comment">04, -3.33222, -3.31911, -3.29509,</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">     1       -3.27328, -3.15185, -3.12224, -3.08805, -3.07579, -3.03239, -3.00223, -2.95623, -2.87626,</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">     1       -2.81997, -2.68318, -2.58562, -2.32003, -2.23472, -2.05193, -1.88291, -1.71374 /</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.26564, 0.26853, 0.26652, 0.26456, 0.25613, 0.25401, 0.<span class="comment">25295, 0.25192, 0.25,</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">     1       0.24822, 0.23929, 0.23686, 0.23409, 0.233, 0.229, 0.22639, 0.22193, 0.21352,</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">     1       0.20773, 0.19261, 0.18195, 0.1554, 0.1461, 0.12954, 0.11564, 0.10547 /</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.07004, -0.06551, -0.06568, -0.06625, -0.06711, -0.06<span class="comment">838, -0.06908, -0.06982, -0.07142,</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">     1       -0.07318, -0.07703, -0.08119, -0.08764, -0.08991, -0.09861, -0.10675, -0.11697, -0.1294,</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">     1       -0.13719, -0.14513, -0.1502, -0.17317, -0.19315, -0.24133, -0.3015, -0.32832 /</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">c      data sigma / 0.84, 0.8939, 0.8902, 0.8869, 0.8795, 0.8675, 0.8604, 0.8602, 0.8521,</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">c     1       0.8476, 0.8468, 0.8485, 0.8339, 0.829, 0.826, 0.8272, 0.8358, 0.832,</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">c     1       0.8426, 0.8815, 0.8739, 0.945, 1.0095, 1.0871, 1.2228, 1.3429 /</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keyword">data</span> sigma / 0.7353, 0.7776, 0.7823, 0.7858, 0.7817, 0.7711, 0.764<span class="comment">4, 0.7656, 0.7585,</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">     1       0.7534, 0.7507, 0.7503, 0.7328, 0.7271, 0.7247, 0.7274, 0.7395, 0.7396,</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">     1       0.7551, 0.805, 0.8021, 0.8874, 0.9591, 1.0462, 1.1933, 1.3243 /</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">                                                                                    </span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      nper = 26</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;               count1 = i</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;               count2 = i+1</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 2 Corner-Sat atttenuation model&#39;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      stop 99</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 2-Corner-Sat&#39;</span>                    <span class="comment">  </span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Variable-High, Horizontal *************</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#aee3e307f8f053d4a73c840ae7a03a9ed">pea1cvh</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#aee3e307f8f053d4a73c840ae7a03a9ed">  233</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T     </div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordtype">character*80</span> attenName </div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                             <span class="comment">                                        </span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)          <span class="comment">                                                           </span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">      </span><span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 5.19757, 7.3541, 6.75933, 6.5773, 6.39121, 6.20019, 6.11<span class="comment">753, 6.03843, 5.41104,</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">     1       5.25826, 4.94207, 4.63032, 4.17095, 4.02502, 3.46126, 2.49641, 1.72806, 0.58917,</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">     1       -0.51056, -2.67167, -4.46472, -7.70148, -9.12315, -11.97362, -15.20886, -18.80138 /</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.07129, -0.00721, 0.03739, 0.05102, 0.06416, 0.08062, 0<span class="comment">.08905, 0.09752, 0.14236,</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">     1       0.15855, 0.18877, 0.21818, 0.25933, 0.27487, 0.33544, 0.41405, 0.49782, 0.63923,</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">     1       0.76645, 1.03112, 1.24156, 1.62326, 1.78482, 2.06358, 2.3499, 2.59958 /</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.8, 3, 2.9, 2.9, 2.9, 2.9, 2.9, 2.9, 2.8,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     1       2.8, 2.8, 2.8, 2.8, 2.8, 2.8, 2.7, 2.7, 2.7,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;     1       2.7, 2.7, 2.7, 2.6, 2.6, 2.5, 2.4, 2.3 /</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keyword">data</span> c6 / -3.13247, -3.35245, -3.23117, -3.1992, -3.17073, -3.1389<span class="comment">8, -3.12417, -3.11001, -3.0004,</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">     1       -2.97721, -2.93847, -2.90541, -2.86633, -2.85216, -2.80186, -2.69325, -2.64087, -2.5519,</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">     1       -2.48971, -2.34731, -2.25138, -2.01584, -1.94059, -1.77626, -1.62679, -1.51629 /</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.20485, 0.21111, 0.203, 0.20091, 0.19905, 0.19672, 0.19<span class="comment">554, 0.19437, 0.18726,</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">     1       0.18528, 0.18204, 0.17924, 0.17597, 0.17467, 0.16992, 0.16254, 0.1574, 0.14804,</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">     1       0.14173, 0.12639, 0.11635, 0.0946, 0.08684, 0.07329, 0.0623, 0.05717 /</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.07375, -0.06367, -0.06354, -0.06426, -0.06525, -0.06<span class="comment">658, -0.06731, -0.06812, -0.06993,</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">     1       -0.072, -0.07672, -0.08205, -0.09083, -0.09403, -0.10713, -0.12105, -0.1416, -0.17378,</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">     1       -0.20549, -0.26186, -0.30377, -0.357, -0.37239, -0.38117, -0.35359, -0.25763 /</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.7405, 0.7829, 0.7873, 0.7907, 0.7866, 0.7758, 0.769<span class="comment">1, 0.7703, 0.7629,</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">     1       0.7578, 0.7549, 0.7543, 0.7369, 0.7311, 0.7289, 0.7317, 0.7441, 0.7445,</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">     1       0.7601, 0.8085, 0.8032, 0.8847, 0.9557, 1.0436, 1.1928, 1.325 /</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">                                                                </span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      nper = 26</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;               count1 = i</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;               count2 = i+1</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Var-High atttenuation model&#39;</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      stop 99</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Var-High&#39;</span>               <span class="comment">       </span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Variable-Med, Horizontal *************</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a9abbbaeb6304476dddb73f3147fe90dd">pea1cvm</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a9abbbaeb6304476dddb73f3147fe90dd">  342</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=27)                                                      </span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)          <span class="comment">                     </span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">      </span><span class="keyword">data</span> period / 0.00, 0.01, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, <span class="comment">0.06, 0.07,</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 4.0393, 4.0393, 6.07941, 6.02744, 5.37895, 5.2089, 5.038<span class="comment">67, 4.96669, 4.89845, 4.33334,</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">     1       4.20238, 3.92885, 3.65946, 3.26041, 3.13556, 2.27495, 1.79388, 1.12628, 0.13162,</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">     1       -0.84738, -2.82095, -4.51914, -7.60788, -9.00041, -11.84462, -15.15004, -19.07223 /</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.10412, 0.10412, 0.03289, 0.04417, 0.08559, 0.09698, 0.<span class="comment">11102, 0.11815, 0.12529, 0.16542,</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">     1       0.17878, 0.20331, 0.22693, 0.25961, 0.2722, 0.344, 0.38804, 0.45746, 0.5789,</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">     1       0.6896, 0.93101, 1.1322, 1.50586, 1.66899, 1.96, 2.27308, 2.57205 /</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.7, 2.7, 2.9, 2.9, 2.8, 2.8, 2.8, 2.8, 2.8, 2.7,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;     1       2.7, 2.7, 2.7, 2.7, 2.7, 2.6, 2.6, 2.6, 2.6,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;     1       2.6, 2.6, 2.6, 2.5, 2.5, 2.4, 2.3, 2.1 /</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keyword">data</span> c6 / -2.97465, -2.97465, -3.18403, -3.15877, -3.04366, -3.017<span class="comment">42, -2.98849, -2.97508, -2.9623, -2.86188,</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">     1       -2.84105, -2.8063, -2.7766, -2.74131, -2.72838, -2.61448, -2.58195, -2.53338, -2.45001,</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">     1       -2.39187, -2.25774, -2.16445, -1.94031, -1.86794, -1.70638, -1.55609, -1.41166 /</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.19631, 0.19631, 0.20265, 0.20038, 0.19337, 0.19172, 0.<span class="comment">18968, 0.18865, 0.18763, 0.1811,</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">     1       0.17938, 0.17658, 0.17414, 0.17129, 0.17012, 0.16182, 0.15895, 0.1542, 0.14539,</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">     1       0.13949, 0.12494, 0.11502, 0.09384, 0.08623, 0.07232, 0.06043, 0.05292 /</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.08874, -0.08874, -0.08044, -0.08027, -0.08079, -0.08<span class="comment">15, -0.08242, -0.08293, -0.08349, -0.08477,</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">     1       -0.08624, -0.08961, -0.09345, -0.09985, -0.10222, -0.11211, -0.12283, -0.1393, -0.16638,</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">     1       -0.19435, -0.24823, -0.29235, -0.35415, -0.37576, -0.39806, -0.38898, -0.31205 /</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.7353, 0.7353, 0.7776, 0.7823, 0.7858, 0.7817, 0.771<span class="comment">1, 0.7644, 0.7656, 0.7585,</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">     1       0.7534, 0.7507, 0.7503, 0.7328, 0.7271, 0.7247, 0.7274, 0.7395, 0.7396,</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">     1       0.7551, 0.805, 0.8021, 0.8874, 0.9591, 1.0462, 1.1933, 1.3243 /</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">                                                                      </span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      nper = 27</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;               count1 = i</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;               count2 = i+1</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        </div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Var-Med atttenuation model&#39;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      stop 99</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Var-Med&#39;</span>                <span class="comment">      </span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Variable-Low, Horizontal *************</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a4c3fdf163e0d79bcdef0b1edab41bcc3">pea1cvl</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a4c3fdf163e0d79bcdef0b1edab41bcc3">  451</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)          <span class="comment">                     </span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">      </span><span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 3.42714, 5.43661, 5.39249, 4.76103, 4.60063, 4.44314, 4.<span class="comment">37793, 4.31663, 3.7718,</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">     1       3.65547, 3.41148, 3.1727, 2.81889, 2.71047, 1.91753, 1.4958, 0.91358, 0.04301,</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">     1       -0.82196, -2.60545, -4.48436, -7.14902, -8.74448, -11.5582, -14.90966, -18.82818 /</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.10323, 0.03559, 0.04598, 0.08583, 0.09599, 0.1084, 0.1<span class="comment">1466, 0.12089, 0.15884,</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">     1       0.17022, 0.19064, 0.2099, 0.23601, 0.24622, 0.30871, 0.34395, 0.40083, 0.50444,</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">     1       0.59874, 0.81461, 1.01787, 1.36498, 1.53854, 1.83734, 2.17243, 2.50853 /</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.7, 2.9, 2.9, 2.8, 2.8, 2.8, 2.8, 2.8, 2.7,</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;     1       2.7, 2.7, 2.7, 2.7, 2.7, 2.6, 2.6, 2.6, 2.6,</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;     1       2.6, 2.6, 2.5, 2.5, 2.4, 2.3, 2.2, 2.1 /</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">data</span> c6 / -2.91721, -3.12848, -3.10501, -2.99272, -2.96783, -2.940<span class="comment">65, -2.92815, -2.91626, -2.81861,</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">     1       -2.79941, -2.76748, -2.74034, -2.70814, -2.69634, -2.58706, -2.55688, -2.51171, -2.43239,</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">     1       -2.37729, -2.24962, -2.10529, -1.93736, -1.82313, -1.66484, -1.51375, -1.39437 /</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.19218, 0.19893, 0.19687, 0.19011, 0.18862, 0.18679, 0.<span class="comment">18586, 0.18495, 0.17867,</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">     1       0.17715, 0.17469, 0.17258, 0.17011, 0.16908, 0.16126, 0.15868, 0.15434, 0.14596,</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">     1       0.1404, 0.12651, 0.11396, 0.09559, 0.08612, 0.07203, 0.05943, 0.05155 /</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.09443, -0.0876, -0.08744, -0.08783, -0.08835, -0.089<span class="comment">01, -0.08938, -0.08978, -0.0907,</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">     1       -0.09175, -0.09418, -0.09693, -0.10154, -0.10327, -0.11059, -0.11864, -0.13143, -0.15344,</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">     1       -0.17695, -0.22591, -0.26954, -0.33624, -0.36309, -0.39809, -0.40726, -0.35284 /</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.7366, 0.779, 0.7837, 0.7873, 0.7833, 0.7729, 0.7662<span class="comment">, 0.7676, 0.7605,</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">     1       0.7556, 0.7531, 0.7529, 0.7357, 0.73, 0.7278, 0.7305, 0.7425, 0.7423,</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">     1       0.7574, 0.8073, 0.8056, 0.8932, 0.9656, 1.0524, 1.1969, 1.3261 /</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      nper = 26</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;               count1 = i</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;               count2 = i+1</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Var-Low atttenuation model&#39;</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      stop 99</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Var-Low&#39;</span>                <span class="comment">      </span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-High, Horizontal *************</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a8c0b6edb5f7a8492f657ac34d7106c29">pea1cch</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a8c0b6edb5f7a8492f657ac34d7106c29">  560</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)          <span class="comment">                     </span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">      </span><span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 3.52033, 5.57118, 5.51533, 4.86194, 4.68655, 4.50882, 4.<span class="comment">43278, 4.36033, 4.21631,</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">     1       3.64678, 3.35414, 3.06506, 2.63659, 2.50153, 1.97802, 1.08397, 0.36441, -0.70305,</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">     1       -1.74607, -3.81429, -5.55701, -8.68001, -10.06892, -12.85572, -16.02752, -19.70343 /</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.27213, 0.19995, 0.21155, 0.25301, 0.26499, 0.2799, 0.2<span class="comment">8752, 0.29517, 0.31022,</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">     1       0.35047, 0.37757, 0.40391, 0.44078, 0.4548, 0.5097, 0.58122, 0.65805, 0.78942,</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">     1       0.90876, 1.16106, 1.36536, 1.73516, 1.8928, 2.16545, 2.44418, 2.68814 /</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.7, 2.9, 2.9, 2.8, 2.8, 2.8, 2.8, 2.8, 2.8,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;     1       2.7, 2.7, 2.7, 2.7, 2.7, 2.7, 2.6, 2.6, 2.6,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;     1       2.6, 2.6, 2.6, 2.5, 2.5, 2.4, 2.3, 2.1 /</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keyword">data</span> c6 / -2.98288, -3.18948, -3.16325, -3.04739, -3.02045, -2.990<span class="comment">56, -2.97664, -2.96337, -2.93884,</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">     1       -2.84039, -2.80403, -2.77296, -2.73607, -2.72265, -2.67484, -2.57366, -2.52362, -2.4384,</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">     1       -2.37871, -2.24164, -2.14802, -1.92392, -1.85191, -1.69535, -1.55334, -1.41959 /</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.19476, 0.20062, 0.19826, 0.19126, 0.18954, 0.18741, 0.<span class="comment">18632, 0.18525, 0.18324,</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">     1       0.17689, 0.17391, 0.17133, 0.16829, 0.16707, 0.16259, 0.15569, 0.1508, 0.14185,</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">     1       0.13582, 0.12109, 0.11128, 0.0906, 0.08324, 0.07035, 0.06006, 0.05456 /</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.05886, -0.04972, -0.04959, -0.05023, -0.05109, -0.05<span class="comment">224, -0.05287, -0.05357, -0.05514,</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">     1       -0.05692, -0.06102, -0.06565, -0.07333, -0.07615, -0.08779, -0.10026, -0.11897, -0.14883,</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">     1       -0.17883, -0.23358, -0.27558, -0.32977, -0.34592, -0.35582, -0.32899, -0.23554 /</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.714, 0.7757, 0.7803, 0.7837, 0.7795, 0.7687, 0.7619<span class="comment">, 0.763, 0.7556,</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">     1       0.7505, 0.7474, 0.7468, 0.7288, 0.7228, 0.72, 0.7223, 0.734, 0.7332,</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">     1       0.7482, 0.7972, 0.7931, 0.8786, 0.9514, 1.0412, 1.1907, 1.3212 /</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      nper = 26</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;               count1 = i</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;               count2 = i+1</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        </div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-High atttenuation model&#39;</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      stop 99</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Const-High&#39;</span>             <span class="comment">         </span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Medium, Horizontal *************</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a9a305f9c42f7889b6b2e3e5ce4e1ea36">pea1ccm</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a9a305f9c42f7889b6b2e3e5ce4e1ea36">  669</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)    </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                           </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">     1        0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">     1        0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 3.0073, 5.0311, 4.9836, 4.34502, 4.18017, 4.01659, 3.948<span class="comment">14, 3.88344, 3.75552,</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">     1        3.20588, 2.9469, 2.69216, 2.31425, 2.19706, 1.74233, 0.91433, 0.2849, -0.65379,</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">     1        -1.58285, -3.4733, -5.12369, -8.14308, -9.51015, -12.32672, -15.60343, -19.48096 /</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.25858, 0.19, 0.20066, 0.24062, 0.25125, 0.26433, 0.270<span class="comment">96, 0.27758, 0.29046,</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">     1        0.32832, 0.35069, 0.37212, 0.40161, 0.41304, 0.45792, 0.51993, 0.58358, 0.69665,</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">     1        0.79993, 1.02939, 1.22405, 1.58833, 1.74832, 2.03581, 2.34394, 2.63369 /</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.7, 2.9, 2.9, 2.8, 2.8, 2.8, 2.8, 2.8, 2.8,</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     1        2.7, 2.7, 2.7, 2.7, 2.7, 2.7, 2.6, 2.6, 2.6,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;     1        2.6, 2.6, 2.6, 2.5, 2.5, 2.4, 2.3, 2.1 /</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keyword">data</span> c6 / -2.94208, -3.15204, -3.12766, -3.01413, -2.98855, -2.960<span class="comment">45, -2.94748, -2.93512, -2.91238,</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">     1        -2.81616, -2.78273, -2.75418, -2.72023, -2.70779, -2.66338, -2.56449, -2.5173, -2.4357,</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">     1        -2.37885, -2.24741, -2.15471, -1.93245, -1.86136, -1.70046, -1.55118, -1.40816 /</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.19152, 0.1979, 0.19576, 0.18897, 0.18741, 0.18549, 0.1<span class="comment">8451, 0.18355, 0.18175,</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">     1        0.17563, 0.173, 0.17072, 0.16804, 0.16694, 0.16286, 0.15619, 0.15162, 0.14303,</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">     1        0.13729, 0.12308, 0.11324, 0.09238, 0.08496, 0.07122, 0.0596, 0.05251 /</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.05571, -0.04818, -0.04804, -0.0485, -0.04913, -0.049<span class="comment">94, -0.05038, -0.05087, -0.05199,</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">     1        -0.05326, -0.05619, -0.05952, -0.06508, -0.06715, -0.07586, -0.08536, -0.10016, -0.12494,</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">     1        -0.1509, -0.20234, -0.24573, -0.30768, -0.33001, -0.35378, -0.3457, -0.27037 /</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.7329, 0.7754, 0.7802, 0.7837, 0.7797, 0.7691, 0.762<span class="comment">4, 0.7636, 0.7565,</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">     1        0.7515, 0.7487, 0.7483, 0.7308, 0.7249, 0.7224, 0.7248, 0.7365, 0.7357,</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">     1        0.7506, 0.8, 0.7972, 0.8842, 0.957, 1.0451, 1.1924, 1.3226 /</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">                                                                   </span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      nper = 26</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;               count1 = i</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;               count2 = i+1</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Med atttenuation model&#39;</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      stop 99</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Const-Med&#39;</span>              <span class="comment">        </span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Low, Horizontal *************</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#af6190c9108c5f62da7b4f165c915863f">pea1ccl</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00778"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#af6190c9108c5f62da7b4f165c915863f">  778</a></span>&#160;<span class="comment">    </span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span> </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                                                        <span class="comment">       </span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper) </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                              </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 2.57877, 4.54101, 4.50286, 3.90146, 3.74605, 3.59389, 3.<span class="comment">53102, 3.47181, 2.95159,</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">     1       2.83795, 2.59748, 2.36108, 2.00886, 1.90139, 1.13055, 0.71018, 0.13269, -0.72368,</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">     1       -1.58102, -3.33687, -4.89906, -7.79761, -9.12644, -11.90955, -15.22296, -19.09237 /</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.20187, 0.13536, 0.14513, 0.18325, 0.19303, 0.205, 0.21<span class="comment">106, 0.21711, 0.25367,</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">     1       0.26482, 0.28497, 0.30408, 0.33012, 0.34023, 0.40133, 0.43636, 0.49251, 0.59402,</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">     1       0.68709, 0.89916, 1.0839, 1.44039, 1.60015, 1.89523, 2.22463, 2.55127 /</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.6, 2.8, 2.8, 2.7, 2.7, 2.7, 2.7, 2.7, 2.6,</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;     1       2.6, 2.6, 2.6, 2.6, 2.6, 2.5, 2.5, 2.5, 2.5,</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;     1       2.5, 2.5, 2.5, 2.4, 2.4, 2.3, 2.2, 2.1 /</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keyword">data</span> c6 / -2.92333, -3.12969, -3.10735, -2.99999, -2.97578, -2.949<span class="comment">29, -2.93706, -2.92538, -2.83154,</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">     1       -2.81238, -2.78005, -2.75216, -2.71828, -2.70593, -2.59747, -2.56429, -2.51516, -2.43076,</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">     1       -2.36933, -2.23329, -2.13693, -1.91307, -1.8433, -1.68527, -1.53646, -1.41992 /</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.1963, 0.20328, 0.20134, 0.19487, 0.19341, 0.19162, 0.1<span class="comment">9071, 0.1898, 0.18373,</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">     1       0.18218, 0.17962, 0.17736, 0.17461, 0.17349, 0.16549, 0.16246, 0.15754, 0.1484,</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">     1       0.14193, 0.12682, 0.11627, 0.0945, 0.08701, 0.07303, 0.06087, 0.05359 /</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.04493, -0.03854, -0.03842, -0.03882, -0.03934, -0.03<span class="comment">999, -0.04035, -0.04075, -0.04164,</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">     1       -0.04266, -0.04496, -0.04754, -0.05184, -0.05345, -0.06026, -0.0677, -0.07959, -0.10021,</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">     1       -0.12239, -0.1695, -0.21228, -0.27892, -0.30641, -0.34299, -0.35343, -0.29994 /</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.738, 0.7809, 0.7856, 0.7891, 0.785, 0.7745, 0.7678,<span class="comment"> 0.7691, 0.7619,</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">     1       0.757, 0.7541, 0.7536, 0.7359, 0.7301, 0.7272, 0.7292, 0.7405, 0.7391,</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">     1       0.7532, 0.8022, 0.8, 0.8885, 0.9618, 1.0496, 1.1946, 1.3239 /</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">                                                                              </span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      nper = 26</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;               count1 = i</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;               count2 = i+1</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Low atttenuation model&#39;</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      stop 99</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Const-Low&#39;</span>              <span class="comment">        </span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-High-Sat, Horizontal *************</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a9f81d0ef212398bf2ecaecf3455e7f30">pea1cchs</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a9f81d0ef212398bf2ecaecf3455e7f30">  887</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)   </div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                            </div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 5.87466, 8.16024, 7.49863, 7.31723, 7.13246, 6.94435, 6.<span class="comment">86357, 6.25069, 6.10266,</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">     1       5.95548, 5.65135, 5.35255, 4.91274, 4.77362, 3.76921, 3.241, 2.50733, 1.41567,</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">     1       0.35595, -1.75176, -3.52171, -6.43297, -8.18384, -11.07071, -14.33292, -17.92122 /</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.06918, -0.16443, -0.11031, -0.09725, -0.08472, -0.069<span class="comment">11, -0.06114, -0.01554, -0.00018,</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">     1       0.01492, 0.04288, 0.06996, 0.10766, 0.12203, 0.21066, 0.26094, 0.33905, 0.47284,</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">     1       0.59376, 0.85016, 1.0572, 1.42055, 1.60124, 1.88506, 2.17359, 2.41939 /</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.9, 3.1, 3, 3, 3, 3, 3, 2.9, 2.9,</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;     1       2.9, 2.9, 2.9, 2.9, 2.9, 2.8, 2.8, 2.8, 2.8,</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;     1       2.8, 2.8, 2.8, 2.8, 2.7, 2.6, 2.5, 2.4 /</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keyword">data</span> c6 / -3.42987, -3.67439, -3.5427, -3.51057, -3.48193, -3.4501<span class="comment">7, -3.4354, -3.32741, -3.30216,</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">     1       -3.27916, -3.24075, -3.20795, -3.16905, -3.15491, -3.02221, -2.98696, -2.93443, -2.84495,</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">     1       -2.78233, -2.63826, -2.53979, -2.35414, -2.21757, -2.04376, -1.88598, -1.76932 /</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.26131, 0.27088, 0.26124, 0.25921, 0.2574, 0.25514, 0.2<span class="comment">5399, 0.24639, 0.24432,</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">     1       0.24241, 0.23928, 0.23656, 0.23338, 0.23211, 0.22178, 0.21867, 0.21356, 0.20419,</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">     1       0.19789, 0.18244, 0.17215, 0.15261, 0.14122, 0.12639, 0.11439, 0.10861 /</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.07032, -0.06117, -0.06105, -0.06168, -0.06255, -0.06<span class="comment">369, -0.06433, -0.06502, -0.06659,</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">     1       -0.06838, -0.07247, -0.07711, -0.08479, -0.08761, -0.09924, -0.11171, -0.13042, -0.16028,</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">     1       -0.19028, -0.24504, -0.28704, -0.34123, -0.35737, -0.36727, -0.34044, -0.247 /</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.7433, 0.7859, 0.7906, 0.7938, 0.7897, 0.779, 0.7723<span class="comment">, 0.7734, 0.7659,</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">     1       0.7606, 0.7575, 0.7567, 0.7389, 0.7331, 0.7302, 0.7324, 0.7439, 0.7431,</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">     1       0.7578, 0.806, 0.8016, 0.8859, 0.9578, 1.0463, 1.1943, 1.3238 /</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      nper = 26</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;         period1 = period(1)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;               count1 = i</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;               count2 = i+1</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-High-Sat atttenuation model&#39;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      stop 99</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Const-High-Sat&#39;</span>         <span class="comment">             </span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Med-Sat, Horizontal *************</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#ae26e6f6a3ef9e49a6a6edcf09f78a3c4">pea1ccms</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l00996"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#ae26e6f6a3ef9e49a6a6edcf09f78a3c4">  996</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper) </div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                              </div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 5.35011, 7.60902, 6.96175, 6.79091, 6.61705, 6.44374, 6.<span class="comment">37083, 6.30181, 5.63835,</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">     1       5.50813, 5.23836, 4.97456, 4.58602, 4.46498, 3.53193, 3.06862, 2.42583, 1.46377,</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">     1       0.51857, -1.41, -3.08744, -6.23481, -7.62375, -10.54155, -13.9107, -17.91423 /</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.08193, -0.17372, -0.1209, -0.10914, -0.09799, -0.0842<span class="comment">9, -0.07735, -0.0704, -0.01981,</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">     1       -0.00703, 0.01612, 0.03821, 0.06845, 0.08019, 0.1588, 0.19946, 0.2643, 0.37971,</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">     1       0.48452, 0.71797, 0.91539, 1.29417, 1.45642, 1.75532, 2.07364, 2.37754 /</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.9, 3.1, 3, 3, 3, 3, 3, 3, 2.9,</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;     1       2.9, 2.9, 2.9, 2.9, 2.9, 2.8, 2.8, 2.8, 2.8,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;     1       2.8, 2.8, 2.8, 2.7, 2.7, 2.6, 2.5, 2.3 /</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keyword">data</span> c6 / -3.38707, -3.63508, -3.50625, -3.47572, -3.44851, -3.418<span class="comment">66, -3.40488, -3.39174, -3.27511,</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">     1       -3.25386, -3.21848, -3.1883, -3.15246, -3.13934, -3.01048, -2.9773, -2.92775, -2.84201,</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">     1       -2.78232, -2.6441, -2.54658, -2.30231, -2.22717, -2.04882, -1.8834, -1.71861 /</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.25794, 0.26806, 0.2587, 0.25685, 0.2552, 0.25316, 0.25<span class="comment">213, 0.25111, 0.24282,</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">     1       0.24112, 0.23835, 0.23596, 0.23315, 0.232, 0.22207, 0.2192, 0.21443, 0.20543,</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">     1       0.19943, 0.18452, 0.17419, 0.15083, 0.14299, 0.12727, 0.11388, 0.10433 /</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.06717, -0.05964, -0.05949, -0.05996, -0.06059, -0.06<span class="comment">139, -0.06184, -0.06233, -0.06344,</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">     1       -0.06471, -0.06764, -0.07097, -0.07654, -0.07861, -0.08732, -0.09681, -0.11161, -0.13639,</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">     1       -0.16236, -0.21379, -0.25719, -0.31913, -0.34147, -0.36524, -0.35716, -0.28182 /</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.7427, 0.7853, 0.7901, 0.7934, 0.7894, 0.779, 0.7724<span class="comment">, 0.7736, 0.7664,</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">     1       0.7612, 0.7585, 0.758, 0.7405, 0.7348, 0.7322, 0.7345, 0.7461, 0.7453,</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">     1       0.7599, 0.8087, 0.8057, 0.8917, 0.9637, 1.0506, 1.1963, 1.3253 /</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      nper = 26</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;               count1 = i</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;               count2 = i+1</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Med-Sat atttenuation model&#39;</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      stop 99</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Const-Med-Sat&#39;</span>          <span class="comment">            </span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Low-Sat, Horizontal *************</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a7b6f430f4d4db19519beb503ff7a850c">pea1ccls</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01105"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a7b6f430f4d4db19519beb503ff7a850c"> 1105</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span> </div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                                                        <span class="comment">       </span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)   </div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                            </div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">     1        0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">     1        0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 4.83071, 7.01484, 6.4123, 6.25258, 6.08901, 5.92808, 5.3<span class="comment">5709, 5.29605, 5.17534,</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">     1        5.05581, 4.8055, 4.56076, 3.75047, 3.64126, 3.21855, 2.78943, 2.19908, 1.32039,</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">     1        0.44711, -1.3454, -2.93381, -5.63265, -7.30278, -9.90982, -13.58249, -17.52612 /</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.12898, -0.21767, -0.16752, -0.15669, -0.14646, -0.133<span class="comment">94, -0.09141, -0.08523, -0.07324,</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">     1        -0.06166, -0.04079, -0.02108, 0.03785, 0.04811, 0.08824, 0.12398, 0.1813, 0.2851,</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">     1        0.37973, 0.59571, 0.78321, 1.13348, 1.31553, 1.60565, 1.96072, 2.29529 /</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 2.8, 3, 2.9, 2.9, 2.9, 2.9, 2.8, 2.8, 2.8,</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;     1        2.8, 2.8, 2.8, 2.7, 2.7, 2.7, 2.7, 2.7, 2.7,</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;     1        2.7, 2.7, 2.7, 2.7, 2.6, 2.6, 2.4, 2.3 /</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keyword">data</span> c6 / -3.35311, -3.59567, -3.47458, -3.44589, -3.4202, -3.3921<span class="comment">1, -3.2904, -3.2784, -3.2562,</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">     1        -3.23598, -3.20187, -3.17249, -3.05739, -3.04474, -2.99921, -2.96449, -2.91311, -2.82477,</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">     1        -2.76056, -2.61803, -2.51701, -2.32961, -2.19863, -2.0728, -1.85975, -1.73008 /</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.26108, 0.27165, 0.26279, 0.26109, 0.25956, 0.25767, 0.<span class="comment">25047, 0.24954, 0.24779,</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">     1        0.24617, 0.24348, 0.24111, 0.23266, 0.23151, 0.22724, 0.22409, 0.21897, 0.20944,</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">     1        0.20271, 0.18691, 0.17588, 0.15521, 0.14381, 0.13069, 0.11403, 0.10536 /</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.05639, -0.04999, -0.04987, -0.05027, -0.0508, -0.051<span class="comment">45, -0.05181, -0.0522, -0.0531,</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">     1        -0.05411, -0.05641, -0.059, -0.0633, -0.0649, -0.07171, -0.07915, -0.09104, -0.11167,</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">     1        -0.13385, -0.18095, -0.22374, -0.29038, -0.31786, -0.35444, -0.36489, -0.31139 /</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.7477, 0.7908, 0.7956, 0.7989, 0.7949, 0.7844, 0.777<span class="comment">9, 0.7791, 0.7718,</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">     1        0.7668, 0.7638, 0.7632, 0.7456, 0.7398, 0.7369, 0.7389, 0.7499, 0.7485,</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">     1        0.7625, 0.8109, 0.8086, 0.8961, 0.9688, 1.0556, 1.199, 1.3269 /</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      nper = 26</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;               count1 = i</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;               count2 = i+1</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        </div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Low-Sat atttenuation model&#39;</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      stop 99</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. (2002) 1-Corner-Const-Low-Sat&#39;</span>          <span class="comment">            </span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">C *** Silva et al. (2002) 2-Corner, Horizontal Gulf *************</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a047d43dc857c3b04ef1e726f1ef26d6b">peag2c</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01214"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a047d43dc857c3b04ef1e726f1ef26d6b"> 1214</a></span>&#160;<span class="comment"> </span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                                                        <span class="comment">       </span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper) </div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                              </div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">     1        0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">     1        0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 9.90148, 14.33926, 14.14384, 13.81046, 12.42738, 12.0287<span class="comment">4, 11.85646, 11.69837, 10.51625,</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">     1        10.26367, 9.7961, 9.36118, 7.97786, 7.79199, 7.09082, 5.74732, 4.8783, 2.9958,</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">     1        1.93674, -0.12511, -2.15831, -5.10947, -6.28665, -8.83853, -12.20468, -16.41379 /</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.12757, -0.28175, -0.25488, -0.22653, -0.15043, -0.125<span class="comment">44, -0.11325, -0.10103, -0.03055,</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">     1        -0.00857, 0.03112, 0.06628, 0.15425, 0.16914, 0.2271, 0.31977, 0.39924, 0.55002,</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">     1        0.64984, 0.8388, 0.99778, 1.24004, 1.33826, 1.54958, 1.83553, 2.20767 /</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.4, 3.7, 3.7, 3.7, 3.6, 3.6, 3.6, 3.6, 3.5,</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;     1        3.5, 3.5, 3.5, 3.4, 3.4, 3.4, 3.3, 3.3, 3.2,</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;     1        3.2, 3.2, 3.1, 3, 3, 2.9, 2.7, 2.5 /</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keyword">data</span> c6 / -4.30771, -4.93249, -4.87587, -4.80279, -4.56505, -4.494<span class="comment">89, -4.46406, -4.43516, -4.23161,</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">     1        -4.18673, -4.11197, -4.0525, -3.85005, -3.8308, -3.76365, -3.58708, -3.51506, -3.30621,</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">     1        -3.22152, -3.0503, -2.82918, -2.53021, -2.43987, -2.21747, -1.95111, -1.74567 /</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.25806, 0.27571, 0.26995, 0.26447, 0.25176, 0.24783, 0.<span class="comment">24596, 0.2441, 0.23289,</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">     1        0.22992, 0.22526, 0.22188, 0.21146, 0.21046, 0.20689, 0.19746, 0.19281, 0.17993,</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">     1        0.17312, 0.15823, 0.14191, 0.11775, 0.10973, 0.09356, 0.07737, 0.06829 /</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.05882, -0.05331, -0.05318, -0.0537, -0.05445, -0.055<span class="comment">78, -0.0565, -0.05724, -0.05885,</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">     1        -0.06062, -0.06459, -0.06891, -0.07567, -0.07794, -0.0868, -0.09504, -0.10565, -0.11838,</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">     1        -0.12608, -0.13454, -0.13999, -0.16323, -0.18303, -0.23217, -0.29415, -0.33131 /</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9031, 0.9685, 0.9722, 0.9821, 0.9842, 0.9799, 0.973<span class="comment">3, 0.973, 0.9664,</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">     1        0.9628, 0.9596, 0.9587, 0.9369, 0.9306, 0.9177, 0.9111, 0.9109, 0.8991,</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">     1        0.904, 0.9349, 0.9271, 0.9956, 1.0612, 1.1393, 1.2665, 1.3791 /</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      nper = 26</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;               count1 = i</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;               count2 = i+1</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        </div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 2 Corner atttenuation Gulf model&#39;</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      stop 99</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 2-Corner&#39;</span>                    <span class="comment">  </span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">C *** Silva et al. (2002) 2-Corner-Saturation, Horizontal Gulf *************</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#aebeebc562ae3de2086f83b636b1d6c6b">peag2cs</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01323"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#aebeebc562ae3de2086f83b636b1d6c6b"> 1323</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)   </div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                            </div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 13.52127, 17.40998, 17.2009, 16.84962, 16.45698, 16.0236<span class="comment">2, 15.83611, 14.53975, 14.23988,</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">     1       13.96635, 13.46434, 12.01553, 11.39716, 11.20299, 9.5919, 8.93501, 8.03762, 5.96206,</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">     1       4.87153, 2.74561, 0.53026, -2.0663, -3.8314, -6.54516, -9.76826, -14.54243 /</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.58872, -0.72596, -0.69766, -0.66794, -0.64342, -0.616<span class="comment">52, -0.60342, -0.52162, -0.49678,</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment">     1       -0.47347, -0.43179, -0.33472, -0.28656, -0.27131, -0.15735, -0.10061, -0.01963, 0.14984,</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">     1       0.25189, 0.44592, 0.62351, 0.85356, 0.9871, 1.21492, 1.50496, 1.91703 /</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.6, 3.8, 3.8, 3.8, 3.8, 3.8, 3.8, 3.7, 3.7,</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;     1       3.7, 3.7, 3.6, 3.6, 3.6, 3.5, 3.5, 3.5, 3.4,</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;     1       3.4, 3.4, 3.3, 3.3, 3.2, 3.1, 3, 2.7 /</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keyword">data</span> c6 / -4.95888, -5.48554, -5.42663, -5.35052, -5.27833, -5.202<span class="comment">28, -5.16886, -4.95186, -4.89689,</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">     1       -4.84844, -4.76782, -4.53955, -4.46693, -4.44627, -4.22645, -4.1674, -4.09059, -3.85124,</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">     1       -3.76122, -3.57911, -3.32873, -3.0922, -2.90058, -2.65122, -2.41187, -2.10859 /</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.34391, 0.3583, 0.35229, 0.34658, 0.34234, 0.33809, 0.3<span class="comment">3606, 0.32294, 0.31927,</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">     1       0.31607, 0.31108, 0.29762, 0.29383, 0.29278, 0.28002, 0.27663, 0.27175, 0.25592,</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">     1       0.24875, 0.23302, 0.2137, 0.19167, 0.17769, 0.15876, 0.14194, 0.12608 /</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.07073, -0.06521, -0.06508, -0.06561, -0.06636, -0.06<span class="comment">769, -0.0684, -0.06914, -0.07075,</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">     1       -0.07252, -0.07649, -0.08082, -0.08758, -0.08984, -0.09871, -0.10695, -0.11756, -0.13028,</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">     1       -0.13799, -0.14644, -0.1519, -0.17514, -0.19493, -0.24408, -0.30605, -0.34322 /</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9031, 0.9685, 0.9722, 0.9821, 0.9842, 0.9799, 0.973<span class="comment">3, 0.973, 0.9664,</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">     1       0.9628, 0.9596, 0.9587, 0.9369, 0.9306, 0.9177, 0.9111, 0.9109, 0.8991,</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">     1       0.904, 0.9349, 0.9271, 0.9956, 1.0612, 1.1393, 1.2665, 1.3791 /</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">                                                                                    </span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      nper = 26</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;               count1 = i</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;               count2 = i+1</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        </div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 2 Corner-Sat atttenuation Gulf model&#39;</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      stop 99</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 2-Corner-Sat&#39;</span>                <span class="comment">      </span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Variable-High, Horizontal Gulf *************</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#ae67cdd1428600f062595f32f2b81f64e">peag1cvh</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01432"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#ae67cdd1428600f062595f32f2b81f64e"> 1432</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)  </div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                             </div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 17.56501, 22.54184, 22.40623, 22.02865, 21.61053, 21.118<span class="comment">75, 20.91108, 20.72257, 20.37544,</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">     1       20.04863, 19.43335, 18.86865, 16.81254, 16.59083, 15.77669, 15.04806, 12.94874, 11.55566,</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">     1       10.33931, 6.90409, 4.94057, 0.72588, -1.56307, -5.06249, -9.02136, -13.91863 /</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.73081, -0.94055, -0.91637, -0.88044, -0.8526, -0.8178<span class="comment">9, -0.80174, -0.78585, -0.75402,</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">     1       -0.72294, -0.66605, -0.61723, -0.48116, -0.46325, -0.39607, -0.33259, -0.17886, -0.03985,</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">     1       0.08773, 0.41108, 0.63072, 1.0561, 1.26035, 1.59204, 1.95631, 2.33294 /</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.7, 3.9, 3.9, 3.9, 3.9, 3.9, 3.9, 3.9, 3.9,</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;     1       3.9, 3.9, 3.9, 3.8, 3.8, 3.8, 3.8, 3.7, 3.7,</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;     1       3.7, 3.6, 3.6, 3.5, 3.4, 3.3, 3.2, 3 /</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keyword">data</span> c6 / -5.65962, -6.41953, -6.37768, -6.29329, -6.21225, -6.117<span class="comment">72, -6.07691, -6.039, -5.96788,</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">     1       -5.9014, -5.78203, -5.68075, -5.34165, -5.30738, -5.1878, -5.08734, -4.77368, -4.60821,</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">     1       -4.47467, -4.06719, -3.88811, -3.47121, -3.23534, -2.93546, -2.64856, -2.33817 /</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.36566, 0.39634, 0.39115, 0.38353, 0.37806, 0.37124, 0.<span class="comment">36809, 0.36501, 0.35891,</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">     1       0.35305, 0.34275, 0.33451, 0.31279, 0.31025, 0.30141, 0.29385, 0.27355, 0.2601,</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">     1       0.24889, 0.21878, 0.20282, 0.17081, 0.15492, 0.13367, 0.11437, 0.09908 /</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.07661, -0.06885, -0.06821, -0.06773, -0.06793, -0.06<span class="comment">833, -0.06854, -0.06877, -0.06938,</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">     1       -0.07023, -0.07256, -0.07559, -0.08098, -0.08296, -0.09155, -0.10095, -0.11589, -0.14124,</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">     1       -0.16562, -0.21837, -0.25891, -0.32004, -0.34181, -0.365, -0.3607, -0.29154 /</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.91, 0.9758, 0.9794, 0.9892, 0.9912, 0.9866, 0.98, 0<span class="comment">.9795, 0.9726,</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">     1       0.9687, 0.9649, 0.9635, 0.9412, 0.9348, 0.9217, 0.9152, 0.915, 0.9039,</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">     1       0.9093, 0.9403, 0.9321, 0.9978, 1.0621, 1.139, 1.2674, 1.3821 /</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">                                                                </span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      nper = 26</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;               count1 = i</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;               count2 = i+1</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        </div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Var-High atttenuation Gulf model&#39;</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      stop 99</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 1-Corner-Var-High&#39;</span>           <span class="comment">           </span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Variable-Med, Horizontal Gulf *************</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#aafe3e2b0d527f9869bd46a090cb19e06">peag1cvm</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#aafe3e2b0d527f9869bd46a090cb19e06"> 1541</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)    </div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                           </div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 15.27441, 19.88182, 19.78142, 20.8987, 20.50874, 18.6441<span class="comment">9, 18.46167, 18.29779, 17.99875,</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">     1       17.71756, 17.18425, 16.69027, 16.0265, 15.82366, 13.93331, 13.29372, 12.43075, 10.18655,</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">     1       9.10831, 6.01523, 4.21778, 0.25617, -1.92096, -5.3148, -9.25169, -14.54986 /</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.61726, -0.80582, -0.78593, -0.84219, -0.81779, -0.703<span class="comment">, -0.68951, -0.67629, -0.64981,</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">     1       -0.62387, -0.57629, -0.53555, -0.48449, -0.4692, -0.34606, -0.2936, -0.21755, -0.04192,</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">     1       0.0681, 0.35576, 0.55654, 0.96349, 1.16422, 1.49937, 1.88136, 2.30998 /</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.6, 3.8, 3.8, 3.9, 3.9, 3.8, 3.8, 3.8, 3.8,</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;     1       3.8, 3.8, 3.8, 3.8, 3.8, 3.7, 3.7, 3.7, 3.6,</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;     1       3.6, 3.5, 3.5, 3.4, 3.3, 3.2, 3.1, 2.8 /</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keyword">data</span> c6 / -5.30301, -6.01166, -5.97732, -6.14187, -6.06641, -5.745<span class="comment">51, -5.70923, -5.67576, -5.61318,</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">     1       -5.55455, -5.44841, -5.35752, -5.24545, -5.21303, -4.9083, -4.81633, -4.69883, -4.37417,</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">     1       -4.24952, -3.87179, -3.70387, -3.30857, -3.08551, -2.79932, -2.51971, -2.15716 /</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.34239, 0.37073, 0.36646, 0.37424, 0.36944, 0.34952, 0.<span class="comment">34685, 0.34425, 0.33907,</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">     1       0.33408, 0.32521, 0.31804, 0.30976, 0.30744, 0.28841, 0.28167, 0.27269, 0.25066,</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">     1       0.24024, 0.21222, 0.19724, 0.16627, 0.15079, 0.12984, 0.1101, 0.09152 /</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.09155, -0.08525, -0.08469, -0.08421, -0.0843, -0.084<span class="comment">51, -0.08461, -0.08473, -0.08507,</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">     1       -0.08558, -0.08711, -0.08918, -0.09294, -0.09434, -0.10055, -0.10754, -0.119, -0.13932,</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment">     1       -0.15976, -0.20693, -0.24619, -0.31189, -0.33869, -0.37439, -0.38752, -0.34105 /</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9031, 0.9685, 0.9722, 0.9821, 0.9842, 0.9799, 0.973<span class="comment">3, 0.973, 0.9664,</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">     1       0.9628, 0.9596, 0.9587, 0.9369, 0.9306, 0.9177, 0.9111, 0.9109, 0.8991,</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">     1       0.904, 0.9349, 0.9271, 0.9956, 1.0612, 1.1393, 1.2665, 1.3791 /</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">                                                                      </span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      nper = 26</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;               count1 = i</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;               count2 = i+1</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        </div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Var-Med atttenuation Gulf model&#39;</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      stop 99</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 1-Corner-Var-Med&#39;</span>            <span class="comment">          </span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Variable-Low, Horizontal Gulf *************</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a1f5dbdc358fa5a0779e574c5f0c239d3">peag1cvl</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01650"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a1f5dbdc358fa5a0779e574c5f0c239d3"> 1650</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)  </div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                             </div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 14.35825, 18.89574, 18.81796, 19.93414, 19.56869, 19.136<span class="comment">72, 18.95886, 17.43775, 17.16559,</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">     1       16.90986, 16.42234, 15.96772, 15.35608, 15.16957, 13.35601, 12.77568, 11.99662, 9.88541,</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">     1       8.91163, 6.03088, 4.3827, 0.60771, -1.52175, -4.86624, -9.24105, -14.25163 /</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.58678, -0.76779, -0.75053, -0.8076, -0.78618, -0.7588<span class="comment">2, -0.74635, -0.65344, -0.63027,</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment">     1       -0.60751, -0.56572, -0.53011, -0.48604, -0.47298, -0.35932, -0.31521, -0.25104, -0.09326,</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment">     1       0.00198, 0.26122, 0.44249, 0.82916, 1.02753, 1.36569, 1.78174, 2.2322 /</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.6, 3.8, 3.8, 3.9, 3.9, 3.9, 3.9, 3.8, 3.8,</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;     1       3.8, 3.8, 3.8, 3.8, 3.8, 3.7, 3.7, 3.7, 3.6,</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;     1       3.6, 3.5, 3.5, 3.4, 3.3, 3.2, 3, 2.8 /</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="keyword">data</span> c6 / -5.18268, -5.88521, -5.85612, -6.0219, -5.95141, -5.8683<span class="comment">7, -5.83325, -5.57562, -5.51821,</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">     1       -5.46428, -5.36596, -5.28098, -5.17562, -5.14508, -4.8492, -4.76255, -4.65152, -4.33601,</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">     1       -4.21624, -3.84799, -3.68677, -3.29808, -3.07493, -2.78892, -2.4321, -2.1362 /</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.33157, 0.35942, 0.35579, 0.36387, 0.35968, 0.35426, 0.<span class="comment">3518, 0.33613, 0.33158,</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">     1       0.32715, 0.31923, 0.31278, 0.30531, 0.30322, 0.28512, 0.27903, 0.27084, 0.24975,</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">     1       0.23987, 0.21274, 0.19846, 0.16792, 0.15219, 0.13082, 0.10715, 0.09013 /</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.09714, -0.09203, -0.09155, -0.09109, -0.09113, -0.09<span class="comment">122, -0.09125, -0.0913, -0.09148,</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment">     1       -0.09179, -0.09279, -0.09419, -0.0968, -0.09778, -0.10218, -0.10726, -0.11582, -0.13159,</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">     1       -0.14814, -0.1886, -0.22467, -0.29094, -0.32102, -0.36709, -0.39711, -0.37542 /</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9003, 0.9651, 0.9688, 0.9788, 0.9811, 0.977, 0.9705<span class="comment">, 0.9704, 0.9642,</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">     1       0.9609, 0.9583, 0.9578, 0.9367, 0.9305, 0.9182, 0.9119, 0.9119, 0.9001,</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment">     1       0.9045, 0.9346, 0.9268, 0.9968, 1.0631, 1.1426, 1.269, 1.379 /</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      nper = 26</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;               count1 = i</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;               count2 = i+1</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        </div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Var-Low atttenuation Gulf model&#39;</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      stop 99</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 1-Corner-Var-Low&#39;</span>            <span class="comment">          </span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-High, Horizontal Gulf *************</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a00f776613e0e13dbbec15eeb6ad82393">peag1cch</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01759"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a00f776613e0e13dbbec15eeb6ad82393"> 1759</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)  </div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                             </div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 16.08302, 19.51657, 19.40352, 20.51285, 20.10895, 19.633<span class="comment">11, 19.43335, 19.25288, 18.92158,</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">     1       17.25027, 16.69021, 16.17236, 15.47703, 15.26405, 13.33561, 12.66006, 11.74743, 9.4332,</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">     1       8.29484, 5.08922, 3.21915, -0.80232, -2.37232, -6.35091, -10.18213, -14.92343 /</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.53416, -0.64891, -0.62778, -0.68238, -0.6565, -0.624,<span class="comment"> -0.60894, -0.59416, -0.56453,</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">     1       -0.45606, -0.40538, -0.36176, -0.30669, -0.29006, -0.16266, -0.10531, -0.02246, 0.162,</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">     1       0.28003, 0.58119, 0.78973, 1.19788, 1.36543, 1.71518, 2.06757, 2.43027 /</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.7, 3.8, 3.8, 3.9, 3.9, 3.9, 3.9, 3.9, 3.9,</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;     1       3.8, 3.8, 3.8, 3.8, 3.8, 3.7, 3.7, 3.7, 3.6,</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;     1       3.6, 3.5, 3.5, 3.4, 3.4, 3.2, 3.1, 2.9 /</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keyword">data</span> c6 / -5.54089, -6.0488, -6.01142, -6.17374, -6.09544, -6.0038<span class="comment">3, -5.96446, -5.92801, -5.85972,</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">     1       -5.57097, -5.46052, -5.36632, -5.25065, -5.2172, -4.90916, -4.81457, -4.69411, -4.36652,</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment">     1       -4.23968, -3.85783, -3.68683, -3.29152, -3.17502, -2.78676, -2.51603, -2.22382 /</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.35572, 0.37128, 0.3667, 0.37408, 0.36898, 0.36256, 0.3<span class="comment">5961, 0.35673, 0.351,</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">     1       0.33242, 0.3231, 0.31558, 0.30691, 0.30448, 0.28523, 0.2782, 0.26892, 0.24675,</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="comment">     1       0.23616, 0.20794, 0.19276, 0.16227, 0.15221, 0.12722, 0.10917, 0.09485 /</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.0616, -0.05461, -0.05403, -0.05357, -0.05373, -0.054<span class="comment">06, -0.05422, -0.05441, -0.05491,</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="comment">     1       -0.05561, -0.05758, -0.06017, -0.06481, -0.06652, -0.07402, -0.08232, -0.09568, -0.11874,</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">     1       -0.14131, -0.19127, -0.23069, -0.29176, -0.3141, -0.33853, -0.33532, -0.2685 /</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9054, 0.9715, 0.9752, 0.9849, 0.987, 0.9824, 0.9757<span class="comment">, 0.9753, 0.9685,</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="comment">     1       0.9646, 0.9608, 0.9592, 0.9369, 0.9303, 0.917, 0.9098, 0.909, 0.8966,</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="comment">     1       0.901, 0.9311, 0.9225, 0.9905, 1.0564, 1.1358, 1.2655, 1.3793 /</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      nper = 26</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;               count1 = i</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;               count2 = i+1</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;       </div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-High atttenuation Gulf model&#39;</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      stop 99</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 1-Corner-Const-High&#39;</span>         <span class="comment">             </span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Medium, Horizontal Gulf *************</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a4c71b6a4d4e38aaad27489dfbc1fa6b2">peag1ccm</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01868"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a4c71b6a4d4e38aaad27489dfbc1fa6b2"> 1868</a></span>&#160;<span class="comment"> </span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                                                                        <span class="comment">       </span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)  </div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                             </div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 14.09083, 18.66451, 18.5759, 19.69186, 19.31416, 18.8681<span class="comment">5, 18.68342, 17.14437, 16.8585,</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">     1       16.58985, 16.07898, 15.60406, 14.96522, 14.76997, 12.91716, 12.30467, 11.47972, 9.29703,</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment">     1       8.2654, 5.26938, 3.53746, -0.33936, -2.48893, -5.83777, -9.7274, -14.97295 /</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.44176, -0.62536, -0.60707, -0.66304, -0.64033, -0.611<span class="comment">46, -0.59824, -0.50458, -0.47991,</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="comment">     1       -0.45572, -0.41128, -0.37326, -0.32579, -0.3116, -0.19398, -0.14553, -0.07511, 0.09136,</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment">     1       0.19447, 0.46791, 0.65933, 1.05439, 1.25139, 1.58067, 1.95572, 2.37485 /</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.6, 3.8, 3.8, 3.9, 3.9, 3.9, 3.9, 3.8, 3.8,</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;     1       3.8, 3.8, 3.8, 3.8, 3.8, 3.7, 3.7, 3.7, 3.6,</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;     1       3.6, 3.5, 3.5, 3.4, 3.3, 3.2, 3.1, 2.8 /</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keyword">data</span> c6 / -5.23954, -5.94544, -5.91373, -6.07864, -6.00557, -5.919<span class="comment">69, -5.88319, -5.62237, -5.56225,</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">     1       -5.50586, -5.40344, -5.31533, -5.20638, -5.17479, -4.87438, -4.78472, -4.66998, -4.34955,</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">     1       -4.22696, -3.85384, -3.68869, -3.29591, -3.07316, -2.78845, -2.51098, -2.14967 /</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.33332, 0.36127, 0.35737, 0.36517, 0.3607, 0.35496, 0.3<span class="comment">5235, 0.33654, 0.33169,</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment">     1       0.327, 0.31863, 0.31184, 0.30397, 0.30176, 0.28333, 0.2769, 0.26828, 0.24683,</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="comment">     1       0.23667, 0.20926, 0.19464, 0.16405, 0.14866, 0.12797, 0.10865, 0.09041 /</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.05839, -0.05272, -0.05222, -0.05176, -0.05184, -0.05<span class="comment">201, -0.05209, -0.05218, -0.05245,</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment">     1       -0.05288, -0.05418, -0.05594, -0.05917, -0.06037, -0.06574, -0.07185, -0.08198, -0.10023,</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">     1       -0.11889, -0.1629, -0.20041, -0.26496, -0.29199, -0.32881, -0.34332, -0.29863 /</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9, 0.9655, 0.9692, 0.9791, 0.9814, 0.9771, 0.9706, <span class="comment">0.9704, 0.9639,</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">     1       0.9604, 0.9574, 0.9565, 0.9348, 0.9285, 0.9156, 0.909, 0.9085, 0.8962,</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">     1       0.9004, 0.9302, 0.9219, 0.9913, 1.0576, 1.1373, 1.2658, 1.3782 /</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment">                                                                   </span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      nper = 26</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;         period1 = period(1)</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;               count1 = i</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;               count2 = i+1</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        </div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Med atttenuation Gulf model&#39;</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      stop 99</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 1-Corner-Const-Med&#39;</span>          <span class="comment">            </span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Low, Horizontal Gulf *************</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#af22d5adbec53ef7ce691e4d93e28bdc9">peag1ccl</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l01977"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#af22d5adbec53ef7ce691e4d93e28bdc9"> 1977</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">                                                                               </span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)  </div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                             </div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 13.95924, 17.18549, 18.4581, 18.16727, 17.82567, 17.4211<span class="comment">, 17.25532, 17.1086, 16.84332,</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">     1       16.59372, 16.11475, 14.4586, 13.87411, 13.69482, 13.03902, 11.41205, 10.65378, 8.63053,</span></div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">     1       7.67899, 5.67074, 3.27417, -0.39847, -1.89095, -5.22266, -9.56051, -14.51574 /</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.51587, -0.6188, -0.68363, -0.65766, -0.6382, -0.61316<span class="comment">, -0.60178, -0.59071, -0.56847,</span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">     1       -0.54655, -0.50595, -0.40049, -0.35857, -0.34602, -0.29926, -0.19463, -0.13196, 0.02055,</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">     1       0.11381, 0.32399, 0.54493, 0.92377, 1.08997, 1.4263, 1.83677, 2.27743 /</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.6, 3.7, 3.8, 3.8, 3.8, 3.8, 3.8, 3.8, 3.8,</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;     1       3.8, 3.8, 3.7, 3.7, 3.7, 3.7, 3.6, 3.6, 3.5,</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;     1       3.5, 3.5, 3.4, 3.3, 3.3, 3.2, 3, 2.8 /</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keyword">data</span> c6 / -5.26211, -5.74801, -5.94442, -5.87782, -5.81156, -5.733<span class="comment">33, -5.70035, -5.67026, -5.61422,</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment">     1       -5.56147, -5.46456, -5.17926, -5.07762, -5.04794, -4.9434, -4.67925, -4.56857, -4.26127,</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment">     1       -4.13972, -3.90708, -3.60867, -3.22226, -3.10319, -2.81135, -2.45407, -2.16004 /</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.33959, 0.3548, 0.36483, 0.35931, 0.35548, 0.35047, 0.3<span class="comment">4821, 0.34603, 0.34167,</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">     1       0.3374, 0.32967, 0.31164, 0.3044, 0.30235, 0.29508, 0.27864, 0.27022, 0.24915,</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">     1       0.23879, 0.21814, 0.19579, 0.16458, 0.15363, 0.1316, 0.10808, 0.09156 /</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.04706, -0.04232, -0.04192, -0.04152, -0.04159, -0.04<span class="comment">171, -0.04176, -0.04182, -0.04202,</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">     1       -0.04233, -0.04331, -0.04464, -0.04708, -0.04799, -0.05208, -0.05678, -0.06472, -0.0794,</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">     1       -0.09489, -0.13325, -0.16807, -0.23333, -0.26352, -0.31057, -0.34227, -0.3221 /</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.8999, 0.965, 0.9686, 0.9786, 0.981, 0.977, 0.9705, <span class="comment">0.9705, 0.9642,</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment">     1       0.9611, 0.9586, 0.9582, 0.9368, 0.9306, 0.9181, 0.9114, 0.9108, 0.8982,</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">     1       0.9018, 0.9306, 0.9217, 0.9915, 1.0581, 1.1387, 1.2666, 1.3771 /</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment">                                                                              </span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      nper = 26</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;         period1 = period(1)</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;               count1 = i</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;               count2 = i+1</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        </div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Low atttenuation Gulf model&#39;</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      stop 99</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf (2002) 1-Corner-Const-Low&#39;</span>         <span class="comment">             </span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-High-Sat, Horizontal Gulf *************</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a0c33d4c22cfc333fc025a3d23b15087b">peag1cchs</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l02086"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a0c33d4c22cfc333fc025a3d23b15087b"> 2086</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)   </div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                            </div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 19.2806, 24.64848, 24.51845, 24.13701, 23.71273, 23.2128<span class="comment">4, 23.00275, 22.8127, 22.46355,</span></div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment">     1       22.13508, 21.51625, 20.94827, 20.19141, 18.50771, 17.69717, 16.97448, 14.74399, 13.37181,</span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">     1       12.17467, 8.6523, 6.70599, 2.38331, 0.76119, -2.92833, -7.63385, -12.65135 /</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.99348, -1.24267, -1.21926, -1.18374, -1.15652, -1.122<span class="comment">31, -1.10647, -1.09092, -1.05978,</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">     1       -1.02936, -0.97369, -0.92609, -0.86646, -0.7544, -0.69006, -0.62936, -0.46111, -0.32798,</span></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">     1       -0.20531, 0.12586, 0.34088, 0.77804, 0.94998, 1.29933, 1.70983, 2.09962 /</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.8, 4, 4, 4, 4, 4, 4, 4, 4,</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;     1       4, 4, 4, 4, 3.9, 3.9, 3.9, 3.8, 3.8,</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;     1       3.8, 3.7, 3.7, 3.6, 3.6, 3.5, 3.3, 3.1 /</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <span class="keyword">data</span> c6 / -6.11546, -6.93799, -6.89791, -6.81358, -6.73191, -6.636<span class="comment">32, -6.59524, -6.55721, -6.48596,</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">     1       -6.41929, -6.29904, -6.19648, -6.07056, -5.79682, -5.67505, -5.57259, -5.23503, -5.06579,</span></div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">     1       -4.92914, -4.49751, -4.31367, -3.87013, -3.74466, -3.40943, -2.99118, -2.65372 /</span></div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.44085, 0.47804, 0.47308, 0.46562, 0.4603, 0.45359, 0.4<span class="comment">5051, 0.4475, 0.44153,</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">     1       0.43578, 0.42562, 0.41744, 0.40801, 0.39016, 0.38135, 0.37377, 0.35058, 0.33699,</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">     1       0.32564, 0.29269, 0.27643, 0.24129, 0.23048, 0.2058, 0.17807, 0.15931 /</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.07305, -0.06606, -0.06549, -0.06503, -0.06519, -0.06<span class="comment">551, -0.06568, -0.06586, -0.06636,</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">     1          -0.06706, -0.06904, -0.07162, -0.07627, -0.07798, -0.08547, -0.09378, -0.10713, -0.13019,</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">     1       -0.15276, -0.20273, -0.24215, -0.30322, -0.32555, -0.34999, -0.34677, -0.27995 /</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9129, 0.9786, 0.9822, 0.9922, 0.9941, 0.9896, 0.983<span class="comment">1, 0.9827, 0.976,</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">     1       0.9721, 0.9683, 0.9669, 0.9448, 0.9383, 0.925, 0.9181, 0.9173, 0.905,</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">     1       0.9094, 0.9392, 0.9306, 0.998, 1.0634, 1.1422, 1.271, 1.3837 /</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      nper = 26</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;         period1 = period(1)</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;               count1 = i</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;               count2 = i+1</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        </div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-High-Sat atttenuation Gulf model&#39;</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      stop 99</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf (2002) 1-Corner-Const-High-Sat&#39;</span>    <span class="comment">                  </span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Med-Sat, Horizontal Gulf *************</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a2f7ded5ca75d6e7571f4880b48944ef3">peag1ccms</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l02195"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a2f7ded5ca75d6e7571f4880b48944ef3"> 2195</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)          <span class="comment">                     </span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">      </span><span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 18.4435, 23.74361, 23.64102, 23.29188, 22.89529, 22.4267<span class="comment">4, 22.23245, 22.05839, 21.74098,</span></div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">     1       21.44261, 20.87722, 20.35514, 18.20699, 18.00368, 17.26232, 16.60473, 14.47052, 13.22694,</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">     1       12.13819, 8.82898, 7.023, 2.84583, 1.25366, -3.08593, -7.18334, -12.36761 /</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.97271, -1.21411, -1.19389, -1.16219, -1.13831, -1.107<span class="comment">92, -1.09401, -1.08042, -1.05317,</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">     1       -1.02649, -0.97756, -0.9359, -0.7901, -0.77536, -0.7206, -0.66904, -0.51361, -0.39862,</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="comment">     1       -0.29103, 0.01214, 0.20984, 0.63403, 0.80656, 1.20331, 1.59845, 2.03153 /</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.8, 4, 4, 4, 4, 4, 4, 4, 4,</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;     1       4, 4, 4, 3.9, 3.9, 3.9, 3.9, 3.8, 3.8,</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;     1       3.8, 3.7, 3.7, 3.6, 3.6, 3.4, 3.3, 3.1 /</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      <span class="keyword">data</span> c6 / -6.00839, -6.82593, -6.79201, -6.71452, -6.63833, -6.548<span class="comment">72, -6.51064, -6.47563, -6.41027,</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment">     1       -6.34895, -6.23744, -6.14146, -5.78572, -5.75279, -5.63758, -5.54036, -5.20994, -5.04733,</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">     1       -4.91519, -4.49285, -4.3152, -3.87433, -3.74757, -3.29709, -2.98527, -2.63877 /</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.43044, 0.46721, 0.46299, 0.45635, 0.45168, 0.44569, 0.<span class="comment">44297, 0.44033, 0.43505,</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">     1       0.42994, 0.42083, 0.41343, 0.38965, 0.38735, 0.37933, 0.37238, 0.34992, 0.33707,</span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment">     1       0.32617, 0.29408, 0.27841, 0.24315, 0.23195, 0.2001, 0.17746, 0.15707 /</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.06984, -0.06417, -0.06368, -0.06322, -0.0633, -0.063<span class="comment">46, -0.06354, -0.06363, -0.06391,</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment">     1       -0.06434, -0.06563, -0.0674, -0.07062, -0.07183, -0.0772, -0.08331, -0.09344, -0.11168,</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment">     1       -0.13035, -0.17435, -0.21186, -0.27642, -0.30344, -0.34026, -0.35477, -0.31008 /</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9073, 0.9726, 0.9761, 0.9861, 0.9883, 0.9841, 0.977<span class="comment">7, 0.9775, 0.9711,</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment">     1       0.9676, 0.9646, 0.9639, 0.9425, 0.9362, 0.9235, 0.9169, 0.9165, 0.9044,</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">     1       0.9086, 0.9382, 0.93, 0.9987, 1.0648, 1.1441, 1.2715, 1.3828 /</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      nper = 26</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;         period1 = period(1)</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;               count1 = i</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;               count2 = i+1</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        </div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Med-Sat atttenuation Gulf model&#39;</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      stop 99</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 1-Corner-Const-Med-Sat&#39;</span>      <span class="comment">                </span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                       </span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">c -------------------------------------------------------------------           </span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment">C *** Silva et al. (2002) 1-Corner-Constant-Low-Sat, Horizontal Gulf *************</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">c -------------------------------------------------------------------</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment"></span><span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a75d26b4056fe1999e43983c4d96975fa">peag1ccls</a> ( m, dist, lnY, sig, specT,                      </div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;     1                  attenName, period1,iflag )<span class="comment">                                    </span></div><div class="line"><a name="l02304"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a75d26b4056fe1999e43983c4d96975fa"> 2304</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">      </span><span class="keywordtype">implicit none</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                                                                        <span class="comment">        </span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> lnY, m, dist, sigT, sig, period1                             <span class="comment"> </span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> specT, c1T, c2T, c4T, c6T, c7T, c10T</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, MAXPER, i</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <span class="keywordtype">character*80</span> attenName                                            <span class="comment">        </span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="comment">                                                                              </span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment">      <a class="code" href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a>(maxper=26)                                                      </span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(maxper), c2(maxper), c4(maxper), sigma(maxper)         </div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      <span class="keywordtype">real</span> c6(maxper), c7(maxper), c10(maxper), period(maxper)</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                               </div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      <span class="keyword">data</span> period / 0.00, 0.02, 0.025, 0.0323, 0.04, 0.05, 0.055, 0.06, <span class="comment">0.07,</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">     1       0.08, 0.1, 0.12, 0.15, 0.16, 0.2, 0.24, 0.3, 0.4,</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">     1       0.5, 0.75, 1, 1.6, 2, 3.000, 5, 10 /</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 16.96725, 21.95228, 21.87723, 21.57041, 21.21243, 20.788<span class="comment">19, 20.61413, 20.45986, 20.18058,</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment">     1       19.91774, 19.41416, 18.94247, 18.30605, 18.11166, 16.08791, 15.48361, 14.67303, 12.35996,</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment">     1       11.3548, 9.24442, 6.58784, 2.63452, 1.0916, -2.46635, -7.12762, -12.34486 /</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / -0.95374, -1.17915, -1.16223, -1.13489, -1.11449, -1.088<span class="comment">18, -1.07622, -1.0646, -1.04126,</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment">     1       -1.01826, -0.9757, -0.93912, -0.89356, -0.87999, -0.74305, -0.69729, -0.63086, -0.45077,</span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">     1       -0.35323, -0.13451, 0.1121, 0.51855, 0.68925, 1.04807, 1.49148, 1.95845 /</span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / 3.7, 3.9, 3.9, 3.9, 3.9, 3.9, 3.9, 3.9, 3.9,</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;     1       3.9, 3.9, 3.9, 3.9, 3.9, 3.8, 3.8, 3.8, 3.7,</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;     1       3.7, 3.7, 3.6, 3.5, 3.5, 3.4, 3.2, 3 /</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="keyword">data</span> c6 / -5.807, -6.58099, -6.55296, -6.48374, -6.41476, -6.33324<span class="comment">, -6.29889, -6.26753, -6.20917,</span></div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="comment">     1       -6.15421, -6.05319, -5.96502, -5.85465, -5.82243, -5.49275, -5.40014, -5.28067, -4.9283,</span></div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment">     1       -4.79775, -4.54798, -4.20864, -3.777, -3.64922, -3.32053, -2.91057, -2.57317 /</span></div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.42132, 0.45634, 0.45285, 0.4471, 0.44311, 0.43789, 0.4<span class="comment">3554, 0.43327, 0.42872,</span></div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment">     1       0.42427, 0.41621, 0.40954, 0.4017, 0.39947, 0.37755, 0.3709, 0.36186, 0.33648,</span></div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment">     1       0.32541, 0.30336, 0.27695, 0.24128, 0.22956, 0.20386, 0.17493, 0.15404 /</span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.05852, -0.05377, -0.05337, -0.05297, -0.05305, -0.05<span class="comment">317, -0.05322, -0.05328, -0.05347,</span></div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">     1       -0.05379, -0.05476, -0.0561, -0.05854, -0.05945, -0.06353, -0.06824, -0.07617, -0.09086,</span></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment">     1       -0.10635, -0.14471, -0.17953, -0.24479, -0.27498, -0.32203, -0.35373, -0.33355 /</span></div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="comment">      </span><span class="keyword">data</span> sigma / 0.9075, 0.9723, 0.9759, 0.9861, 0.9884, 0.9844, 0.978<span class="comment">1, 0.978, 0.9719,</span></div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="comment">     1       0.9687, 0.9662, 0.9657, 0.9446, 0.9385, 0.9261, 0.9195, 0.919, 0.9065,</span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment">     1       0.9101, 0.9387, 0.93, 0.9992, 1.0655, 1.1457, 1.2728, 1.3821 /</span></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      nper = 26</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;         period1 = period(1)</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;         c1t     = c1(1)</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;         c2t     = c2(1)</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;         c4t     = c4(1)</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;         c6t     = c6(1)</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;         c7t     = c7(1)</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;         sigt     = sigma(1)</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period(i) .and. spect .le. period(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;               count1 = i</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;               count2 = i+1</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        </div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Silva et al. (2002) 1 Corner-Const-Low-Sat atttenuation Gulf model&#39;</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      stop 99</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c1(count1),c1(count2),</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c2(count1),c2(count2),</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c4(count1),c4(count2),</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;     +             spect,c4t,iflag)</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c6(count1),c6(count2),</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;     +             spect,c6t,iflag)</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c7(count1),c7(count2),</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;     +             spect,c7t,iflag)</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),c10(count1),c10(count2)<span class="comment">,</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period(count1),period(count2),sigma(count1),sigma(count2<span class="comment">),</span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment"> 1011 period1 = spect                                                                                                              </span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">c     Set atten name                                                            </span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      attenname = <span class="stringliteral">&#39;Silva et al. Gulf(2002) 1-Corner-Const-Low-Sat&#39;</span>      <span class="comment">                </span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">                                                                               </span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">      lny = c1t + c2t*m + (c6t+c7t*m)*alog(dist+exp(c4t)) + c10t*(m-6)*(m-6)                                                       </span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">c     Convert to spectral acceleration in gal                                   </span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      lny = lny + 6.89                                                  <span class="comment">        </span></div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">      sig = sigt                                            </span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">                                                                                </span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">      </span><span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment"></span><span class="keyword">      end            </span></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="comment">c ----------------------------</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">C *** Campbell (2003) Horizontal for Hybrid CEUS ****</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#ace0e5164f379cf2e4dc3d960198017e2">chy03</a> ( mag, rupdist, lnY, sigma, specT, period, iflag )<span class="comment">                                                </span></div><div class="line"><a name="l02413"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#ace0e5164f379cf2e4dc3d960198017e2"> 2413</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">c    Campbell (2003) Horizontal Hybrid CEUS</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">C    Hard Rock Site Conditions</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <span class="keywordtype">real</span> mag, rupDist, lnY, sigma, period                             <span class="comment">       </span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> R, term1, term2, term3                                       <span class="comment">                    </span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(18), c2(18), c3(18), c4(18), c5(18), c6(18)</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <span class="keywordtype">real</span> c7(18), c8(18), c9(18), c10(18), c11(18)</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      <span class="keywordtype">real</span> c12(18), c13(18)</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c3T, c4T, c5T, c6T, c7T</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      <span class="keywordtype">real</span> c8T, c9T, c10T, c11T, c12T, c13T</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, i</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;      <span class="keywordtype">real</span> period1(18), r1, r2</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <span class="keyword">data</span> period1 / 0.00, 0.01, 0.02, 0.03, 0.05, 0.075, 0.10, 0.15, 0.<span class="comment">20,   </span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">     &amp;               0.30, 0.50, 0.75, 1.00, 1.50,  2.00, 3.00, 4.00, 5.00 /</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1  / 0.0305,  0.0305,  1.3535,  1.186,  0.3736, -0.0395, -0.<span class="comment">1475,      </span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">     &amp;          -0.1901, -0.4328, -0.6906, -0.5907, -0.5429, -0.6104,   </span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">     &amp;          -0.9666, -1.4306, -2.2331, -2.7975, -3.2365 /</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2  / 0.633,  0.633, 0.63, 0.622, 0.616, 0.615, 0.613, 0.616,<span class="comment"> 0.617, </span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">     &amp;           0.609, 0.534, 0.48, 0.451, 0.441, 0.459, 0.492, 0.507, 0.525  /</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c3  / -0.0427, -0.0427, -0.0404, -0.0362, -0.0353, -0.0353, -<span class="comment">0.0353,  </span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">     &amp;           -0.0478, -0.0586, -0.0786, -0.1379, -0.1806, -0.209,   </span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment">     &amp;           -0.2405, -0.2552, -0.2646, -0.2738, -0.2792  /</span></div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4  / -1.591, -1.591, -1.787, -1.691, -1.469, -1.383, -1.369,<span class="comment"> -1.368, </span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment">     &amp;           -1.32, -1.28, -1.216, -1.184, -1.158, -1.135, -1.124,  </span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment">     &amp;           -1.121, -1.119, -1.117  /</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c5  / -0.00428, -0.00428, -0.00388, -0.00367, -0.00378, -0.00<span class="comment">421, -0.00454, </span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment">     &amp;           -0.00473, -0.0046, -0.00414, -0.00341, -0.00288, -0.00255, </span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">     &amp;           -0.00213, -0.00187, -0.00154, -0.00135, -0.00117  /</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c6  / 0.000483, 0.000483, 0.000497, 0.000501, 0.0005, 0.00048<span class="comment">6, 0.00046, </span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">     &amp;           0.000393, 0.000337, 0.000263, 0.000194, 0.00016, 0.000141, </span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment">     &amp;           0.000119, 0.000103, 0.000084, 0.000074, 0.000064  /</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7  / 0.683, 0.683, 1.02, 0.922, 0.63, 0.491, 0.484, 0.461, 0<span class="comment">.399, 0.349, </span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">     &amp;           0.318, 0.304, 0.299, 0.304, 0.31, 0.31, 0.294, 0.293  /</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c8  / 0.416, 0.416, 0.363, 0.376, 0.423, 0.463, 0.467, 0.478,<span class="comment"> 0.493, 0.502, </span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">     &amp;           0.503, 0.504, 0.503, 0.5, 0.499, 0.499, 0.506, 0.507  /</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c9  / 1.14, 1.14, 0.851, 0.759, 0.771, 0.955, 1.096, 1.239, 1<span class="comment">.25, 1.241, </span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">     &amp;           1.166, 1.11, 1.067, 1.029, 1.015, 1.014, 1.018, 1.018 /</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.873, -0.873, -0.715, -0.922, -1.239, -1.349, -1.284,<span class="comment"> -1.079, -0.928, </span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">     &amp;           -0.753, -0.606, -0.526, -0.482, -0.438, -0.417, -0.393, -0.386, -0.374 /</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c11 / 1.03, 1.03, 1.03, 1.03, 1.042, 1.052, 1.059, 1.068, 1.0<span class="comment">77, 1.081, </span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">     &amp;           1.098, 1.105, 1.11, 1.099, 1.093, 1.09, 1.092, 1.092  /</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c12 / -0.086, -0.086, -0.086, -0.086, -0.0838, -0.0838, -0.08<span class="comment">38, -0.0838, </span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">     &amp;           -0.0838, -0.0838, -0.0824, -0.0806, -0.0793, -0.0771, -0.0758, </span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">     &amp;           -0.0737, -0.0722, -0.0722 /</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c13 / 0.414, 0.414, 0.414, 0.414, 0.443, 0.453, 0.46, 0.469, <span class="comment">0.478, </span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">     &amp;           0.482, 0.508, 0.528, 0.543, 0.547, 0.551, 0.562, 0.575, 0.575 /</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      nper = 18</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;         period   = period1(1)</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;         c1t      = c1(1)</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;         c2t      = c2(1)</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;         c3t      = c3(1)</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;         c4t      = c4(1)</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;         c5t      = c5(1)</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;         c6t      = c6(1)</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;         c7t      = c7(1)</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;         c8t      = c8(1)</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;         c9t      = c9(1)</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;         c11t     = c11(1)</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;         c12t     = c12(1)</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;         c13t     = c13(1)</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period1(i) .and. spect .le. period1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;               count1 = i</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;               count2 = i+1</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        </div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Campbell (2003) Hor. Hybrid-CEUS atttenuation model&#39;</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      stop 99</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c1(count1),c1(count2)<span class="comment">,</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">     +             spect,c1t,iflag)</span></div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c2(count1),c2(count2)<span class="comment">,</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">     +             spect,c2t,iflag)</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c3(count1),c3(count2)<span class="comment">,</span></div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">     +             spect,c3t,iflag)</span></div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c4(count1),c4(count2)<span class="comment">,</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">     +             spect,c4t,iflag)</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c5(count1),c5(count2)<span class="comment">,</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">     +             spect,c5t,iflag)</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c6(count1),c6(count2)<span class="comment">,</span></div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="comment">     +             spect,c6t,iflag)</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c7(count1),c7(count2)<span class="comment">,</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="comment">     +             spect,c7t,iflag)</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c8(count1),c8(count2)<span class="comment">,</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">     +             spect,c8t,iflag)</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c9(count1),c9(count2)<span class="comment">,</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">     +             spect,c9t,iflag)</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c10(count1),c10(count2<span class="comment">),</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c11(count1),c11(count2<span class="comment">),</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">     +             spect,c11t,iflag)</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c12(count1),c12(count2<span class="comment">),</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">     +             spect,c12t,iflag)</span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c13(count1),c13(count2<span class="comment">),</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment">     +             spect,c13t,iflag)</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="comment"> 1011 period = spect                                                                                                              </span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment">C     Compute the ground motions.</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      r1 = 70.0</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      r2 = 130.0</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      r = sqrt(rupdist*rupdist + (c7t*exp(c8t*mag))**2.0)</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      term1 = c2t*mag + c3t*(8.5-mag)**2.0</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;      term2 = c4t*alog(r) + (c5t + c6t*mag)*rupdist</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      <span class="keywordflow">if</span> (rupdist .le. r1) <span class="keywordflow">then</span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;         term3 = 0.0</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <span class="keywordflow">elseif</span> (rupdist .le. r2) <span class="keywordflow">then</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;         term3 = c9t*(alog(rupdist) - alog(r1) )</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;         term3 = c9t*(alog(rupdist) - alog(r1) ) + c10t*(alog(rupdist) -<span class="comment"> alog(r2) )</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment"></span><span class="keywordflow">      endif</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      lny = c1t + term1 + term2 + term3</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">C     Now compute the sigma</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <span class="keywordflow">if</span> (mag .lt. 7.16) <span class="keywordflow">then</span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;         sigma = c11t + c12t*mag</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;         sigma = c13t</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">C     Now convert to Ln Units in gals.</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;      lny = lny + 6.89</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">C *** Campbell (2003) Epistemic Model from B. Youngs ****</span></div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a59dedc7af4a5e8bb22c89633e0c0f4a6">chy03eps</a> ( mag, rupdist, sigmaeps, specT, period, iflag )<span class="comment">                                                </span></div><div class="line"><a name="l02571"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a59dedc7af4a5e8bb22c89633e0c0f4a6"> 2571</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment">c    Campbell (2003) Horizontal Hybrid CEUS</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="comment">C    Hard Rock Site Conditions</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="comment">C    Functional fit to Epistemic Values</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      <span class="keywordtype">real</span> mag, rupDist, sigmaeps, period                               <span class="comment">     </span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> EU1(19), EU2(19), EU3(19), EU4(19) </div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <span class="keywordtype">real</span> EU5(19), EU6(19), EU7(19), EU8(19) </div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;      <span class="keywordtype">real</span> EU1T, EU2T, EU3T, EU4T, EU5T, EU6T, EU7T, EU8T</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <span class="keywordtype">real</span> period1(19), specT</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, i</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keyword">data</span> period1 / 0.00, 0.02, 0.025, 0.03, 0.04, 0.05, 0.075, 0.1,</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;     1               0.15, 0.2, 0.3, 0.4, 0.5, 0.75, 1.0, 1.5, 2.0, </div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;     2               3.0, 4.0 /</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      <span class="keyword">data</span> eu1 / -0.033125, 0.51389, 0.4732, 0.43996, 0.35982, 0.29766, </div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;     1            0.14199, 0.070928,0.090445,0.094299,0.228,0.071481,</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;     2           -0.049923,-0.024928,-0.31915,0.30874,0.38988,0.030017,</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;     3            0.17177 /</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <span class="keyword">data</span> eu2 / 0.03861, -0.012873, -0.023817, -0.032759, -0.022174,</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;     1          -0.013963, 0.0035871, 0.010224, 0.0016472, -0.0018457,</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;     2          -0.024652, -0.0067245, 0.0071813, -0.00096697, 0.059038,</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;     3          -0.045457, -0.048256, 0.018689, 0.0040366 /</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;      <span class="keyword">data</span> eu3 / 0.0087249, 0.0024367, 0.0025327, 0.0026111, 0.0038935,</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;     1           0.0048883, 0.007836, 0.0092802, 0.0070123, 0.0058854,</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;     2          -0.00036376, 0.0027743, 0.0052083, 0.003623, 0.0072105,</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;     3          -0.0018214, -0.0026968, -0.00083408, -0.0029759 /</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      <span class="keyword">data</span> eu4 / -0.0011583, -0.0003466, -0.0001655, -0.000017529,</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;     1           -0.00022502, -0.00038596, -0.00082995, -0.0010257,</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;     2           -0.00062561, -0.00036639, 0.00058705, 0.00017773,</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;     3           -0.00013977, 0.00010171, -0.00068873, 0.00074708,</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;     4            0.00079911,0.00020333,0.00040235 /</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <span class="keyword">data</span> eu5 / 0.48433, 0.077638, -0.0016085, -0.066357, -0.084339,</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;     1          -0.098287, -0.21126, -0.18045, -0.25327, -0.19499,</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;     2           0.0026986, 0.22268, 0.39332, 0.41276, 0.80731,</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;     3           0.26528, 0.22295, 0.83934, 1.3955 /</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      <span class="keyword">data</span> eu6 / -0.054313, -0.00050347, 0.018919, 0.034789, 0.032453,</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;     1            0.030642, 0.055054, 0.054054, 0.072855, 0.066763,</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;     2            0.028926, -0.0035868, -0.028806, -0.029292, -0.10475,</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;     3           -0.010409, -0.012206, -0.11457, -0.19531 /</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      <span class="keyword">data</span> eu7 / 0.10412, -0.28007, -0.15434, -0.051614, 0.0030899,</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;     1           0.045522, 0.089641, -0.012585, -0.16112, -0.22373,</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;     2          -0.31465, -0.21393, -0.13581, -0.13727, 0.069083,</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;     3          -0.1091, -0.07587, 0.24009, 0.53063 /</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="keyword">data</span> eu8 / -0.029092, 0.032305, 0.016081, 0.0028249, -0.0091361,</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;     1           -0.018414, -0.032056, -0.018555, 0.0042663, 0.013275,</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;     2            0.030403, 0.020432, 0.012697, 0.013937, -0.027262,</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;     3            0.01131, 0.0059025, -0.057348, -0.11271 /</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      nper = 19</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;         period   = period1(1)</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;         eu1t      = eu1(1)</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;         eu2t      = eu2(1)</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;         eu3t      = eu3(1)</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;         eu4t      = eu4(1)</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;         eu5t      = eu5(1)</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;         eu6t      = eu6(1)</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;         eu7t      = eu7(1)</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;         eu8t      = eu8(1)</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period1(i) .and. spect .le. period1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;               count1 = i</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;               count2 = i+1</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        </div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Campbell (2003) Hor. Hybrid-CEUS Epistemic model&#39;</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      stop 99</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu1(count1),eu1(count2<span class="comment">),</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment">     +             spect,eu1t,iflag)</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu2(count1),eu2(count2<span class="comment">),</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">     +             spect,eu2t,iflag)</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu3(count1),eu3(count2<span class="comment">),</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">     +             spect,eu3t,iflag)</span></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu4(count1),eu4(count2<span class="comment">),</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">     +             spect,eu4t,iflag)</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu5(count1),eu5(count2<span class="comment">),</span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment">     +             spect,eu5t,iflag)</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu6(count1),eu6(count2<span class="comment">),</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment">     +             spect,eu6t,iflag)</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu7(count1),eu7(count2<span class="comment">),</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment">     +             spect,eu7t,iflag)</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),eu8(count1),eu8(count2<span class="comment">),</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="comment">     +             spect,eu8t,iflag)</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;<span class="comment"> 1011 period = spect                                                                                                              </span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;<span class="comment">C     Compute the epistemic sigma value.</span></div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      sigmaeps = eu1t + eu2t*mag + (eu3t + eu4t*mag)*rupdist + </div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;     1          (eu5t + eu6t*mag)*exp( (eu7t + eu8t*mag)*rupdist )</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="comment">C *** Atkinson and Boore (2006) Horizontal for CEUS Hard Rock ****</span></div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a6f2ab4c93f6e590a5287c07ffd63a0ab">ab06</a> ( mag, rupdist, lnY, sigma, specT, period, iflag )<span class="comment">                                                </span></div><div class="line"><a name="l02691"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a6f2ab4c93f6e590a5287c07ffd63a0ab"> 2691</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="comment">c    Atkinson and Boore (2006) Horizontal CEUS Hard Rock</span></div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment">C    Hard Rock Site Conditions</span></div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <span class="keywordtype">real</span> mag, rupDist, lnY, sigma, period                             <span class="comment">       </span></div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> term1, term2                                                 <span class="comment">          </span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(25), c2(25), c3(25), c4(25), c5(25), c6(25)</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      <span class="keywordtype">real</span> c7(25), c8(25), c9(25), c10(25)</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c3T, c4T, c5T, c6T, c7T</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <span class="keywordtype">real</span> c8T, c9T, c10T, r0, r1, r2</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, i</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="keywordtype">real</span> period1(25), term0</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <span class="keyword">data</span> period1 / 0.00, 0.025, 0.031, 0.04, 0.05, 0.063, 0.079,      </div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;     &amp;               0.1, 0.125, 0.158, 0.199, 0.251, 0.315, 0.397,     </div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;     &amp;               0.5, 0.629, 0.794, 1.00, 1.25, 1.59, 2.00, 2.5,    </div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;     &amp;               3.13, 4.00, 5.00 / </div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="keyword">data</span> c1 / 0.907, 1.52, 1.44, 1.26, 1.11, 0.911, 0.691, 0.48, 0.214<span class="comment">, </span></div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;<span class="comment">     &amp;         -0.146, -0.615, -1.12, -1.72, -2.44, -3.22, -3.92, -4.6, </span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="comment">     &amp;         -5.27, -5.72, -6.04, -6.18, -6.17, -6.04, -5.79, -5.41 /</span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.983, 0.96, 0.959, 0.968, 0.972, 0.98, 0.997, 1.02, 1.0<span class="comment">5, </span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment">     &amp;          1.12, 1.23, 1.34, 1.48, 1.65, 1.83, 1.99, 2.13, 2.26, 2.32, </span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="comment">     &amp;          2.34, 2.3, 2.21, 2.08, 1.92, 1.71 /</span></div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c3 / -0.066, -0.0635, -0.0628, -0.0623, -0.062, -0.0621, -0.0<span class="comment">628, </span></div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment">     &amp;          -0.064, -0.0666, -0.0714, -0.0789, -0.0872, -0.0974, -0.108, </span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment">     &amp;          -0.12, -0.131, -0.141, -0.148, -0.151, -0.15, -0.144, -0.135,</span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="comment">     &amp;          -0.122, -0.107, -0.0901 /</span></div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / -2.7, -2.81, -2.71, -2.58, -2.47, -2.36, -2.26, -2.2, -2<span class="comment">.15, </span></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;<span class="comment">     &amp;          -2.12, -2.09, -2.08, -2.08, -2.05, -2.02, -2.05, -2.06, -2.07, </span></div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="comment">     &amp;          -2.1, -2.16, -2.22, -2.3, -2.37, -2.44, -2.54 /</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c5 / 0.159, 0.146, 0.14, 0.132, 0.128, 0.126, 0.125, 0.127, 0<span class="comment">.13, 0.13, </span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="comment">     &amp;          0.131, 0.135, 0.138, 0.136, 0.134, 0.142, 0.147, 0.15, 0.157, 0.166, </span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="comment">     &amp;          0.177, 0.19, 0.2, 0.211, 0.227 /</span></div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c6 / -2.8, -3.65, -3.73, -3.64, -3.39, -2.97, -2.49, -2.01, -<span class="comment">1.61, -1.3, </span></div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="comment">     &amp;          -1.12, -0.971, -0.889, -0.843, -0.813, -0.782, -0.797, -0.813, -0.82, </span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="comment">     &amp;          -0.87, -0.937, -0.986, -1.07, -1.16, -1.27 /</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.212, 0.236, 0.234, 0.228, 0.214, 0.191, 0.164, 0.133, <span class="comment">0.105, 0.0831, </span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;<span class="comment">     &amp;          0.0679, 0.0563, 0.0487, 0.0448, 0.0444, 0.043, 0.0435, 0.0467, 0.0519, </span></div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="comment">     &amp;          0.0605, 0.0707, 0.0786, 0.0895, 0.102, 0.116 /</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c8 / -0.301, -0.654, -0.543, -0.351, -0.139, 0.107, 0.214, 0.<span class="comment">337, 0.427, </span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="comment">     &amp;           0.562, 0.606, 0.614, 0.61, 0.739, 0.884, 0.788, 0.775, 0.826, 0.856, </span></div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="comment">     &amp;           0.921, 0.952, 0.968, 1, 1.01, 0.979 /</span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c9 / -0.0653, -0.055, -0.0645, -0.0813, -0.0984, -0.117, -0.1<span class="comment">21, -0.127, </span></div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="comment">     &amp;          -0.13, -0.144, -0.146, -0.143, -0.139, -0.156, -0.175, -0.159, -0.156, </span></div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="comment">     &amp;          -0.162, -0.166, -0.173, -0.177, -0.177, -0.18, -0.182, -0.177 /</span></div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.000448, -0.0000485, -0.0000323, -0.000123, -0.000317<span class="comment">, -0.000579, </span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="comment">     &amp;           -0.000847, -0.00105, -0.00115, -0.00118, -0.00113, -0.00106, </span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="comment">     &amp;           -0.000954, -0.000851, -0.00077, -0.000695, -0.000579, -0.000386, </span></div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment">     &amp;           -0.000433, -0.000375, -0.000322, -0.000282, -0.000231, -0.000201, </span></div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">     &amp;           -0.000176 /</span></div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      nper = 25</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;         period   = period1(1)</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;         c1t      = c1(1)</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;         c2t      = c2(1)</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;         c3t      = c3(1)</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;         c4t      = c4(1)</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;         c5t      = c5(1)</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;         c6t      = c6(1)</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;         c7t      = c7(1)</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;         c8t      = c8(1)</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;         c9t      = c9(1)</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period1(i) .and. spect .le. period1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;               count1 = i</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;               count2 = i+1</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        </div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Atkinson and Boore (2006) Hor. CEUS Hard Rock atttenuation model&#39;</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      stop 99</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c1(count1),c1(count2)<span class="comment">,</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment">     +             spect,c1t,iflag)</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c2(count1),c2(count2)<span class="comment">,</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">     +             spect,c2t,iflag)</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c3(count1),c3(count2)<span class="comment">,</span></div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="comment">     +             spect,c3t,iflag)</span></div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c4(count1),c4(count2)<span class="comment">,</span></div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment">     +             spect,c4t,iflag)</span></div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c5(count1),c5(count2)<span class="comment">,</span></div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment">     +             spect,c5t,iflag)</span></div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c6(count1),c6(count2)<span class="comment">,</span></div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="comment">     +             spect,c6t,iflag)</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c7(count1),c7(count2)<span class="comment">,</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment">     +             spect,c7t,iflag)</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c8(count1),c8(count2)<span class="comment">,</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment">     +             spect,c8t,iflag)</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c9(count1),c9(count2)<span class="comment">,</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment">     +             spect,c9t,iflag)</span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c10(count1),c10(count2<span class="comment">),</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment"> 1011 period = spect                                                                                                              </span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment">C     Compute the ground motions.</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      r0 = 10.0</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      r1 = 70.0 </div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      r2 = 140.0</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      term0 = max(alog10(r0/rupdist),0.0)</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      term1 = min(alog10(rupdist),alog10(r1))</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      term2 = max(alog10(rupdist/r2),0.0)</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      lny = c1t + c2t*mag + c3t*mag*mag + (c4t+c5t*mag)*term1 + </div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;     1        (c6t + c7t*mag)*term2 + (c8t + c9t*mag)*term0 + c10t*rupdist</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment">C     Now convert to Ln Units.</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      lny = alog(10.0)*lny</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment">c      lnY = lnY + 6.89</span></div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      sigma = alog(10.0)*0.30</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="comment">C *** Atkinson and Boore (2006) Horizontal for CEUS Hard Rock ****</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="comment">C        **** Alternative Stress Drop Scale Factors ****</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#af8269f5b1274ae04a59b8207d3e18dc6">ab06sf2</a> ( mag, specT, period, SF2 )                    <span class="comment">                            </span></div><div class="line"><a name="l02833"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#af8269f5b1274ae04a59b8207d3e18dc6"> 2833</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="comment">c     Atkinson and Boore (2006) Horizontal CEUS Hard Rock</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="comment">C     Hard Rock Site Conditions</span></div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="comment">C     Alternative Stress Drop values (see Eq. 6 and Table 7)</span></div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="keywordtype">real</span> mag, period, SF2, specT, term1, term2</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <span class="keywordtype">real</span> period1(26)</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <span class="keywordtype">real</span> Mh(26), Ml(26), Delta, MhT, MlT</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iFlag, i</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      <span class="keyword">data</span> period1 / 0.00, 0.01, 0.025, 0.031, 0.04, 0.05, 0.063, 0.079,<span class="comment">      </span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="comment">     &amp;               0.1, 0.125, 0.158, 0.199, 0.251, 0.315, 0.397,     </span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="comment">     &amp;               0.5, 0.629, 0.794, 1.00, 1.25, 1.59, 2.00, 2.5,    </span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="comment">     &amp;               3.13, 4.00, 5.00 / </span></div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="comment">      </span><span class="keyword">data</span> mh / 5.5, 5.5, 5.0, 5.0, 5.0, 5.0, 5.17, 5.34, 5.5, 5.67, 5.8<span class="comment">4, </span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="comment">     1          6.0, 6.12, 6.25, 6.37, 6.5, 6.7, 6.95, 7.2, 7.45, 7.7,</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="comment">     2          8.0 ,8.12, 8.25 ,8.37 ,8.5 /</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment">      </span><span class="keyword">data</span> ml / 0.5, 0.5, 0.0, 0.0, 0.0, 0.0, 0.17, 0.34, 0.5, 1.15, 1.8<span class="comment">5, </span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="comment">     1          2.5, 2.9, 3.3, 3.65, 4.0, 4.17, 4.34, 4.5, 4.67, 4.84, </span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment">     2          5.0, 5.25, 5.5, 5.75, 6.0 /</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;      nper = 26</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;         period   = period1(1)</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;         mlt      = ml(1)</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;         mht      = mh(1)</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period1(i) .and. spect .le. period1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;               count1 = i</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;               count2 = i+1</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        </div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Atkinson and Boore (2006) Hor. CEUS Hard Rock atttenuation model&#39;</span></div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;variable stress drop factors&#39;</span></div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      stop 99</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),ml(count1),ml(count2)<span class="comment">,</span></div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="comment">     +             spect,mlt,iflag)</span></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),mh(count1),mh(count2)<span class="comment">,</span></div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="comment">     +             spect,mht,iflag)</span></div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;<span class="comment"> 1011 period = spect                                                                                                              </span></div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;<span class="comment">C     Compute the ground motions.</span></div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      delta = 0.15</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;      term1 = max( (mag - mlt), 0.0)</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;      term2 = 0.05 + delta*(term1/(mht-mlt))  </div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;      sf2 = min(delta+0.05, term2)</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="comment">C *** Atkinson and Boore (2006) Horizontal for CEUS Vs=760m/sec ****</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a2dbf76adb778dfaf5f63d1b342d3b2f7">ab06vs760</a> ( mag, rupdist, lnY, sigma, specT, period, iflag )<span class="comment">                                                </span></div><div class="line"><a name="l02911"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a2dbf76adb778dfaf5f63d1b342d3b2f7"> 2911</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="comment">c    Atkinson and Boore (2006) Horizontal CEUS Vs=760m/sec</span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <span class="keywordtype">real</span> mag, rupDist, lnY, sigma, period                             <span class="comment">       </span></div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> term1, term2                                                 <span class="comment">        </span></div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(26), c2(26), c3(26), c4(26), c5(26), c6(26)</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <span class="keywordtype">real</span> c7(26), c8(26), c9(26), c10(26)</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c3T, c4T, c5T, c6T, c7T</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <span class="keywordtype">real</span> c8T, c9T, c10T</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, i</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <span class="keywordtype">real</span> period1(26), r0, r1, r2, term0</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      <span class="keyword">data</span> period1 / 0.00, 0.0100, 0.025, 0.031, 0.04, 0.05, 0.063, 0.07<span class="comment">9,      </span></div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;<span class="comment">     &amp;               0.1, 0.125, 0.158, 0.199, 0.251, 0.315, 0.397,     </span></div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;<span class="comment">     &amp;               0.5, 0.629, 0.794, 1.00, 1.25, 1.59, 2.00, 2.5,    </span></div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="comment">     &amp;               3.13, 4.00, 5.00 / </span></div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c1 / 0.523, 0.523, 1.05, 1.19, 1.26, 1.21, 1.11, 0.967, 0.782<span class="comment">, 0.536, </span></div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;<span class="comment">     &amp;          0.119, -0.306, -0.876, -1.56, -2.28, -3.01, -3.75, -4.45, </span></div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="comment">     &amp;         -5.06, -5.49, -5.75, -5.85, -5.8, -5.59, -5.26, -4.85 /</span></div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.969, 0.969, 0.903, 0.888, 0.879, 0.883, 0.888, 0.903, <span class="comment">0.924, </span></div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="comment">     &amp;          0.965, 1.06, 1.16, 1.29, 1.46, 1.63, 1.8, 1.97, 2.12, 2.23,</span></div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">     &amp;          2.29, 2.29, 2.23, 2.13, 1.97, 1.79, 1.58 /</span></div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c3 / -0.062, -0.062, -0.0577, -0.0564, -0.0552, -0.0544, -0.0<span class="comment">539,    </span></div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="comment">     &amp;          -0.0548, -0.0556, -0.0584, -0.0647, -0.0721, -0.0819,   </span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment">     &amp;          -0.0931, -0.105, -0.118, -0.129, -0.139, -0.145, -0.148, </span></div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment">     &amp;          -0.145, -0.139, -0.128, -0.114, -0.0979, -0.0807 /</span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c4 / -2.44, -2.44, -2.57, -2.58, -2.54, -2.44, -2.33, -2.25, <span class="comment">-2.17, </span></div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="comment">     &amp;          -2.11, -2.05, -2.04, -2.01, -1.98, -1.97, -1.98, -2.00, </span></div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;<span class="comment">     &amp;          -2.01, -2.03, -2.08, -2.13, -2.2, -2.26, -2.33, -2.44, -2.53 /</span></div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c5 / 0.147, 0.147, 0.148, 0.145, 0.139, 0.13, 0.123, 0.122, 0<span class="comment">.119,  </span></div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;<span class="comment">     &amp;          0.121, 0.119, 0.122, 0.123, 0.121, 0.123, 0.127, 0.131, </span></div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;<span class="comment">     &amp;          0.136, 0.141, 0.15, 0.158, 0.169, 0.179, 0.191, 0.207, 0.222 /</span></div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c6 / -2.34, -2.34, -2.65, -2.84, -2.99, -3.04, -2.88, -2.53, <span class="comment">-2.1,  </span></div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="comment">     &amp;          -1.67, -1.36, -1.15, -1.03, -0.947, -0.888, -0.847, -0.842, </span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;<span class="comment">     &amp;          -0.858, -0.874, -0.9, -0.957, -1.04, -1.12, -1.2, -1.31, -1.43 /</span></div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c7 / 0.191, 0.191, 0.207, 0.212, 0.216, 0.213, 0.201, 0.178, <span class="comment">0.148, </span></div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;<span class="comment">     &amp;          0.116, 0.0916, 0.0738, 0.0634, 0.0558, 0.0503, 0.047, 0.0482,</span></div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="comment">     &amp;          0.0498, 0.0541, 0.0579, 0.0676, 0.08, 0.0954, 0.11, 0.121, 0.136 /</span></div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c8 / -0.087, -0.087, -0.408, -0.437, -0.391, -0.21, -0.0319, <span class="comment">0.1, 0.285, </span></div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="comment">     &amp;           0.343, 0.516, 0.508, 0.581, 0.65, 0.684, 0.667, 0.677, 0.708, </span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="comment">     &amp;           0.792, 0.821, 0.867, 0.867, 0.891, 0.845, 0.734, 0.634 /</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c9 / -0.0829, -0.0829, -0.0577, -0.0587, -0.0675, -0.09, -0.1<span class="comment">07, -0.115, </span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;<span class="comment">     &amp;          -0.132, -0.132, -0.15, -0.143, -0.149, -0.156, -0.158,  </span></div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="comment">     &amp;          -0.155, -0.156, -0.159, -0.17, -0.172, -0.179, -0.179,  </span></div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;<span class="comment">     &amp;          -0.18, -0.172, -0.156, -0.141 /</span></div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c10 / -0.00063, -0.00063, -0.000512, -0.000433, -0.000388, -0<span class="comment">.000415,  </span></div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="comment">     &amp;           -0.000548, -0.000772, -0.00099, -0.00113, -0.00118,    </span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="comment">     &amp;           -0.00114, -0.00105, -0.000955, -0.000859, -0.000768,   </span></div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;<span class="comment">     &amp;           -0.000676, -0.000575, -0.000489, -0.000407, -0.000343, </span></div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;<span class="comment">     &amp;           -0.000286, -0.00026, -0.000245, -0.000196, -0.000161 /</span></div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      nper = 26</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;         period   = period1(1)</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;         c1t      = c1(1)</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;         c2t      = c2(1)</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;         c3t      = c3(1)</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;         c4t      = c4(1)</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;         c5t      = c5(1)</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;         c6t      = c6(1)</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;         c7t      = c7(1)</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;         c8t      = c8(1)</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;         c9t      = c9(1)</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;         c10t     = c10(1)</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period1(i) .and. spect .le. period1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;               count1 = i</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;               count2 = i+1</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        </div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Atkinson and Boore (2006) Hor. CEUS Vs=760m/s atttenuation model&#39;</span></div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      stop 99</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c1(count1),c1(count2)<span class="comment">,</span></div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;<span class="comment">     +             spect,c1t,iflag)</span></div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c2(count1),c2(count2)<span class="comment">,</span></div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;<span class="comment">     +             spect,c2t,iflag)</span></div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c3(count1),c3(count2)<span class="comment">,</span></div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;<span class="comment">     +             spect,c3t,iflag)</span></div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c4(count1),c4(count2)<span class="comment">,</span></div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="comment">     +             spect,c4t,iflag)</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c5(count1),c5(count2)<span class="comment">,</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="comment">     +             spect,c5t,iflag)</span></div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c6(count1),c6(count2)<span class="comment">,</span></div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="comment">     +             spect,c6t,iflag)</span></div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c7(count1),c7(count2)<span class="comment">,</span></div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="comment">     +             spect,c7t,iflag)</span></div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c8(count1),c8(count2)<span class="comment">,</span></div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;<span class="comment">     +             spect,c8t,iflag)</span></div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c9(count1),c9(count2)<span class="comment">,</span></div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="comment">     +             spect,c9t,iflag)</span></div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c10(count1),c10(count2<span class="comment">),</span></div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;<span class="comment">     +             spect,c10t,iflag)</span></div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<span class="comment"> 1011 period = spect                                                                                                              </span></div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;<span class="comment">C     Compute the ground motions.</span></div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      r0 = 10.0</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      r1 = 70.0 </div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      r2 = 140.0</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      term0 = max(alog10(r0/rupdist),0.0)</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      term1 = min(alog10(rupdist),alog10(r1))</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      term2 = max(alog10(rupdist/r2),0.0)</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      lny = c1t + c2t*mag + c3t*mag*mag + (c4t+c5t*mag)*term1 + </div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;     1        (c6t + c7t*mag)*term2 + (c8t + c9t*mag)*term0 + c10t*rupdist</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="comment">C     Now convert to Ln Units.</span></div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      lny = alog(10.0)*lny</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="comment">c      lnY = lnY + 6.89</span></div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      sigma = alog(10.0)*0.30</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment">C *** Atkinson (2008) Horizontal for CEUS-NGA BA08 Vs=760m/sec ****</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#aa1d91966cd23f8c254921799ea51da8f">a08vs760</a> ( mag, jbdist, specT, BA08lnY, period, LnY, sigma, iflag )<span class="comment">                                                </span></div><div class="line"><a name="l03051"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#aa1d91966cd23f8c254921799ea51da8f"> 3051</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment">c    Atkinson (2008) Horizontal CEUS-NGA BA08 Vs=760m/sec</span></div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      <span class="keywordtype">real</span> mag, jbDist, lnY, sigma, period, BA08LnY                     <span class="comment">               </span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(7), c2(7), c0(7)</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c0T</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, i</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <span class="keywordtype">real</span> per1(7), factor</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;      <span class="keyword">data</span> per1 / 0.00, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00 / </div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;      <span class="keyword">data</span> c1 / 0.00120, 0.00124, 0.00144, 0.00113, 0.000556, 0.000520, <span class="comment">-0.00107 /</span></div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.00000230, 0.00000199, 0.00000127, 0.000000698, </div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;     1          0.000000744, 0.000000376, 0.00000149 /</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;      <span class="keyword">data</span> c0 / 0.163, 0.093, -0.155, -0.356, -0.404, -0.379, -0.319 /</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      nper = 7</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;         period   = per1(1)</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;         c1t      = c1(1)</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;         c2t      = c2(1)</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;         c0t      = c0(1)</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            <span class="keywordflow">if</span> (spect .ge. per1(i) .and. spect .le. per1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;               count1 = i</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;               count2 = i+1</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;     </div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Atkinson (2008) Hor. CEUS-NGA BA08 Vs760 atttenuation model&#39;</span></div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      stop 99</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (per1(count1),per1(count2),c1(count1),c1(count2),</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;     +             spect,c1t,iflag)</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (per1(count1),per1(count2),c2(count1),c2(count2),</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;     +             spect,c2t,iflag)</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (per1(count1),per1(count2),c0(count1),c0(count2),</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;     +             spect,c0t,iflag)</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160; 1011 period = spect                                                    <span class="comment">                                                          </span></div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="comment">c     Compute the ground motions adjustment factor.</span></div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;      factor = c0t + c1t*jbdist + c2t*jbdist*jbdist</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      factor = factor*alog(10.0)</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      lny = ba08lny + factor</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;     </div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment">C *** Atkinson (2008) Horizontal for CEUS-NGA BA08 Vs=760m/sec   ****</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment">C      *** Alternative C0 values                                 ****</span></div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a554df458a0b5d6747f91bb0cc0b89c1f">a08vs760c0</a> ( mag, jbdist, specT, BA08lnY, period, LnY, sigma, iflag )<span class="comment">                                                </span></div><div class="line"><a name="l03126"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a554df458a0b5d6747f91bb0cc0b89c1f"> 3126</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="comment">c    Atkinson (2008) Horizontal CEUS-NGA BA08 Vs=760m/sec</span></div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="comment">C     Alternative C0 values</span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      <span class="keywordtype">real</span> mag, jbDist, lnY, sigma, period, BA08LnY                     <span class="comment">               </span></div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="comment">      </span><span class="keywordtype">real</span> c1(7), c2(7), c0(7)</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      <span class="keywordtype">real</span> specT, c1T, c2T, c0T</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, i</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <span class="keywordtype">real</span> period1(7), factor</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      <span class="keyword">data</span> period1 / 0.00, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00 / </div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      <span class="keyword">data</span> c1 / 0.00120, 0.00124, 0.00144, 0.00113, 0.000556, 0.000520, <span class="comment">-0.00107 /</span></div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="comment">      </span><span class="keyword">data</span> c2 / 0.00000230, 0.00000199, 0.00000127, 0.000000698, </div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;     1          0.000000744, 0.000000376, 0.00000149 /</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      <span class="keyword">data</span> c0 / 0.287, 0.143, -0.102, -0.364, -0.376, -0.419, -0.271 /</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      nper = 7</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;         period   = period1(1)</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;         c1t      = c1(1)</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;         c2t      = c2(1)</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;         c0t      = c0(1)</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period1(i) .and. spect .le. period1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;               count1 = i</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;               count2 = i+1</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;     </div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Atkinson (2008) Hor. CEUS-NGA BA08 Vs760 atttenuation model&#39;</span></div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      stop 99</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c1(count1),c1(count2)<span class="comment">,</span></div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">     +             spect,c1t,iflag)</span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c2(count1),c2(count2)<span class="comment">,</span></div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">     +             spect,c2t,iflag)</span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">      </span><span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),c0(count1),c0(count2)<span class="comment">,</span></div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment">     +             spect,c0t,iflag)</span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment"> 1011 period = spect                                                                                                              </span></div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="comment">c     Compute the ground motions adjustment factor.</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      factor = c0t + c1t*jbdist + c2t*jbdist*jbdist</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      factor = factor*alog(10.0)</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;      lny = ba08lny + factor</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;     </div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="comment">C *** NGA Sigma (Average from NGA Models for M5.5) ****</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#a1f7faf94f96815d7f94020ae36b325a7">ngasigma</a> ( specT, period, sigma )                      <span class="comment">                          </span></div><div class="line"><a name="l03200"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#a1f7faf94f96815d7f94020ae36b325a7"> 3200</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;<span class="comment">C     Average sigma from NGA models for M5.5.</span></div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <span class="keywordtype">real</span> period, sigma, specT</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      <span class="keywordtype">real</span> period1(21)</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      <span class="keywordtype">real</span> sig(21), sigT</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iFlag, i</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <span class="keyword">data</span> period1 / 0.01, 0.02, 0.03, 0.04, 0.05, 0.075, 0.1, 0.15, </div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;     1               0.2, 0.25, 0.3, 0.4, 0.5, 1.0, 1.5, 2.0, 3.0, </div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;     2               4.0, 5.0, 7.5, 10.0 / </div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      <span class="keyword">data</span> sig / 0.684, 0.684, 0.684, 0.684, 0.684, 0.684 ,0.684, </div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;     1           0.684, 0.684, 0.684, 0.684, 0.682, 0.686, 0.701, </div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;     2           0.712, 0.721, 0.727, 0.732, 0.755, 0.758, 0.809 /</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; </div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      nper = 21</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;         period   = period1(1)</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;         sigt      = sig(1)</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;            <span class="keywordflow">if</span> (spect .ge. period1(i) .and. spect .le. period1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;               count1 = i</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;               count2 = i+1</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        </div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;NGA sigma model (M5.5)&#39;</span></div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;      stop 99</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (period1(count1),period1(count2),sig(count1),sig(count2<span class="comment">),</span></div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;<span class="comment">     +             spect,sigt,iflag)</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="comment"> 1011 period = spect                                                                                                              </span></div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">C     Set the sigma value.</span></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      sigma = sigt</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment">c ------------------------------------------------------------------           </span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">C *** Atkinson (2010) Fena adjustment factors ****</span></div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="keyword">      subroutine </span><a class="code" href="eus__atten2_8f.html#aaad734621b0a61901d285498e9539489">fena</a> ( jbdist, specT, Factor )                         <span class="comment">                       </span></div><div class="line"><a name="l03266"></a><span class="lineno"><a class="line" href="eus__atten2_8f.html#aaad734621b0a61901d285498e9539489"> 3266</a></span>&#160;<span class="comment"></span></div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="comment">c    Atkinson (2008) Horizontal CEUS-NGA BA08 Vs=760m/sec</span></div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;      <span class="keywordtype">real</span> jbDist, period, Factor                              </div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      <span class="keywordtype">real</span> c(12), d(12)</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      <span class="keywordtype">real</span> specT, cT, dT</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      <span class="keywordtype">integer</span> nper, count1, count2, iflag, i</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;      <span class="keywordtype">real</span> per1(12)</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keyword">data</span> per1 / 0.00, 0.01, 0.05, 0.10, 0.20, 0.30, 0.50, 1.00, </div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;     1            2.00, 3.03, 5.00, 10.00 / </div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      <span class="keyword">data</span> c / 0.419, 0.417, 0.417, 0.245, 0.042, -0.078, -0.180, </div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;     1        -0.248, -0.214, -0.084, 0.0, 0.0 /</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;      <span class="keyword">data</span> d / 0.00211, 0.00192, 0.00192, 0.00273, 0.00232, 0.00190, </div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;     1         0.00180, 0.00153, 0.00117, 0.00091, 0.00, 0.00  /</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="comment">C Find the requested spectral period and corresponding coefficients</span></div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      nper = 12</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="comment">C First check for the PGA case (i.e., specT=0.0) </span></div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;      <span class="keywordflow">if</span> (spect .eq. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;         period   = per1(1)</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;         ct      = c(1)</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;         dt      = d(1)</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;         <span class="keywordflow">goto</span> 1011</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      <span class="keywordflow">elseif</span> (spect .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;<span class="comment">C Now loop over the spectral period range of the attenuation relationship.</span></div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;         <span class="keywordflow">do</span> i=2,nper-1</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;            <span class="keywordflow">if</span> (spect .ge. per1(i) .and. spect .le. per1(i+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;               count1 = i</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;               count2 = i+1</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;               <span class="keywordflow">goto</span> 1020 </div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="keywordflow">         enddo</span></div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;     </div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Atkinson (2010) Hor. Fena adustment model&#39;</span></div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;is not defined for a spectral period of: &#39;</span></div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(a10,f10.5)&#39;</span>) <span class="stringliteral">&#39; Period = &#39;</span>,spect</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;This spectral period is outside the defined&#39;</span></div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;period range in the code or beyond the range&#39;</span></div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;of spectral periods for interpolation.&#39;</span></div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Please check the input file.&#39;</span></div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <span class="keyword">write</span> (*,*) </div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;      stop 99</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<span class="comment">C Interpolate the coefficients for the requested spectral period.</span></div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; 1020 <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (per1(count1),per1(count2),c(count1),c(count2),</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;     +             spect,ct,iflag)</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      <span class="keyword">call </span><a class="code" href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a> (per1(count1),per1(count2),d(count1),d(count2),</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;     +             spect,dt,iflag)</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160; 1011 period = spect                                                    <span class="comment">                                                          </span></div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">c     Compute the ground motions adjustment factor.</span></div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      factor = ct + dt*jbdist</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      factor = factor*alog(10.0)</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      <span class="keywordflow">return</span>                                                            <span class="comment">        </span></div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;<span class="comment"></span><span class="keyword">      end                                                                                                                                                   </span></div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;     </div><div class="ttc" id="eus__atten2_8f_html_a3ee501c18b63c599d10680c0ca5890db"><div class="ttname"><a href="eus__atten2_8f.html#a3ee501c18b63c599d10680c0ca5890db">pea2c</a></div><div class="ttdeci">subroutine pea2c(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00009">eus_atten2.f:9</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_af6190c9108c5f62da7b4f165c915863f"><div class="ttname"><a href="eus__atten2_8f.html#af6190c9108c5f62da7b4f165c915863f">pea1ccl</a></div><div class="ttdeci">subroutine pea1ccl(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00778">eus_atten2.f:778</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_ae67cdd1428600f062595f32f2b81f64e"><div class="ttname"><a href="eus__atten2_8f.html#ae67cdd1428600f062595f32f2b81f64e">peag1cvh</a></div><div class="ttdeci">subroutine peag1cvh(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01432">eus_atten2.f:1432</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a2f7ded5ca75d6e7571f4880b48944ef3"><div class="ttname"><a href="eus__atten2_8f.html#a2f7ded5ca75d6e7571f4880b48944ef3">peag1ccms</a></div><div class="ttdeci">subroutine peag1ccms(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02195">eus_atten2.f:2195</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a59dedc7af4a5e8bb22c89633e0c0f4a6"><div class="ttname"><a href="eus__atten2_8f.html#a59dedc7af4a5e8bb22c89633e0c0f4a6">chy03eps</a></div><div class="ttdeci">subroutine chy03eps(mag, rupdist, sigmaeps, specT, period, iflag</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02571">eus_atten2.f:2571</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_aebeebc562ae3de2086f83b636b1d6c6b"><div class="ttname"><a href="eus__atten2_8f.html#aebeebc562ae3de2086f83b636b1d6c6b">peag2cs</a></div><div class="ttdeci">subroutine peag2cs(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01323">eus_atten2.f:1323</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_af8269f5b1274ae04a59b8207d3e18dc6"><div class="ttname"><a href="eus__atten2_8f.html#af8269f5b1274ae04a59b8207d3e18dc6">ab06sf2</a></div><div class="ttdeci">subroutine ab06sf2(mag, specT, period, SF2)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02833">eus_atten2.f:2833</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a6f2ab4c93f6e590a5287c07ffd63a0ab"><div class="ttname"><a href="eus__atten2_8f.html#a6f2ab4c93f6e590a5287c07ffd63a0ab">ab06</a></div><div class="ttdeci">subroutine ab06(mag, rupdist, lnY, sigma, specT, period, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02691">eus_atten2.f:2691</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a047d43dc857c3b04ef1e726f1ef26d6b"><div class="ttname"><a href="eus__atten2_8f.html#a047d43dc857c3b04ef1e726f1ef26d6b">peag2c</a></div><div class="ttdeci">subroutine peag2c(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01214">eus_atten2.f:1214</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_af22d5adbec53ef7ce691e4d93e28bdc9"><div class="ttname"><a href="eus__atten2_8f.html#af22d5adbec53ef7ce691e4d93e28bdc9">peag1ccl</a></div><div class="ttdeci">subroutine peag1ccl(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01977">eus_atten2.f:1977</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a1f7faf94f96815d7f94020ae36b325a7"><div class="ttname"><a href="eus__atten2_8f.html#a1f7faf94f96815d7f94020ae36b325a7">ngasigma</a></div><div class="ttdeci">subroutine ngasigma(specT, period, sigma)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l03200">eus_atten2.f:3200</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a8c0b6edb5f7a8492f657ac34d7106c29"><div class="ttname"><a href="eus__atten2_8f.html#a8c0b6edb5f7a8492f657ac34d7106c29">pea1cch</a></div><div class="ttdeci">subroutine pea1cch(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00560">eus_atten2.f:560</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a4c3fdf163e0d79bcdef0b1edab41bcc3"><div class="ttname"><a href="eus__atten2_8f.html#a4c3fdf163e0d79bcdef0b1edab41bcc3">pea1cvl</a></div><div class="ttdeci">subroutine pea1cvl(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00451">eus_atten2.f:451</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a9abbbaeb6304476dddb73f3147fe90dd"><div class="ttname"><a href="eus__atten2_8f.html#a9abbbaeb6304476dddb73f3147fe90dd">pea1cvm</a></div><div class="ttdeci">subroutine pea1cvm(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00342">eus_atten2.f:342</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_aaad734621b0a61901d285498e9539489"><div class="ttname"><a href="eus__atten2_8f.html#aaad734621b0a61901d285498e9539489">fena</a></div><div class="ttdeci">subroutine fena(jbdist, specT, Factor)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l03266">eus_atten2.f:3266</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_ae26e6f6a3ef9e49a6a6edcf09f78a3c4"><div class="ttname"><a href="eus__atten2_8f.html#ae26e6f6a3ef9e49a6a6edcf09f78a3c4">pea1ccms</a></div><div class="ttdeci">subroutine pea1ccms(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00996">eus_atten2.f:996</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a9a305f9c42f7889b6b2e3e5ce4e1ea36"><div class="ttname"><a href="eus__atten2_8f.html#a9a305f9c42f7889b6b2e3e5ce4e1ea36">pea1ccm</a></div><div class="ttdeci">subroutine pea1ccm(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00669">eus_atten2.f:669</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a2dbf76adb778dfaf5f63d1b342d3b2f7"><div class="ttname"><a href="eus__atten2_8f.html#a2dbf76adb778dfaf5f63d1b342d3b2f7">ab06vs760</a></div><div class="ttdeci">subroutine ab06vs760(mag, rupdist, lnY, sigma, specT, period, if</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02911">eus_atten2.f:2911</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_ace0e5164f379cf2e4dc3d960198017e2"><div class="ttname"><a href="eus__atten2_8f.html#ace0e5164f379cf2e4dc3d960198017e2">chy03</a></div><div class="ttdeci">subroutine chy03(mag, rupdist, lnY, sigma, specT, period, iflag</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02413">eus_atten2.f:2413</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a9f81d0ef212398bf2ecaecf3455e7f30"><div class="ttname"><a href="eus__atten2_8f.html#a9f81d0ef212398bf2ecaecf3455e7f30">pea1cchs</a></div><div class="ttdeci">subroutine pea1cchs(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00887">eus_atten2.f:887</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a083d76574f09ec6b9d1ccd534f8ac598"><div class="ttname"><a href="eus__atten2_8f.html#a083d76574f09ec6b9d1ccd534f8ac598">pea2cs</a></div><div class="ttdeci">subroutine pea2cs(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00121">eus_atten2.f:121</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a0c33d4c22cfc333fc025a3d23b15087b"><div class="ttname"><a href="eus__atten2_8f.html#a0c33d4c22cfc333fc025a3d23b15087b">peag1cchs</a></div><div class="ttdeci">subroutine peag1cchs(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02086">eus_atten2.f:2086</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_aafe3e2b0d527f9869bd46a090cb19e06"><div class="ttname"><a href="eus__atten2_8f.html#aafe3e2b0d527f9869bd46a090cb19e06">peag1cvm</a></div><div class="ttdeci">subroutine peag1cvm(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01541">eus_atten2.f:1541</a></div></div>
<div class="ttc" id="_i_n_t_e_r_p_8_f_html_a3b63d0d3b0cb443bb1121777ae4eb18b"><div class="ttname"><a href="_i_n_t_e_r_p_8_f.html#a3b63d0d3b0cb443bb1121777ae4eb18b">interp</a></div><div class="ttdeci">subroutine interp(x1, x2, y1, y2, x, y, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="_i_n_t_e_r_p_8_f_source.html#l00002">INTERP.F:2</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a00f776613e0e13dbbec15eeb6ad82393"><div class="ttname"><a href="eus__atten2_8f.html#a00f776613e0e13dbbec15eeb6ad82393">peag1cch</a></div><div class="ttdeci">subroutine peag1cch(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01759">eus_atten2.f:1759</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_aa1d91966cd23f8c254921799ea51da8f"><div class="ttname"><a href="eus__atten2_8f.html#aa1d91966cd23f8c254921799ea51da8f">a08vs760</a></div><div class="ttdeci">subroutine a08vs760(mag, jbdist, specT, BA08lnY, period, LnY, si</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l03051">eus_atten2.f:3051</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a1f5dbdc358fa5a0779e574c5f0c239d3"><div class="ttname"><a href="eus__atten2_8f.html#a1f5dbdc358fa5a0779e574c5f0c239d3">peag1cvl</a></div><div class="ttdeci">subroutine peag1cvl(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01650">eus_atten2.f:1650</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a4c71b6a4d4e38aaad27489dfbc1fa6b2"><div class="ttname"><a href="eus__atten2_8f.html#a4c71b6a4d4e38aaad27489dfbc1fa6b2">peag1ccm</a></div><div class="ttdeci">subroutine peag1ccm(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01868">eus_atten2.f:1868</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_aee3e307f8f053d4a73c840ae7a03a9ed"><div class="ttname"><a href="eus__atten2_8f.html#aee3e307f8f053d4a73c840ae7a03a9ed">pea1cvh</a></div><div class="ttdeci">subroutine pea1cvh(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l00233">eus_atten2.f:233</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a554df458a0b5d6747f91bb0cc0b89c1f"><div class="ttname"><a href="eus__atten2_8f.html#a554df458a0b5d6747f91bb0cc0b89c1f">a08vs760c0</a></div><div class="ttdeci">subroutine a08vs760c0(mag, jbdist, specT, BA08lnY, period, LnY,</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l03126">eus_atten2.f:3126</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a7b6f430f4d4db19519beb503ff7a850c"><div class="ttname"><a href="eus__atten2_8f.html#a7b6f430f4d4db19519beb503ff7a850c">pea1ccls</a></div><div class="ttdeci">subroutine pea1ccls(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l01105">eus_atten2.f:1105</a></div></div>
<div class="ttc" id="eus__atten2_8f_html_a75d26b4056fe1999e43983c4d96975fa"><div class="ttname"><a href="eus__atten2_8f.html#a75d26b4056fe1999e43983c4d96975fa">peag1ccls</a></div><div class="ttdeci">subroutine peag1ccls(m, dist, lnY, sig, specT, attenName, period1, iflag)</div><div class="ttdef"><b>Definition:</b> <a href="eus__atten2_8f_source.html#l02304">eus_atten2.f:2304</a></div></div>
<div class="ttc" id="pfrisk_8h_html_a07b5af1b8e2529943ce4641a39eb2595"><div class="ttname"><a href="pfrisk_8h.html#a07b5af1b8e2529943ce4641a39eb2595">parameter</a></div><div class="ttdeci">c Set array dimensions integer MAX_DD integer MAX_S7 parameter(MAX_FLT=80, MAX_SEG=300, MAX_INTEN=18, MAX_PROB=16, 1 MAX_EPS=10, MAX_Xcost=10, MAXPARAM=300, MAX_MAG=30, 2 MAX_DIST=25, MAX_N1=220, MAX_WIDTH=15, MAX_DIST1=10000, 3 MAX_GRID=32000, MAX_SYN=5, MAX_AMPMAG=25, MAX_AMPPER=15, 4 MAX_AMPGM=15, MAX_PER=501, MAXDETM_DIST=2000, MAX_DD=12) parameter(MAXFLT_DD</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_501bdb11da9e3ff85a05ee91b220e720.html">Git</a></li><li class="navelem"><a class="el" href="dir_fb0652c5df5b9249afd6543e61919164.html">HAZ</a></li><li class="navelem"><a class="el" href="dir_892b289c2f584a2bd261aaf29ea15680.html">HAZ files</a></li><li class="navelem"><a class="el" href="eus__atten2_8f.html">eus_atten2.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
