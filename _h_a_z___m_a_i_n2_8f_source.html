<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HAZ: D:/Git/HAZ/HAZ files/HAZ_MAIN2.f Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HAZ
   &#160;<span id="projectnumber">45.2</span>
   </div>
   <div id="projectbrief">Probabilistic Seismic Hazard Analysis written by Norm Abrahamson.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_h_a_z___m_a_i_n2_8f_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">HAZ_MAIN2.f</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_h_a_z___m_a_i_n2_8f.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="_h_a_z___m_a_i_n2_8f.html#a5c89e38a3011dfa8bae06bdd27304888">    1</a></span>&#160;      <span class="keyword">program</span> <a class="code" href="_h_a_z___m_a_i_n2_8f.html#a5c89e38a3011dfa8bae06bdd27304888">haz45_2</a></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">c     Probabilisitic Seismic Hazard Program (PSHA) </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;      include <span class="stringliteral">&#39;pfrisk.h&#39;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;      include <span class="stringliteral">&#39;declare1.h&#39;</span> </div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;   </div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">c     Write Program information to the screen.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;*********************************&#39;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;*          Hazard Code          *&#39;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;*        Release HAZ45.2        *&#39;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;*      Tagged Jan 2, 2017       *&#39;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;*********************************&#39;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      <span class="keyword">write</span> (*,*)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Enter number of cases to run in batch mode.&#39;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;         (For a single run enter 0)&#39;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <span class="keyword">read</span> (*,*) <a class="code" href="declare1_8h.html#a4993f66c79e366a66dc779a31d901dc8">bnum</a></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#a4993f66c79e366a66dc779a31d901dc8">bnum</a> .eq. 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;          <a class="code" href="declare1_8h.html#ad69b99d30a7a73ac256ae5f310a4e826">bnumflag</a> = 0 </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;          <a class="code" href="declare1_8h.html#a4993f66c79e366a66dc779a31d901dc8">bnum</a> = 1</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;          <a class="code" href="declare1_8h.html#ad69b99d30a7a73ac256ae5f310a4e826">bnumflag</a> = 1</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="declare1_8h.html#ad69b99d30a7a73ac256ae5f310a4e826">bnumflag</a> .eq. 1) <span class="keywordflow">then</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;         <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Enter the batch mode filename.&#39;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;         <span class="keyword">read</span> (*,<span class="stringliteral">&#39;(a80)&#39;</span>) filebmode</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;         <span class="keyword">open</span> (77,file=filebmode,status=<span class="stringliteral">&#39;old&#39;</span>)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    </div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">c     Start loop over number of batch mode runs</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordflow">do</span> 2000 <a class="code" href="declare1_8h.html#a91816cd48ef58bc937222bbdd0490818">ibnum</a>=1,<a class="code" href="declare1_8h.html#a4993f66c79e366a66dc779a31d901dc8">bnum</a></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#ad69b99d30a7a73ac256ae5f310a4e826">bnumflag</a> .eq. 1) <span class="keywordflow">then</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Looping over Number of Batch Mode Cases: &#39;</span>, <a class="code" href="declare1_8h.html#a91816cd48ef58bc937222bbdd0490818">ibnum</a><span class="comment">, <a class="code" href="declare1_8h.html#a4993f66c79e366a66dc779a31d901dc8">bnum</a></span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span><span class="keywordflow">         endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">c     Read Run File</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keyword">call </span><a class="code" href="_f_r_i_s_k___i_o_8_f.html#af017351a3d205ac37caf9ef1feaba62f">rdinput</a> ( nprob, nattentype, natten, <a class="code" href="declare1_8h.html#a410bd95b31df40209024ee3bbe23d17e">jcalc</a>, spect, sigtrunc,</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;     1               gmscale, <a class="code" href="declare1_8h.html#abd7f7881d0a05c4b906e3e1c9734d6f0">dirflag</a>, ninten, testinten, lgtestinten, </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;     2               pscorflag, <a class="code" href="declare1_8h.html#acf2c6029872515169abc461fd94ada4c">minlat</a>, <a class="code" href="declare1_8h.html#a242f4a7d0c47d4064d14de06cef38bf9">maxlat</a>, <a class="code" href="declare1_8h.html#abff3261f6e5846a446bf1b376826c3d1">minlong</a>, <a class="code" href="declare1_8h.html#a6de059b03ce46fea2b044778c4cce2b2">maxlong</a>, <a class="code" href="declare1_8h.html#ad68a599654b791fd4e905213958feffa">distmax</a><span class="comment">,</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">     3               nmagbins, magbins, ndistbins, distbins, nepsbins, epsbins,</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">     4               nxcostbins, xcostbins, soilampflag, <a class="code" href="declare1_8h.html#a8d2856e4279f9cb76c94192b1fb05671">gm_wt</a>, <a class="code" href="declare1_8h.html#aa0f8729ddc30f22e866790f5f9a91301">sigvaradd</a>,</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">     5               scalc, <a class="code" href="declare1_8h.html#a10ef7108e44be6f52a2aceba2df4f3d9">sigfix</a>, <a class="code" href="declare1_8h.html#ad69b99d30a7a73ac256ae5f310a4e826">bnumflag</a>, <a class="code" href="declare1_8h.html#a9fe9aaa1a53974ce93603abe5f18d41f">cfcoefrrup</a>, cfcoefrjb, </span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">     6               coefcountrrup, coefcountrjb, imixture, version )</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c     read fault File</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">call </span><a class="code" href="read_flt_8f.html#afac1d52d6a52371b9cb7c1cce1dc4052">rd_fault_data</a> ( nflt, fname, minmag, magstep, xstep,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;     1     ystep, segmodelwt, rateparam, rateparamwt, <a class="code" href="declare1_8h.html#a109b7250162d39fb6bc1a2dba1ccb63c">beta</a>,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;     2     magrecur, magrecurwt, faultwidth, faultwidthwt, maxmag,  </div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;     3     maxmagwt, flong, flat, fz, <a class="code" href="declare1_8h.html#a0803428660b8e9cfe79908b8f2b4ea07">dip</a>, <a class="code" href="declare1_8h.html#aef655e8bd0b6a7a325a3a2e49f069ca9">nfp</a>, nmag, <a class="code" href="declare1_8h.html#a41d11388bddf633f294d9e92f029ac8f">ftype</a>, </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;     4     sourcetype, nruparea, coeff_area, sigarea, nrupwidth, </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;     5     <a class="code" href="declare1_8h.html#a3c54f442fbfc3e628e14322e5f5a8525">coeff_width</a>, sigwidth, nparamvar, icoor, mindepth,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;     6     findex, probact, nwidth, <a class="code" href="declare1_8h.html#a2713f4e8b84f0415af10eaa0131d4fad">mpdf_param</a>, al_segwt, attentype, </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;     7     samplestep, grid_a, <a class="code" href="declare1_8h.html#a61a71fe6610eb2c5afb0acd3b413dab1">grid_dlong</a>, <a class="code" href="declare1_8h.html#ac7814e6d7c48d05329788fa63414abf6">grid_dlat</a>, <a class="code" href="declare1_8h.html#a3e3f1b96bdecca79e0f48ef1827f159f">grid_n</a>,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;     8     <a class="code" href="declare1_8h.html#a95f5f61f5d8cf50c3e5cdd4e0d98bf19">grid_long</a>, <a class="code" href="declare1_8h.html#a621b5880f0f69cb2bdcbe9098e03ae68">grid_lat</a>, <a class="code" href="declare1_8h.html#af9d535bac255a5f3e7c1d35fd33fff07">grid_top</a>, <a class="code" href="declare1_8h.html#acf2c6029872515169abc461fd94ada4c">minlat</a>, <a class="code" href="declare1_8h.html#a242f4a7d0c47d4064d14de06cef38bf9">maxlat</a>, <a class="code" href="declare1_8h.html#abff3261f6e5846a446bf1b376826c3d1">minlong</a>, </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;     9     <a class="code" href="declare1_8h.html#a6de059b03ce46fea2b044778c4cce2b2">maxlong</a>, scalerate, <a class="code" href="declare1_8h.html#ae3ac683bf28502a1ef78e8e1913ccd51">fsys</a>, mmagout, mmagoutwt, fltdirect, </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;     1     <a class="code" href="declare1_8h.html#a4993bfeb7bf0592c21f1d024b91c0f37">synchron</a>, nsyn_case, <a class="code" href="declare1_8h.html#a49efe302003a6b9eae05c142ad7bee68">synjcalc</a>, synmag, syndistrup, </div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;     2     syndistjb, syndistseismo, <a class="code" href="declare1_8h.html#a683215e4b6c04196fece3d7aa6101598">synhypo</a>, synftype, synhwflag, </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;     3     synwt, ratetype, idepthmodel, depthparam, nmaxmag2, segwt1, </div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;     4     faultflag, ndd, nftype, <a class="code" href="declare1_8h.html#a3b31dc16594219f46063ccd767c834b9">ftype_wt</a>, </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;     5     segmodelflag, nsegmodel, segmodelwt1, <a class="code" href="declare1_8h.html#a6c17d53e638d70c9937f813616a6a81a">syn_dip</a>, </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;     6     syn_ztor, syn_rupwidth, syn_rx, syn_ry0, mags7, rates7,  </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;     7     dists7, dips7, mechs7, ncounts7, version )             </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;     </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">c     Loop Over Number of Sites</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keyword">read</span> (13,*,err=2100) nsite    </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">do</span> 1000 <a class="code" href="declare1_8h.html#a5c1d5627a6babc1b812270c6c67fc8d8">isite</a> = 1, nsite      </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">c      Read site coordinates and properties</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;       <span class="keyword">read</span> (13,*,err=2101) sitex, sitey, <a class="code" href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a>, <a class="code" href="declare1_8h.html#af336fb56c8a9d14569f2b3400dd2a190">depthvs10</a>, <a class="code" href="declare1_8h.html#ac3732a33ca1b52c1d2ef65e3d0c3a463">depthvs15</a>, d25,<span class="comment"> vrup, forearc</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">       </span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">c      Read site-specific site amplification</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;       <span class="keywordflow">if</span> ( soilampflag .eq. 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">call </span><a class="code" href="soil_a_mp_8f.html#a46c862201e5082cdcca6dfae8631bee3">rdsoilampmodel</a> ( refperiod, nrefper, refgm, nrefgm, refgm_mag<span class="comment">, nrefmag, <a class="code" href="declare1_8h.html#ab254a325c9227352c2c928fb8a3ae9dc">amp</a> )</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span><span class="keywordflow">       endif</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">c      Open Output1 file which will contain the individual hazard curves. </span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       <span class="keyword">read</span> (13,<span class="stringliteral">&#39;( a80)&#39;</span>,err=2102) <a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       <span class="keyword">open</span> (11,file=<a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a>,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       <span class="keyword">write</span> (11, *) <span class="stringliteral">&#39;45.2 Haz45.2 Out1 file - individual hazard curves&#39;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">c      Open Output2 file for Probability of Magnitude Density for each parameter combination.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       <span class="keyword">read</span> (13,<span class="stringliteral">&#39;( a80)&#39;</span>,err=2104) <a class="code" href="declare1_8h.html#a181beca2e69e4992945b0d841e1720ba">file2</a></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       <span class="keyword">open</span> (17,file=<a class="code" href="declare1_8h.html#a181beca2e69e4992945b0d841e1720ba">file2</a>,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       <span class="keyword">write</span> (17, *) <span class="stringliteral">&#39;45.2 Haz45.2 Out2 file - magnitude recurrence curves for SSC fractile code&#39;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       <span class="keyword">write</span> (17,<span class="stringliteral">&#39;(i15, 3x,&#39;</span><span class="stringliteral">&#39;nFlt, nWidth&#39;</span><span class="stringliteral">&#39;)&#39;</span>) nflt</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;       <span class="keyword">write</span> (17,<span class="stringliteral">&#39;( 20i5)&#39;</span>) (nwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>=1,nflt)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">c      Open Output3 file</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       <span class="keyword">read</span> (13,<span class="stringliteral">&#39;( a80)&#39;</span>,err=2106) <a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       <span class="keyword">open</span> (12,file=<a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a>,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       <span class="keyword">write</span> (12, *) <span class="stringliteral">&#39;45.2 Haz45.2 Out3 file - mean hazard curves&#39;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">c      Open Output4 file</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       <span class="keyword">read</span> (13,<span class="stringliteral">&#39;( a80)&#39;</span>) <a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       <span class="keyword">open</span> (14,file=<a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a>,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       <span class="keyword">write</span> (14, *) <span class="stringliteral">&#39;45.2 Haz45.2 Out4 file - deaggregation output&#39;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       </div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">c      Open Output5 file which will contain the individual source hazard curves averaged over GMPEs.</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       <span class="keyword">read</span> (13,<span class="stringliteral">&#39;( a80)&#39;</span>,err=2105) <a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       <span class="keyword">open</span> (27,file=<a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a>,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       <span class="keyword">write</span> (27, *) <span class="stringliteral">&#39;45.2 Haz45.2 Out5 file - SSC tornado output file&#39;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       </div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">c      Open Output6 file which will contain the individual GMPE hazard curves over SSC models.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;       <span class="keyword">read</span> (13,<span class="stringliteral">&#39;( a80)&#39;</span>,err=2106) <a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;       <span class="keyword">open</span> (28,file=<a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a>,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;       <span class="keyword">write</span> (28, *) <span class="stringliteral">&#39;45.2 Haz45.2 Out6 file - GMC tornado output file&#39;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">c      Open Output7 file which will contain deaggregations for each source.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;       <span class="keyword">read</span> (13,<span class="stringliteral">&#39;( a80)&#39;</span>,err=2107) <a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       <span class="keyword">open</span> (29,file=<a class="code" href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a>,status=<span class="stringliteral">&#39;unknown&#39;</span>)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       <span class="keyword">write</span> (29, *) <span class="stringliteral">&#39;45.2 Haz45.2 Out7 file - deaggregation by source&#39;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">c      Initialize Haz Arrays to zero</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a308a2890c5536099d15bceaf77764e99">inithaz</a> ( haz )</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a308a2890c5536099d15bceaf77764e99">inithaz</a> ( <a class="code" href="declare1_8h.html#ab3c17a2c36893962139c274f6402f665">magbar1</a> )</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a7ea2090dc25db51c6deaefbc19de656c">inithazbins</a> ( hazbins )</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;       <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#ab9286506a5078127ed5eb07a04293de7">inithazbinsx</a> ( hazbinsx )</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">c      Initialize Mean Deagg values for this site</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a5ccff40ae584ce39ba40d72491e00a03">initdeagg</a> ( <a class="code" href="declare1_8h.html#a9be97e5ce41416ace67ec17d5518fa5c">m_bar</a>, <a class="code" href="declare1_8h.html#a483b55ce3bc209449d5ae63e297c5deb">d_bar</a>, <a class="code" href="declare1_8h.html#a55c83755b4666c5d58f1be488ac6a9ea">e_bar</a>, xcost_bar )</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;       <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a2012499d2e334818adbf827174debca1">initdeagg2</a> ( m_bar_s, <a class="code" href="declare1_8h.html#a5562580baa067ca8384674392b0b36e9">rrup_bar_s</a>, <a class="code" href="declare1_8h.html#af36e952aa7a050a230ac429ad69aa0c9">rjb_bar_s</a>, <a class="code" href="declare1_8h.html#aded0d2d92d2d93d8e0302f5560248f16">rx_bar_s</a>, <a class="code" href="declare1_8h.html#a406976e84daa9482be427d5e00521349">e_bar_s</a><span class="comment">)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">C      Initialize temp hazard array for GM sensitivity</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;       <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a60868fa932f81c34d1b97a537b8ab600">init_temphaz2</a> ( temphaz2 )</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">c      Sum Over Number of sources </span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;       <span class="keywordflow">do</span> 900 <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a> = 1, nflt</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keyword">write</span> (*,<span class="stringliteral">&#39;(2x,&#39;</span><span class="stringliteral">&#39;Site = &#39;</span><span class="stringliteral">&#39;,i4,&#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;,&#39;</span><span class="stringliteral">&#39;iFlt =&#39;</span><span class="stringliteral">&#39;,4i5)&#39;</span>) <a class="code" href="declare1_8h.html#a5c1d5627a6babc1b812270c6c67fc8d8">isite</a>, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a><span class="comment">, nflt, sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#a91816cd48ef58bc937222bbdd0490818">ibnum</a></span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">c       Write fault width weights to output2 file</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">write</span> (17,<span class="stringliteral">&#39;( 20f10.6)&#39;</span>) (faultwidthwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iwidth),iwidth=1,nwidth<span class="comment">(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>))</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">c       Initialize p1_sum (check of the integration over all source pdfs)</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="declare1_8h.html#a63dc83e22f46d3d373540edf56306151">p1_sum</a> = 0.</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">c       Initialize closest distance for each distance metric</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a4c0fe0342b61f0175a97ddf8e0b4aff8">initmindis</a> (<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, nwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), minrrup_temp, minrjb_temp, minseismo_temp<span class="comment">, sourcedist)</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> </span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">c       Loop over alternative Fault Widths (epistemic)</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">c       (This changes the geometry of the source)</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">do</span> 860 ifltwidth=1,nwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)     </div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">C         Initialize temp hazard array for this source</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a67198046cc3c6ac91e0fe39511c77d53">init_temphaz</a> ( temphaz )</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a87f0bcb2ea7a26404b4eca6a5c229166">init_temphaz1</a> ( temphaz1 )</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">c        Set bottom of fault for standard faults (source type 1)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">if</span> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 1. ) <span class="keywordflow">then</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keyword">call </span><a class="code" href="_f_l_t___s_e_g_8_f.html#a73f366d31b28bc5306b15f004864572b">setfltbottom</a> (icoor, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, <a class="code" href="declare1_8h.html#aef655e8bd0b6a7a325a3a2e49f069ca9">nfp</a>, <a class="code" href="declare1_8h.html#a0803428660b8e9cfe79908b8f2b4ea07">dip</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth,1), </div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     1                         faultwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth), fz, flat, flong<span class="comment">, ndd)</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span><span class="keywordflow">          endif</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">c        Convert Long, Lat to x,y in km and put into new array (1-D)</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;           <span class="keyword">call </span><a class="code" href="_f_l_t___s_e_g_8_f.html#aab478ba7e68ed436ebbfbdd869dffc8f">convertcoordinates2</a> (<a class="code" href="declare1_8h.html#aef655e8bd0b6a7a325a3a2e49f069ca9">nfp</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, icoor, <a class="code" href="declare1_8h.html#a3e3f1b96bdecca79e0f48ef1827f159f">grid_n</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a><span class="comment">), </span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">     1           sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), ndd(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), sitex, sitey, flat, flong, fz, </span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">     2           <a class="code" href="declare1_8h.html#a621b5880f0f69cb2bdcbe9098e03ae68">grid_lat</a>, <a class="code" href="declare1_8h.html#a95f5f61f5d8cf50c3e5cdd4e0d98bf19">grid_long</a>, <a class="code" href="declare1_8h.html#ac7814e6d7c48d05329788fa63414abf6">grid_dlat</a>, <a class="code" href="declare1_8h.html#a61a71fe6610eb2c5afb0acd3b413dab1">grid_dlong</a>, npts, xflt, yflt, </span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">     3           zflt, <a class="code" href="declare1_8h.html#ac29792c01f0cf1350ba99f381677e728">grid_x</a>, <a class="code" href="declare1_8h.html#a4d1fadc3bb143444ccbafd19f9f6608f">grid_y</a>, <a class="code" href="declare1_8h.html#a4c02beb8d284d2138c43c13b57a685b4">grid_dx</a>, <a class="code" href="declare1_8h.html#ada53fa3b9c8c6ef4223c57edd666b701">grid_dy</a>, <a class="code" href="declare1_8h.html#a71d0af8a6371efa7ae06a5f4c339dbee">x0</a>, <a class="code" href="declare1_8h.html#ad4740a3e0778226634e81c4b63e0561b">y0</a>, <a class="code" href="declare1_8h.html#aab01ece185838b5e4628d931daf5d322">z0</a>) </span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">c        Turn fault into a grid </span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         <span class="keywordflow">if</span> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 1 .or. sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 5 .or. sourcetype<span class="comment">(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 6 ) </span><span class="keywordflow">then</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;           <span class="keyword">call </span><a class="code" href="_f_l_t___s_e_g_8_f.html#acb54bc6f200fd4433a276321b6c766f5">calcfltgrid</a> ( xflt, yflt, zflt, <a class="code" href="declare1_8h.html#aef655e8bd0b6a7a325a3a2e49f069ca9">nfp</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), ndd(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), fltgrid_x<span class="comment">, fltgrid_y,</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">     1               fltgrid_z, nfltgrid, fltgrid_a, fltgrid_w, <a class="code" href="declare1_8h.html#a71d0af8a6371efa7ae06a5f4c339dbee">x0</a>, <a class="code" href="declare1_8h.html#ad4740a3e0778226634e81c4b63e0561b">y0</a>, <a class="code" href="declare1_8h.html#aab01ece185838b5e4628d931daf5d322">z0</a>,</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">     2               fltgrid_rrup, fltgrid_rjb, faultarea, faultlen, avewidth, </span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">     3               xstep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), fltgrid_flen, fltgrid_x1, fltgrid_y1, </span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">     4               fltgrid_z1, fltgrid_x2, fltgrid_y2, fltgrid_z2, fltgrid_x3, </span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">     5               fltgrid_y3, fltgrid_z3, fltgrid_x4, fltgrid_y4, fltgrid_z4 )   </span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span><span class="keywordflow">         endif</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         <span class="keywordflow">if</span> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 1 .or. sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 5 ) </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;     1      <span class="keyword">write</span> (18,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;fault area (km^2) = &#39;</span><span class="stringliteral">&#39;,e12.3)&#39;</span>) faultarea</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">c        Set Sampling of Rupture Area and Rupture Width Distributions</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a7e34e0feef101f6a2b3b49fdffefe1e3">initrup</a> ( sigarea, nruparea, sigmaxarea, areastep, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#a7e34e0feef101f6a2b3b49fdffefe1e3">initrup</a> ( sigwidth, nrupwidth, sigmaxwidth, widthstep, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a><span class="comment">)</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">c        Compute horizontal distance density function for areal sources (polygons or gridded seismicity)</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;         <span class="keywordflow">if</span> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 2 ) <span class="keywordflow">then</span>        </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;           <span class="keyword">call </span><a class="code" href="_c_l_d_i_s_t_8_f.html#a147e663185c6a1e545027b6ae1c9de90">calcdistdensity</a> (npts, xflt, yflt, distdensity,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     1         xstep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nlocxas, <a class="code" href="declare1_8h.html#a71d0af8a6371efa7ae06a5f4c339dbee">x0</a>, <a class="code" href="declare1_8h.html#ad4740a3e0778226634e81c4b63e0561b">y0</a>, samplestep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>))         </div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;         <span class="keywordflow">elseif</span> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 3 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;           <span class="keyword">call </span><a class="code" href="_c_l_d_i_s_t_8_f.html#aca394a081bb81b3f323377a68c4d563f">calcdistdensity1</a> ( <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, grid_a, <a class="code" href="declare1_8h.html#ac29792c01f0cf1350ba99f381677e728">grid_x</a>, <a class="code" href="declare1_8h.html#a4d1fadc3bb143444ccbafd19f9f6608f">grid_y</a>, <a class="code" href="declare1_8h.html#a4c02beb8d284d2138c43c13b57a685b4">grid_dx</a><span class="comment">,</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">     1             <a class="code" href="declare1_8h.html#ada53fa3b9c8c6ef4223c57edd666b701">grid_dy</a>, <a class="code" href="declare1_8h.html#a3e3f1b96bdecca79e0f48ef1827f159f">grid_n</a>, distdensity, xstep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nlocxas,</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">     2             <a class="code" href="declare1_8h.html#a71d0af8a6371efa7ae06a5f4c339dbee">x0</a>, <a class="code" href="declare1_8h.html#ad4740a3e0778226634e81c4b63e0561b">y0</a>, samplestep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>))</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">         </span><span class="keywordflow">elseif</span> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 4 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;           <span class="keyword">call </span><a class="code" href="_c_l_d_i_s_t_8_f.html#ad5235f6539b0c40547cd1a6ba228b7b6">calcdistdensity2</a> ( <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, grid_a, <a class="code" href="declare1_8h.html#a3e3f1b96bdecca79e0f48ef1827f159f">grid_n</a>, distdensity2 )</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordflow">         endif</span>  </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">c        Compute activity rate: N(Mmin)</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;           <span class="keyword">call </span><a class="code" href="set_rates_8f.html#a59e3a106b280231567cf7a6fa7a23ec7">set_rates</a> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nparamvar, magrecur, <a class="code" href="declare1_8h.html#af41dfce8deb9feb1269f69c692100d04">rate</a>,<span class="comment"> <a class="code" href="declare1_8h.html#a109b7250162d39fb6bc1a2dba1ccb63c">beta</a>, minmag,</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">     1         maxmag, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, ifltwidth, faultarea, </span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">     2         rateparam, <a class="code" href="declare1_8h.html#a2713f4e8b84f0415af10eaa0131d4fad">mpdf_param</a>, magstep, ratetype, </span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">     1         charmeanmo, expmeanmo )</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">c        Intergrate Over Magnitude (from minMag to maxMag) (Aleatory)</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;         </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">c        Set nMag(iFlt) = ncount for Source Type 7 case</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;           <span class="keyword">write</span> (*,*) <span class="stringliteral">&#39;Number of sources for SourceType7 = &#39;</span>, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,nmag<span class="comment">(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span><span class="keywordflow">         endif</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         </div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         <span class="keywordflow">do</span> 800 imag = 1, nmag(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;           <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .ne. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;             <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a> = minmag(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) + (imag-0.5) * magstep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;           <span class="keywordflow">elseif</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;             <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a> = mags7(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,imag)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keywordflow">           endif</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;           magtotal = <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">c         Set the magnitude bin for deagregating</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#ae0b7146cadcc5f221cb2420fa5e80035">setbin</a> ( nmagbins, magbins, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, imagbin )</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">c         Compute Probability of mag between mag-magStep/2 and mag+magStep/2 </span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">c         using the magnitude pdf for each parameter variation</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keyword">call </span><a class="code" href="_m_a_g_p_r_o_b_8_f.html#a3dba02c8de2d7b38554ec6500773e41e">magprob</a> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, maxmag, minmag, magstep<span class="comment">, <a class="code" href="declare1_8h.html#a109b7250162d39fb6bc1a2dba1ccb63c">beta</a>, </span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">     1                    <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, ifltwidth, pmag, nparamvar, nwidth, magrecur, </span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">     2                    <a class="code" href="declare1_8h.html#a2713f4e8b84f0415af10eaa0131d4fad">mpdf_param</a>, expmeanmo, charmeanmo, rup1_flag)      </span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">c         Echo magnitude integration step over magnitude to the screen </span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">c         as a check of the programs progress.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .ne. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,2I5,f10.3)&#39;</span>) <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, ifltwidth, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keyword">write</span> (18,<span class="stringliteral">&#39;( 2x,2I5,f10.3)&#39;</span>) <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, ifltwidth, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          <span class="keywordflow">elseif</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            nn10000 = (imag/10000)*10000</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">if</span> (nn10000 .eq. imag) <span class="keywordflow">then</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;              <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,2I10,f10.3)&#39;</span>) imag, ncounts7(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>    <span class="comment">                      </span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span><span class="keywordflow">            endif</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">c         Intergrate Over Rupture Area for this mag (aleatory)</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          <span class="keywordflow">do</span> 750 iarea = 1, nruparea(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">c          Compute Rupture Area and Probability of Rupture Area</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;           <span class="keyword">call </span><a class="code" href="_n_p_r_o_b_8_f.html#a497834f5253c714a0f706900a78e1979">rupdimprob</a> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, coeff_area, sigarea,<span class="comment"> </span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">     1          areastep, sigmaxarea, ruparea, parea, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, iarea )</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">c          Intergrate Over Rupture Width for this mag (aleatory)</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;           <span class="keywordflow">do</span> 700 iwidth = 1, nrupwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">c           Compute Rupture Width and Probability of Rupture Width</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keyword">call </span><a class="code" href="_n_p_r_o_b_8_f.html#a497834f5253c714a0f706900a78e1979">rupdimprob</a> ( sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, <a class="code" href="declare1_8h.html#a3c54f442fbfc3e628e14322e5f5a8525">coeff_width</a>, sigwidth<span class="comment">, </span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">     1           widthstep, sigmaxwidth, rupwidth, pwidth, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, iwidth)</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">c-----------temporary code for Test 3---------</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">c-----------Christie Hale-------</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">c-----------written April 16 2015, don&#39;t forget to remove--------</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">c            rupWidth = sqrt(rupArea/2.)    </span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">c------------end temporary code</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keyword">call </span><a class="code" href="n_ruptures_8f.html#a7c4d9c5ac09568df519b750d5c23f71e">rupdims</a> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), rupwidth, avewidth, ruparea, faultlen<span class="comment">,</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">     1                faultwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth), nlocyst1, ystep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#af620a16f1a6c7fb9dcec16a69b62cb4b">ruplen</a>)</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">        </span><span class="keyword">call </span><a class="code" href="n_ruptures_8f.html#a95ef26cb609a77ec5e7afa5bf3eaf94a">nlocxcells</a> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nlocxas, <a class="code" href="declare1_8h.html#a3e3f1b96bdecca79e0f48ef1827f159f">grid_n</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nfltgrid<span class="comment">, fltgrid_w,</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">     1                   rupwidth, fltgrid_a, ruparea, nlocyst1, nlocx, n1as, n2as)</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">c           Integrate Over Rupture Location - along strike (aleatory)</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">c           This is along strike for faults and epicentral distance for source zones</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            idepthflag = 0</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">do</span> 650 ilocx = 1, nlocx</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;               <span class="keyword">call </span><a class="code" href="n_ruptures_8f.html#a0756b081bb6d950b457e511460b4edb4">nlocycells</a> (ilocx, n1as, sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nlocx, distdensity<span class="comment">, xstep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>),</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">     1                          faultwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth), ystep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), distdensity2, <a class="code" href="declare1_8h.html#ac29792c01f0cf1350ba99f381677e728">grid_x</a>,</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">     2                          <a class="code" href="declare1_8h.html#a4d1fadc3bb143444ccbafd19f9f6608f">grid_y</a>, <a class="code" href="declare1_8h.html#a71d0af8a6371efa7ae06a5f4c339dbee">x0</a>, <a class="code" href="declare1_8h.html#ad4740a3e0778226634e81c4b63e0561b">y0</a>, nlocy, plocx, <a class="code" href="declare1_8h.html#afe6b9eb1b76d8b77cb67a3d64ecc8192">r_horiz</a>)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">                  </span><span class="keywordflow">if</span> ( plocx .eq. 0. ) <span class="keywordflow">then</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <span class="keywordflow">goto</span> 650</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordflow">                  endif</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">c            set the probabilities for the depths</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;             <span class="keywordflow">if</span> ( idepthflag .eq. 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;               <span class="keyword">call </span><a class="code" href="calc_depth_prob_8f.html#af3db8f52363a70523bed3a93f4ce10aa">calcdepthprob</a> ( idepthmodel(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), depthparam, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<span class="comment"> plocy,</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">     1              sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nlocy, ystep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), zflt(1,1),</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">     2              faultwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth), rupwidth, <a class="code" href="declare1_8h.html#a0803428660b8e9cfe79908b8f2b4ea07">dip</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iwidth,1) )</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">               </span><span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .le. 2 .or. sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7)<span class="comment"> </span><span class="keywordflow">then</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                 idepthflag = 1</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordflow">               endif</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordflow">             endif</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">c            Integrate Over Rupture Location - Down Dip (aleatory)</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;             <span class="keywordflow">do</span> 600 ilocy = 1, nlocy</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">c            Find the Closest Distances for this rupture</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">c            Pass along fault grid locations for calculation of HW and Rx values within CalcDist subroutine.     </span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;             <span class="keyword">call </span><a class="code" href="_c_l_d_i_s_t_8_f.html#a63f1f22519010ec96c7bf9dca162d235">calcdist</a> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), pscorflag, nfltgrid, n1as,<span class="comment"> ilocx, ilocy, n2as,</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">     1             ifltwidth, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, imag, ystep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#af9d535bac255a5f3e7c1d35fd33fff07">grid_top</a>, rupwidth, <a class="code" href="declare1_8h.html#af620a16f1a6c7fb9dcec16a69b62cb4b">ruplen</a>, <a class="code" href="declare1_8h.html#afe6b9eb1b76d8b77cb67a3d64ecc8192">r_horiz</a>, mindepth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), </span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">     2             fltgrid_x, fltgrid_y, fltgrid_z, fltgrid_x1, fltgrid_y1, fltgrid_z1, </span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">     3             fltgrid_x2, fltgrid_y2, fltgrid_z2, fltgrid_x3, fltgrid_y3, fltgrid_z3,</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">     4             fltgrid_x4, fltgrid_y4, fltgrid_z4, fltgrid_rrup, fltgrid_rjb, <a class="code" href="declare1_8h.html#a0803428660b8e9cfe79908b8f2b4ea07">dip</a>, dips7,</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">     5             dists7, <a class="code" href="declare1_8h.html#ae137d003ca370f2cdcb9e33a7cf38376">hwflag</a>, <a class="code" href="declare1_8h.html#aa679c260b6e1515b7222ae5af951c549">n1</a>, <a class="code" href="declare1_8h.html#ab0776af43fdd3fefc150053ee1cbeb50">n2</a>, icellrupstrike, icellrupdip, hypodepth, distjb, </span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">     6             distrup, ztor, distseismo, <a class="code" href="declare1_8h.html#ab4688c7156ce33e6010ebd2a44c78548">distepi</a>, <a class="code" href="declare1_8h.html#a818e5f1686e8c24880163724560fc71e">disthypo</a>, dipavgd, rx, ry, ry0)</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">        </span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">c            Set minimum distances for output files.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;             <span class="keyword">call </span><a class="code" href="_c_l_d_i_s_t_8_f.html#a897604d95961a1162e0eb5377c74ba39">set_mindist</a> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, ifltwidth, distrup<span class="comment">, distjb, distseismo, </span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">     1                         sourcedist, minrrup_temp, minrjb_temp, minseismo_temp)</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">              </span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">c             Check if the distance is greater than Max dist for hazard     </span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;              <span class="keywordflow">if</span> ( distrup .gt. <a class="code" href="declare1_8h.html#ad68a599654b791fd4e905213958feffa">distmax</a> .and. distjb .gt. <a class="code" href="declare1_8h.html#ad68a599654b791fd4e905213958feffa">distmax</a>) <span class="keywordflow">goto</span> <span class="comment">600</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">c             Set the distance bin for de-aggregation (using rupture distance)                     </span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;              <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#ae0b7146cadcc5f221cb2420fa5e80035">setbin</a> ( ndistbins, distbins, distrup,idistbin)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">c             Loop over ftypes</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;              <span class="keywordflow">do</span> 561 iftype=1,nftype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">c             Loop Over Number of Problems (e.g. spectral periods)</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;              <span class="keywordflow">do</span> 560 iprob=1,nprob</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;               jtype = attentype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;               <span class="keywordflow">do</span> 550 iatten = 1,natten(iprob,jtype)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">c               Check for negative jcalc values which will set the corresponding sigma to </span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">C               either a fixed value or sigma from another model.</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <a class="code" href="declare1_8h.html#ab0939c2d307f29c06bf84c21cb9da4d5">sigflag</a> = 0</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#a410bd95b31df40209024ee3bbe23d17e">jcalc</a>(iprob,jtype,iatten) .lt. 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                   <a class="code" href="declare1_8h.html#a5497714c5ce92ebf65df0f94d8dc842b">jcalc1</a> = abs(<a class="code" href="declare1_8h.html#a410bd95b31df40209024ee3bbe23d17e">jcalc</a>(iprob,jtype,iatten) )</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                   <a class="code" href="declare1_8h.html#a13272b35692a94da98328a2080bc28cb">scalc1</a> = scalc(iprob,jtype,iatten) </div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                   sigfix1 = <a class="code" href="declare1_8h.html#a10ef7108e44be6f52a2aceba2df4f3d9">sigfix</a>(iprob,jtype,iatten)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">C                  Check for either fixed sigma value (scalc1&lt;0) or other sigma model</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                   <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#a13272b35692a94da98328a2080bc28cb">scalc1</a> .lt. 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                     <a class="code" href="declare1_8h.html#ab0939c2d307f29c06bf84c21cb9da4d5">sigflag</a> = 2</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                   <span class="keywordflow">else</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                     <a class="code" href="declare1_8h.html#ab0939c2d307f29c06bf84c21cb9da4d5">sigflag</a> = 1</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">                   endif</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                   <a class="code" href="declare1_8h.html#a5497714c5ce92ebf65df0f94d8dc842b">jcalc1</a> = <a class="code" href="declare1_8h.html#a410bd95b31df40209024ee3bbe23d17e">jcalc</a>(iprob,jtype,iatten) </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordflow">                endif</span> </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">c              Compute the median and sigma of the ground motions</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;               <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .ne. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                 <span class="keyword">call </span><a class="code" href="_m_e_d___a_t_t_8_f.html#aea1ab22924576fa6d996e526e3c26455">meaninten</a> ( distrup, distjb, distseismo,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;     1               <a class="code" href="declare1_8h.html#ae137d003ca370f2cdcb9e33a7cf38376">hwflag</a>, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, <a class="code" href="declare1_8h.html#a5497714c5ce92ebf65df0f94d8dc842b">jcalc1</a>, spect(iprob),  </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;     2               lginten, sigmay, <a class="code" href="declare1_8h.html#a41d11388bddf633f294d9e92f029ac8f">ftype</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iftype), attenname, <a class="code" href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a><span class="comment">, </span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">     3               iatten, iprob, jtype, <a class="code" href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a>, hypodepth, <a class="code" href="declare1_8h.html#a9f56226b7d87511e6657cd5239df0a7b">intflag</a>, ar, dipavgd,</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">     4               <a class="code" href="declare1_8h.html#a818e5f1686e8c24880163724560fc71e">disthypo</a>, <a class="code" href="declare1_8h.html#af336fb56c8a9d14569f2b3400dd2a190">depthvs10</a>, <a class="code" href="declare1_8h.html#ac3732a33ca1b52c1d2ef65e3d0c3a463">depthvs15</a>, d25, <a class="code" href="declare1_8h.html#a0241efdf3af12d1e4bf3bc94e885e342">tau</a>,</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">     5               ztor, theta_site, rupwidth, <a class="code" href="declare1_8h.html#a735a90a3885c309c9cf3c9db91b65e74">vs30_class</a>, forearc, rx, <a class="code" href="declare1_8h.html#ad26adc037da6a1a656f973cb1a50c6ea">phi</a>,</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">     6               <a class="code" href="declare1_8h.html#a9fe9aaa1a53974ce93603abe5f18d41f">cfcoefrrup</a>, cfcoefrjb, ry0 )</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">               </span><span class="keywordflow">elseif</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                 <span class="keyword">call </span><a class="code" href="_m_e_d___a_t_t_8_f.html#aea1ab22924576fa6d996e526e3c26455">meaninten</a> ( distrup, distjb, distseismo,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     1               <a class="code" href="declare1_8h.html#ae137d003ca370f2cdcb9e33a7cf38376">hwflag</a>, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, <a class="code" href="declare1_8h.html#a5497714c5ce92ebf65df0f94d8dc842b">jcalc1</a>, spect(iprob),  </div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;     2               lginten, sigmay, mechs7(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,imag), attenname, <a class="code" href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a><span class="comment">, </span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">     3               iatten, iprob, jtype, <a class="code" href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a>, hypodepth, <a class="code" href="declare1_8h.html#a9f56226b7d87511e6657cd5239df0a7b">intflag</a>, ar, dipavgd,</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">     4               <a class="code" href="declare1_8h.html#a818e5f1686e8c24880163724560fc71e">disthypo</a>, <a class="code" href="declare1_8h.html#af336fb56c8a9d14569f2b3400dd2a190">depthvs10</a>, <a class="code" href="declare1_8h.html#ac3732a33ca1b52c1d2ef65e3d0c3a463">depthvs15</a>, d25, <a class="code" href="declare1_8h.html#a0241efdf3af12d1e4bf3bc94e885e342">tau</a>,</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">     5               ztor, theta_site, rupwidth, <a class="code" href="declare1_8h.html#a735a90a3885c309c9cf3c9db91b65e74">vs30_class</a>, forearc, rx, <a class="code" href="declare1_8h.html#ad26adc037da6a1a656f973cb1a50c6ea">phi</a>,</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">     6               <a class="code" href="declare1_8h.html#a9fe9aaa1a53974ce93603abe5f18d41f">cfcoefrrup</a>, cfcoefrjb, ry0 )</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span><span class="keywordflow">              endif</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">c               Add epistemic uncertainty term (constant shift) to median</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                lginten = lginten + gmscale(iprob,jtype,iatten)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">C               Second Median Call for Complex/Splay Rupture Median</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">C               Ground Motions will be SRSS with main rupture median ground motions.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#a4993bfeb7bf0592c21f1d024b91c0f37">synchron</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                  nsyn_case(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) = 1</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                  synwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,1)= 1.0</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">c               Temp: set probability of syn rupture to unity</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">c               Later, this will be an input</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                probsyn = 1.</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">c               Loop over synchronous ruptures (aleatory)          </span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">do</span> 549 <a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>=1,nsyn_case(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                 <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#a4993bfeb7bf0592c21f1d024b91c0f37">synchron</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .gt. 0 .and. rup1_flag .eq. 1) <span class="keywordflow">then</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                  <span class="keyword">call </span><a class="code" href="_m_e_d___a_t_t_8_f.html#aea1ab22924576fa6d996e526e3c26455">meaninten</a> ( syndistrup(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), syndistjb(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a><span class="comment">,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), </span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">     1                syndistseismo(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>),</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">     2                synhwflag(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), synmag(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), <a class="code" href="declare1_8h.html#a49efe302003a6b9eae05c142ad7bee68">synjcalc</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), spect(iprob),  </span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">     3                lgintens, <a class="code" href="declare1_8h.html#af5a1f56d0aa084f97ea066cd3831cc38">temp</a>, synftype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), attenname, <a class="code" href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a>, </span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">     4                iatten, iprob, jtype, <a class="code" href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a>, <a class="code" href="declare1_8h.html#a683215e4b6c04196fece3d7aa6101598">synhypo</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,1), <a class="code" href="declare1_8h.html#a9f56226b7d87511e6657cd5239df0a7b">intflag</a>, ar, <a class="code" href="declare1_8h.html#a6c17d53e638d70c9937f813616a6a81a">syn_dip</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>),</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">     5                <a class="code" href="declare1_8h.html#a818e5f1686e8c24880163724560fc71e">disthypo</a>, <a class="code" href="declare1_8h.html#af336fb56c8a9d14569f2b3400dd2a190">depthvs10</a>, <a class="code" href="declare1_8h.html#ac3732a33ca1b52c1d2ef65e3d0c3a463">depthvs15</a>, d25, <a class="code" href="declare1_8h.html#a0241efdf3af12d1e4bf3bc94e885e342">tau</a>,</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">     6                syn_ztor(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), theta_site, syn_rupwidth(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), </span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">     7                <a class="code" href="declare1_8h.html#a735a90a3885c309c9cf3c9db91b65e74">vs30_class</a>, forearc, syn_rx(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>), <a class="code" href="declare1_8h.html#ad26adc037da6a1a656f973cb1a50c6ea">phi</a>,</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">     8                <a class="code" href="declare1_8h.html#a9fe9aaa1a53974ce93603abe5f18d41f">cfcoefrrup</a>, cfcoefrjb, syn_ry0(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>) )</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">c                 Compute SRSS of median                </span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  lginten = 0.5* alog( exp(lginten)**2 + exp(lgintens)**<span class="comment">2 )</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span><span class="keywordflow">                endif</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">C               Second call get GMPE for different sigma model </span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#ab0939c2d307f29c06bf84c21cb9da4d5">sigflag</a> .eq. 1) <span class="keywordflow">then</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                  <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .ne. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    <span class="keyword">call </span><a class="code" href="_m_e_d___a_t_t_8_f.html#aea1ab22924576fa6d996e526e3c26455">meaninten</a> ( distrup, distjb, distseismo,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;     1               <a class="code" href="declare1_8h.html#ae137d003ca370f2cdcb9e33a7cf38376">hwflag</a>, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, <a class="code" href="declare1_8h.html#a13272b35692a94da98328a2080bc28cb">scalc1</a>, spect(iprob),  </div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;     2               <a class="code" href="declare1_8h.html#af5a1f56d0aa084f97ea066cd3831cc38">temp</a>, sigmay, <a class="code" href="declare1_8h.html#a41d11388bddf633f294d9e92f029ac8f">ftype</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iftype), sigmaname, <a class="code" href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a><span class="comment">, </span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">     3               iatten, iprob, jtype, <a class="code" href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a>, hypodepth, <a class="code" href="declare1_8h.html#a9f56226b7d87511e6657cd5239df0a7b">intflag</a>, ar, dipavgd,</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">     4               <a class="code" href="declare1_8h.html#a818e5f1686e8c24880163724560fc71e">disthypo</a>, <a class="code" href="declare1_8h.html#af336fb56c8a9d14569f2b3400dd2a190">depthvs10</a>, <a class="code" href="declare1_8h.html#ac3732a33ca1b52c1d2ef65e3d0c3a463">depthvs15</a>, d25, <a class="code" href="declare1_8h.html#a0241efdf3af12d1e4bf3bc94e885e342">tau</a>,</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">     5               ztor, theta_site, rupwidth, <a class="code" href="declare1_8h.html#a735a90a3885c309c9cf3c9db91b65e74">vs30_class</a>, forearc, rx, <a class="code" href="declare1_8h.html#ad26adc037da6a1a656f973cb1a50c6ea">phi</a>, </span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">     6               <a class="code" href="declare1_8h.html#a9fe9aaa1a53974ce93603abe5f18d41f">cfcoefrrup</a>, cfcoefrjb, ry0 )</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">                  </span><span class="keywordflow">elseif</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    <span class="keyword">call </span><a class="code" href="_m_e_d___a_t_t_8_f.html#aea1ab22924576fa6d996e526e3c26455">meaninten</a> ( distrup, distjb, distseismo,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;     1               <a class="code" href="declare1_8h.html#ae137d003ca370f2cdcb9e33a7cf38376">hwflag</a>, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, <a class="code" href="declare1_8h.html#a5497714c5ce92ebf65df0f94d8dc842b">jcalc1</a>, spect(iprob),  </div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     2               lginten, sigmay, mechs7(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,imag), attenname, <a class="code" href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a><span class="comment">, </span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">     3               iatten, iprob, jtype, <a class="code" href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a>, hypodepth, <a class="code" href="declare1_8h.html#a9f56226b7d87511e6657cd5239df0a7b">intflag</a>, ar, dipavgd,</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">     4               <a class="code" href="declare1_8h.html#a818e5f1686e8c24880163724560fc71e">disthypo</a>, <a class="code" href="declare1_8h.html#af336fb56c8a9d14569f2b3400dd2a190">depthvs10</a>, <a class="code" href="declare1_8h.html#ac3732a33ca1b52c1d2ef65e3d0c3a463">depthvs15</a>, d25, <a class="code" href="declare1_8h.html#a0241efdf3af12d1e4bf3bc94e885e342">tau</a>,</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">     5               ztor, theta_site, rupwidth, <a class="code" href="declare1_8h.html#a735a90a3885c309c9cf3c9db91b65e74">vs30_class</a>, forearc, rx, <a class="code" href="declare1_8h.html#ad26adc037da6a1a656f973cb1a50c6ea">phi</a>,</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">     6               <a class="code" href="declare1_8h.html#a9fe9aaa1a53974ce93603abe5f18d41f">cfcoefrrup</a>, cfcoefrjb, ry0 )</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span><span class="keywordflow">                  endif</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">c               Check if a constant, user input sigma, is selected</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">elseif</span> (<a class="code" href="declare1_8h.html#ab0939c2d307f29c06bf84c21cb9da4d5">sigflag</a> .eq. 2) <span class="keywordflow">then</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                  sigmay = sigfix1</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">C               Adjust sigma value if sigvaradd .ne. 0.0</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="declare1_8h.html#aa0f8729ddc30f22e866790f5f9a91301">sigvaradd</a>(iprob,jtype,iatten) .ne. 0.0) <span class="keywordflow">then</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                  sigmay = sqrt(sigmay*sigmay + <a class="code" href="declare1_8h.html#aa0f8729ddc30f22e866790f5f9a91301">sigvaradd</a>(iprob,jtype,iatten<span class="comment">) )</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span><span class="keywordflow">                endif</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">c               Check that sigma is not less than zero (0.0001)</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="keywordflow">if</span> (sigmay .lt. 0.0001 ) sigmay = 0.0001</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">c               Reset SigmaTotal variable</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                sigmatotal = sigmay</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">c               Set values for use with directivity                </span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                lginten0 = lginten</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <a class="code" href="declare1_8h.html#a9368efafd606b3c4a2d53cd65addb2c4">sigma0</a> = sigmatotal</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                </div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">c               Set default for no randomization of hypocenters                </span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                nhypox = 1</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                phypox = 1.</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                nhypoxstep = 1</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                nhypoz = 1</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                phypoz = 1.</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                nhypozstep = 1</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">C               Application of Directivity model. </span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">if</span> ( fltdirect(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 1 .and. <a class="code" href="declare1_8h.html#abd7f7881d0a05c4b906e3e1c9734d6f0">dirflag</a>(iprob) .ge. 1</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;     1              .and. <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a> .gt. 5.6 .and. spect(iprob) .ge. 0.50 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                 dirflag1 = 1</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                 <span class="keywordflow">if</span> ( <a class="code" href="declare1_8h.html#abd7f7881d0a05c4b906e3e1c9734d6f0">dirflag</a>(iprob) .lt. 100 ) <span class="keywordflow">then</span>     </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                   nhypox = 9</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                   nhypoz = 9</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                   phypox = 1./ 9.</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                   phypoz = 1./ 9.</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordflow">                 endif</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                 dirflag1 = 0</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordflow">                endif</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">c               Loop over hypocenter location along strike (aleatory)</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="keywordflow">do</span> 540 ihypox=1,nhypox,nhypoxstep</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                 <a class="code" href="declare1_8h.html#aab627860b1334a659f7e6a4b5f52c10b">fs</a> = float(ihypox) / (nhypox + 1.)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">c                Loop over hypocenter location down dip (aleatory)</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                 <span class="keywordflow">do</span> 530 ihypoz=1,nhypoz,nhypozstep</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                  <a class="code" href="declare1_8h.html#a5d8d3f66748cf4fe4b0d3197bcd36996">fd</a> = float(ihypoz) / (nhypoz + 1.)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">C                 Call to the rupture directivity Subroutine if applicable</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                  <span class="keywordflow">if</span> ( dirflag1 .eq. 1) <span class="keywordflow">then</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    <span class="keyword">call </span><a class="code" href="_directivity_8f.html#aee7013293458ae5aaff6869e8c0d0897">directivity</a> ( <a class="code" href="declare1_8h.html#abd7f7881d0a05c4b906e3e1c9734d6f0">dirflag</a>(iprob), spect(iprob), distrup<span class="comment">, ztor, </span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">     1                 <a class="code" href="declare1_8h.html#a71d0af8a6371efa7ae06a5f4c339dbee">x0</a>, <a class="code" href="declare1_8h.html#ad4740a3e0778226634e81c4b63e0561b">y0</a>, <a class="code" href="declare1_8h.html#aab01ece185838b5e4628d931daf5d322">z0</a>, rx, ry, ry0, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, <a class="code" href="declare1_8h.html#a41d11388bddf633f294d9e92f029ac8f">ftype</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iftype), rupwidth, </span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">     2                 <a class="code" href="declare1_8h.html#af620a16f1a6c7fb9dcec16a69b62cb4b">ruplen</a>, dipavgd, <a class="code" href="declare1_8h.html#ae137d003ca370f2cdcb9e33a7cf38376">hwflag</a>, dirmed, dirsigma, fltgrid_x, </span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">     3                 fltgrid_y, fltgrid_z, <a class="code" href="declare1_8h.html#aa679c260b6e1515b7222ae5af951c549">n1</a>, <a class="code" href="declare1_8h.html#ab0776af43fdd3fefc150053ee1cbeb50">n2</a>, <a class="code" href="declare1_8h.html#aab627860b1334a659f7e6a4b5f52c10b">fs</a>, <a class="code" href="declare1_8h.html#a5d8d3f66748cf4fe4b0d3197bcd36996">fd</a>, <a class="code" href="declare1_8h.html#ad12fc187a5753ac695211baa15062ed2">dpp_flag</a>, </span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">     4                 ilocx, ilocy)</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">     </span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">c                       write (44,&#39;( 6f8.2 )&#39;) mag, RupLen, fs, fd, dirMed, dirSigma</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">c                   Add directivity to median and sigma</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    lginten = lginten0 + dirmed</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    <span class="keywordflow">if</span> ( dirsigma .lt. 0. ) <span class="keywordflow">then</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                      <a class="code" href="declare1_8h.html#ac1bee4cff2b752e53bed901834cd659e">t1</a> = <a class="code" href="declare1_8h.html#a9368efafd606b3c4a2d53cd65addb2c4">sigma0</a>**2 - dirsigma**2</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                      <a class="code" href="declare1_8h.html#ac1bee4cff2b752e53bed901834cd659e">t1</a> = <a class="code" href="declare1_8h.html#a9368efafd606b3c4a2d53cd65addb2c4">sigma0</a>**2 + dirsigma**2</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">                    endif</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <span class="keywordflow">if</span> ( <a class="code" href="declare1_8h.html#ac1bee4cff2b752e53bed901834cd659e">t1</a> .lt. 0. ) <a class="code" href="declare1_8h.html#ac1bee4cff2b752e53bed901834cd659e">t1</a> = 0.01</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    sigmatotal = sqrt( <a class="code" href="declare1_8h.html#ac1bee4cff2b752e53bed901834cd659e">t1</a> )  </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keywordflow">                  endif</span> </div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  </div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">c                  Loop over test ground motion values                  </span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                   <span class="keywordflow">do</span> 510 jinten = 1, ninten(iprob)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">c                   Compute Probability of exceeding test  </span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <span class="keywordflow">if</span> ( imixture(iprob,jtype,iatten)  .eq. 0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                      <a class="code" href="declare1_8h.html#ac1240f0c81e82698783a8c47a1a1bd3e">prock</a> = <a class="code" href="declare1_8h.html#a7900585ea9bc15e566d138646e355756">pxceed3</a>(lginten, lgtestinten, sigmatotal,<span class="comment"> iprob,jinten,sigtrunc(iprob))</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">                    </span><span class="keywordflow">else</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                      <a class="code" href="declare1_8h.html#ae2a66bc8686333a036c01f5d16e03357">sigma1</a> = sigmatotal*0.8</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                      <a class="code" href="declare1_8h.html#ab0ffcf3d88d28e32eab24ea0a9b8d523">sigma2</a> = sigmatotal*1.2</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                      <a class="code" href="declare1_8h.html#ac1240f0c81e82698783a8c47a1a1bd3e">prock</a> = 0.5 * <a class="code" href="declare1_8h.html#a7900585ea9bc15e566d138646e355756">pxceed3</a>(lginten, lgtestinten, <a class="code" href="declare1_8h.html#ae2a66bc8686333a036c01f5d16e03357">sigma1</a><span class="comment">, iprob,jinten,sigtrunc(iprob))</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">     1                        +0.5 * <a class="code" href="declare1_8h.html#a7900585ea9bc15e566d138646e355756">pxceed3</a>(lginten, lgtestinten, <a class="code" href="declare1_8h.html#ab0ffcf3d88d28e32eab24ea0a9b8d523">sigma2</a>, iprob,jinten,sigtrunc(iprob))    </span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span><span class="keywordflow">                    endif</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">c                   Compute number of standard deviations (epsilon) to reach test level</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    <span class="keywordflow">if</span> (sigmatotal .le. 0.0001) <span class="keywordflow">then</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                      <a class="code" href="declare1_8h.html#a766f95696bccbc961a17db123ead7eb9">epsilon1</a> = 0.0</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                      <a class="code" href="declare1_8h.html#a766f95696bccbc961a17db123ead7eb9">epsilon1</a> = ( lgtestinten(iprob,jinten)-lginten )/sigmatotal</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">                    endif</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   </div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">c                   Set bin for epsilon deaggregation</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    <span class="keyword">call </span><a class="code" href="_h_a_z___i_n_t_8_f.html#adf0595aa69bb8d01b87c844292ce50c1">setbin_eps</a> ( nepsbins, epsbins, <a class="code" href="declare1_8h.html#a766f95696bccbc961a17db123ead7eb9">epsilon1</a>, iepsbin<span class="comment">)</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">                        </span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">c                   Loop over parameter variations (epistemic)</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    <span class="keywordflow">do</span> 500 iparam=1,nparamvar(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">c                    Set the weight for this set of parameters (epistemic)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                     <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> = rateparamwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iparam,ifltwidth) </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;     1                 * magrecurwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iparam,ifltwidth) </div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     2                 * faultwidthwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;     2                 * maxmagwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iparam,ifltwidth) </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;     2                 * <a class="code" href="declare1_8h.html#a3b31dc16594219f46063ccd767c834b9">ftype_wt</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iftype) </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">c                    Set up weight array for later output.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                     <a class="code" href="declare1_8h.html#aa80ddb724a8233255072a66f4a49a6d0">wtout</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iparam,ifltwidth,iftype) = <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         </div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">c                    Set probability of this earthquake (w/o gm) - (aleatory)</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                     p1 = pmag(iparam,ifltwidth)*parea*pwidth*plocx*plocy<span class="comment">(ilocy)</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">     1                    *phypox*phypoz*probsyn*synwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,<a class="code" href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a>)</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">                    </span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">c                    Set weights and probabilities for SourceType 7</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                     <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        p1 = 1.0</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> = 1.0</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keywordflow">                     endif</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">c                    Sum up probability (w/o ground motion) as a check</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                     <span class="keywordflow">if</span> ( iatten .eq. 1 .and. iprob .eq. 1 .and. jinten .eq.<span class="comment"> 1) </span><span class="keywordflow">then</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                       <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .ne. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                         <a class="code" href="declare1_8h.html#a63dc83e22f46d3d373540edf56306151">p1_sum</a> = <a class="code" href="declare1_8h.html#a63dc83e22f46d3d373540edf56306151">p1_sum</a> + <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a>*p1       </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                       <span class="keywordflow">elseif</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                         <a class="code" href="declare1_8h.html#a63dc83e22f46d3d373540edf56306151">p1_sum</a> = <a class="code" href="declare1_8h.html#a63dc83e22f46d3d373540edf56306151">p1_sum</a> + <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a>*p1/ncounts7(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)       </div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordflow">                       endif</span>                       </div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">                     endif</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                           </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">c                    Add weight for aleatory rupture segmentation</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                     <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> = <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> * al_segwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                     </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">c                    Compute Marginal Rate of Occurance</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                     <span class="keywordflow">if</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .ne. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                       mhaz = <a class="code" href="declare1_8h.html#af41dfce8deb9feb1269f69c692100d04">rate</a>(iparam,ifltwidth) * <a class="code" href="declare1_8h.html#ac1240f0c81e82698783a8c47a1a1bd3e">prock</a> * p1 * probact<span class="comment">(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)                       </span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">                       <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> = <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> *segwt1(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">                     </span><span class="keywordflow">elseif</span> (sourcetype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) .eq. 7) <span class="keywordflow">then</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                       mhaz = rates7(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,imag) * <a class="code" href="declare1_8h.html#ac1240f0c81e82698783a8c47a1a1bd3e">prock</a> * p1 * probact(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a><span class="comment">)</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span><span class="keywordflow">                     endif</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">c                    Add marginal rate of exceed to total</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                     haz(jinten,iprob,<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) = haz(jinten,iprob,<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) + mhaz<span class="comment">*<a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a>* <a class="code" href="declare1_8h.html#a8d2856e4279f9cb76c94192b1fb05671">gm_wt</a>(iprob,jtype,iatten)</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">                     </span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">                     hazbins(imagbin,idistbin,iepsbin,iprob,jinten) = </span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">     1                      hazbins(imagbin,idistbin,iepsbin,iprob,jinten) + dble(mhaz*<a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a>)</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">c  Note: directivity deaggregation was removed from this version</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">c                     HazBinsX(iXcost,iProb,jInten) = HazBinsX(iXcost,iProb,jInten) + dble(mHaz*wt)</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;     </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">c                    Add to mean deagg </span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                     <a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a> = <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> * <a class="code" href="declare1_8h.html#a8d2856e4279f9cb76c94192b1fb05671">gm_wt</a>(iprob,jtype,iatten)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                     <a class="code" href="declare1_8h.html#a9be97e5ce41416ace67ec17d5518fa5c">m_bar</a>(iprob,jinten) = <a class="code" href="declare1_8h.html#a9be97e5ce41416ace67ec17d5518fa5c">m_bar</a>(iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a><span class="comment">*magtotal</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">                     <a class="code" href="declare1_8h.html#a483b55ce3bc209449d5ae63e297c5deb">d_bar</a>(iprob,jinten) = <a class="code" href="declare1_8h.html#a483b55ce3bc209449d5ae63e297c5deb">d_bar</a>(iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*distrup</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">                     <a class="code" href="declare1_8h.html#a55c83755b4666c5d58f1be488ac6a9ea">e_bar</a>(iprob,jinten) = <a class="code" href="declare1_8h.html#a55c83755b4666c5d58f1be488ac6a9ea">e_bar</a>(iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*<a class="code" href="declare1_8h.html#a766f95696bccbc961a17db123ead7eb9">epsilon1</a></span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">                     xcost_bar(iprob,jinten) = xcost_bar(iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*<a class="code" href="declare1_8h.html#a949115b391df95c002a1212b5cc1a93b">xcost</a></span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">c                    Add to source deagg </span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                     <a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a> = <a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a> * <a class="code" href="declare1_8h.html#a8d2856e4279f9cb76c94192b1fb05671">gm_wt</a>(iprob,jtype,iatten)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                     m_bar_s(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) = m_bar_s(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten<span class="comment">) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*magtotal</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">                     <a class="code" href="declare1_8h.html#a5562580baa067ca8384674392b0b36e9">rrup_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) = <a class="code" href="declare1_8h.html#a5562580baa067ca8384674392b0b36e9">rrup_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*distrup</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">                     <a class="code" href="declare1_8h.html#af36e952aa7a050a230ac429ad69aa0c9">rjb_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) = <a class="code" href="declare1_8h.html#af36e952aa7a050a230ac429ad69aa0c9">rjb_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*distjb</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">                     <a class="code" href="declare1_8h.html#aded0d2d92d2d93d8e0302f5560248f16">rx_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) = <a class="code" href="declare1_8h.html#aded0d2d92d2d93d8e0302f5560248f16">rx_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*rx</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">                     <a class="code" href="declare1_8h.html#a406976e84daa9482be427d5e00521349">e_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) = <a class="code" href="declare1_8h.html#a406976e84daa9482be427d5e00521349">e_bar_s</a>(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iprob,jinten) + mhaz*<a class="code" href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a>*<a class="code" href="declare1_8h.html#a766f95696bccbc961a17db123ead7eb9">epsilon1</a></span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">c                    Save Marginal Hazard to temp array for fractile output</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                     temphaz(iparam,jinten,iprob,iatten,iftype) = mhaz</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;     1                        + temphaz(iparam,jinten,iprob,iatten,iftype<span class="comment">)</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">                     temphaz1(iparam,jinten,iprob,iftype) = mhaz* <a class="code" href="declare1_8h.html#a8d2856e4279f9cb76c94192b1fb05671">gm_wt</a>(iprob,jtype,iatten)</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">     1                        + temphaz1(iparam,jinten,iprob,iftype)</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">                     temphaz2(jtype, jinten,iprob,iatten) = mhaz*<a class="code" href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a></span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">     1                        + temphaz2(jtype, jinten,iprob,iatten)  </span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"> 500                </span><span class="keywordflow">continue</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; 510               <span class="keywordflow">continue</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; 530              <span class="keywordflow">continue</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; 540             <span class="keywordflow">continue</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; 549            <span class="keywordflow">continue</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; 550           <span class="keywordflow">continue</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; 560          <span class="keywordflow">continue</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; 561          <span class="keywordflow">continue</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; 600         <span class="keywordflow">continue</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; 650        <span class="keywordflow">continue</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; 651        <span class="keywordflow">continue</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; 700       <span class="keywordflow">continue</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; 750      <span class="keywordflow">continue</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">c         Compute the rate for this magnitude for each epistemic parameter variation</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          <span class="keywordflow">do</span> iparam=1,nparamvar(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <a class="code" href="declare1_8h.html#a6e15d38345bd553bfd04e7f8aaf3d84d">rout</a>(iparam,ifltwidth) = (<a class="code" href="declare1_8h.html#af41dfce8deb9feb1269f69c692100d04">rate</a>(iparam,ifltwidth)*pmag(iparam<span class="comment">,ifltwidth))</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"></span><span class="keywordflow">          enddo</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a> = minmag(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) + (imag-0.5) * magstep(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">c         Write out magnitude rates of occurrence (out2 file)</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">c         Not currently implemented for SourceType 7 cases.</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">c         Write header for the first magnitude only</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          <span class="keywordflow">if</span> (imag .eq. 1 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keyword">write</span> (17,<span class="stringliteral">&#39;( i5,2x,a80)&#39;</span>) <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, fname(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keyword">write</span> (17,<span class="stringliteral">&#39;( 2i5,&#39;</span><span class="stringliteral">&#39;  nMag, nParamVar&#39;</span><span class="stringliteral">&#39;)&#39;</span>) nmag(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nparamvar<span class="comment">(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth)</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">c           Set the weight for this set of parameters (epistemic)</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordflow">do</span> iparam=1,nparamvar(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth)</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;              <a class="code" href="declare1_8h.html#a33109d908fb7f41f9dd35fe856d66d7a">wt2</a>(iparam) = rateparamwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iparam,ifltwidth) </div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;     1                      * magrecurwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iparam,ifltwidth) </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;     2                      * maxmagwt(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,iparam,ifltwidth)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordflow">            enddo</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keyword">write</span> (17,<span class="stringliteral">&#39;( 100f10.6)&#39;</span>) (<a class="code" href="declare1_8h.html#a33109d908fb7f41f9dd35fe856d66d7a">wt2</a>(iparam),</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;     1            iparam=1,nparamvar(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth)) </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          <span class="keyword">write</span> (17,<span class="stringliteral">&#39;(2i4,f8.3,500e12.4)&#39;</span>) <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, ifltwidth, <a class="code" href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a>, </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;     1      (<a class="code" href="declare1_8h.html#a6e15d38345bd553bfd04e7f8aaf3d84d">rout</a>(iparam,ifltwidth), iparam=1,nparamvar(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>,ifltwidth))<span class="comment"> </span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"> 800     </span><span class="keywordflow">continue</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; 850     minrrup(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>) = minrrup_temp</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">c        Write temp Haz array to file</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;         <span class="keyword">call </span><a class="code" href="_f_r_i_s_k___i_o_8_f.html#afa07f976b714e1ede9eb80d916e796da">writetemphaz</a> ( temphaz, nparamvar, ninten, nprob, </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;     1        natten, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, attentype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nftype, ifltwidth, nwidth )</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;     </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;         <span class="keyword">call </span><a class="code" href="_f_r_i_s_k___i_o_8_f.html#afb3fd814f0d1fb1f8f21e44ed64464c8">writetemphaz1</a> ( temphaz1, nparamvar, ninten, nprob, </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;     1        natten, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, attentype(<a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>), nftype, ifltwidth, nwidth )</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; 860    <span class="keywordflow">continue</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">c       Write p1_sum as a check</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39; Site = &#39;</span><span class="stringliteral">&#39;,i5,2x,&#39;</span><span class="stringliteral">&#39; iFlt = &#39;</span><span class="stringliteral">&#39;,i5,&#39;</span><span class="stringliteral">&#39; p1sum =&#39;</span><span class="stringliteral">&#39;,f10.5, i5)&#39;</span><span class="comment">) <a class="code" href="declare1_8h.html#a5c1d5627a6babc1b812270c6c67fc8d8">isite</a>, <a class="code" href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a>, <a class="code" href="declare1_8h.html#a63dc83e22f46d3d373540edf56306151">p1_sum</a>, nflt</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"> 900   </span><span class="keywordflow">continue</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">c      close outfiles 1 and 2 for this site</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;       <span class="keyword">close</span> (11)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;       <span class="keyword">close</span> (17)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">c      Write out the mean Haz</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;       <span class="keyword">call </span><a class="code" href="_f_r_i_s_k___i_o_8_f.html#abb532610f97521aa4eea1a5ad080dd24">output_totalhaz</a> ( <a class="code" href="declare1_8h.html#a5c1d5627a6babc1b812270c6c67fc8d8">isite</a>, sitex, sitey, testinten, ninten,</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;     1       nflt, nprob, haz, fname, <a class="code" href="declare1_8h.html#a410bd95b31df40209024ee3bbe23d17e">jcalc</a>, sigtrunc, <a class="code" href="declare1_8h.html#acdf267ff86aeff7a4487026c57edb032">csrflag</a>,</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;     2       attenname, <a class="code" href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a>, probact, nwidth, <a class="code" href="declare1_8h.html#a9be97e5ce41416ace67ec17d5518fa5c">m_bar</a>, <a class="code" href="declare1_8h.html#a483b55ce3bc209449d5ae63e297c5deb">d_bar</a>, <a class="code" href="declare1_8h.html#a55c83755b4666c5d58f1be488ac6a9ea">e_bar</a>,</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;     3       hazbins, nmagbins, ndistbins, nepsbins, magbins, distbins,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;     4       epsbins, al_segwt, minrrup, nattentype, attentype,</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;     5       segwt1, <a class="code" href="declare1_8h.html#abd7f7881d0a05c4b906e3e1c9734d6f0">dirflag</a>, <a class="code" href="declare1_8h.html#a517f907056630086b6af03162cf0be09">tapflag</a>,<a class="code" href="declare1_8h.html#a9f56226b7d87511e6657cd5239df0a7b">intflag</a>, <a class="code" href="declare1_8h.html#ae3ac683bf28502a1ef78e8e1913ccd51">fsys</a>, sourcedist,</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     6       mmagout, <a class="code" href="declare1_8h.html#ab8dc92f3c64271288e049af5fc767504">hwflagout</a>, <a class="code" href="declare1_8h.html#a41d11388bddf633f294d9e92f029ac8f">ftype</a>, <a class="code" href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a>, nmaxmag2, mmagoutwt, spect)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">c      Write out the deagrregated hazard</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;       <span class="keyword">call </span><a class="code" href="_f_r_i_s_k___i_o_8_f.html#a384dc1e35a73edd23be722bc9e8f9c8a">output_hazbins</a> ( <a class="code" href="declare1_8h.html#a5c1d5627a6babc1b812270c6c67fc8d8">isite</a>, sitex, sitey, testinten, </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     1       ninten, nprob, hazbins, <a class="code" href="declare1_8h.html#a410bd95b31df40209024ee3bbe23d17e">jcalc</a>, sigtrunc, <a class="code" href="declare1_8h.html#acdf267ff86aeff7a4487026c57edb032">csrflag</a>,</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;     2       nmagbins, ndistbins, nepsbins, magbins, distbins, </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;     3       epsbins, attenname, <a class="code" href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a>, <a class="code" href="declare1_8h.html#a9be97e5ce41416ace67ec17d5518fa5c">m_bar</a>, <a class="code" href="declare1_8h.html#a483b55ce3bc209449d5ae63e297c5deb">d_bar</a>, <a class="code" href="declare1_8h.html#a55c83755b4666c5d58f1be488ac6a9ea">e_bar</a>,</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;     4       nattentype, attentype, xcost_bar, nxcostbins, </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;     5       xcostbins, hazbinsx)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;     </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;       <span class="keyword">call </span><a class="code" href="_f_r_i_s_k___i_o_8_f.html#ab38f0aab9bda8d709db93904173085fb">output_sourcedeagg</a> ( <a class="code" href="declare1_8h.html#a5c1d5627a6babc1b812270c6c67fc8d8">isite</a>, sitex, sitey, testinten, ninten,<span class="comment"> </span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">     1           nflt, haz, fname, m_bar_s, <a class="code" href="declare1_8h.html#a5562580baa067ca8384674392b0b36e9">rrup_bar_s</a>, <a class="code" href="declare1_8h.html#af36e952aa7a050a230ac429ad69aa0c9">rjb_bar_s</a>, </span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">     2           <a class="code" href="declare1_8h.html#aded0d2d92d2d93d8e0302f5560248f16">rx_bar_s</a>, <a class="code" href="declare1_8h.html#a406976e84daa9482be427d5e00521349">e_bar_s</a>, spect, nprob)</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">     </span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">       </span><span class="keyword">call </span><a class="code" href="_f_r_i_s_k___i_o_8_f.html#a7b16f282a3c78a2e055eed098ab2acc7">writetemphaz2</a> ( temphaz2, ninten, nprob, natten, nattentype <span class="comment">)</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"> 1000 </span><span class="keywordflow">continue</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; 2000 <span class="keywordflow">continue</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keyword">close</span> (77)</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;Normal termination&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      stop</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; 2100 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: number of sites&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      stop 99</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; 2101 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: site long lat line&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      stop 99</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; 2102 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: output file name&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      stop 99</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; 2103 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: output file name&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      stop 99</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; 2104 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: output file name&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      stop 99</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; 2105 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: output file name&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      stop 99</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; 2106 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: output file name&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      stop 99</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; 2107 <span class="keyword">write</span> (*,<span class="stringliteral">&#39;( 2x,&#39;</span><span class="stringliteral">&#39;input file error: output file name&#39;</span><span class="stringliteral">&#39;)&#39;</span>)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      stop 99 </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      </div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keyword">      end</span></div><div class="ttc" id="soil_a_mp_8f_html_a46c862201e5082cdcca6dfae8631bee3"><div class="ttname"><a href="soil_a_mp_8f.html#a46c862201e5082cdcca6dfae8631bee3">rdsoilampmodel</a></div><div class="ttdeci">subroutine rdsoilampmodel(refPeriod, nRefPer, RefGM, nRefGM, RefGM_mag, nRefMag, amp)</div><div class="ttdef"><b>Definition:</b> <a href="soil_a_mp_8f_source.html#l00111">soilAMp.f:111</a></div></div>
<div class="ttc" id="declare1_8h_html_a9f56226b7d87511e6657cd5239df0a7b"><div class="ttname"><a href="declare1_8h.html#a9f56226b7d87511e6657cd5239df0a7b">intflag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer intflag(4, MAX_PROB)</div></div>
<div class="ttc" id="declare1_8h_html_aa80ddb724a8233255072a66f4a49a6d0"><div class="ttname"><a href="declare1_8h.html#aa80ddb724a8233255072a66f4a49a6d0">wtout</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real wtout(MAX_FLT, MAXPARAM, MAX_WIDTH, MAX_FTYPE)</div></div>
<div class="ttc" id="declare1_8h_html_a76a5507f42e77638fdb653ff9e535d1a"><div class="ttname"><a href="declare1_8h.html#a76a5507f42e77638fdb653ff9e535d1a">iflt</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer iflt</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00027">declare1.h:27</a></div></div>
<div class="ttc" id="declare1_8h_html_acdf267ff86aeff7a4487026c57edb032"><div class="ttname"><a href="declare1_8h.html#acdf267ff86aeff7a4487026c57edb032">csrflag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer csrflag(MAX_PROB)</div></div>
<div class="ttc" id="declare1_8h_html_aab627860b1334a659f7e6a4b5f52c10b"><div class="ttname"><a href="declare1_8h.html#aab627860b1334a659f7e6a4b5f52c10b">fs</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real fs</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00047">declare1.h:47</a></div></div>
<div class="ttc" id="declare1_8h_html_a5562580baa067ca8384674392b0b36e9"><div class="ttname"><a href="declare1_8h.html#a5562580baa067ca8384674392b0b36e9">rrup_bar_s</a></div><div class="ttdeci">c Declarations for Main file real p1 real rrup_bar_s(MAX_FLT, MAX_PROB, MAX_INTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a4c02beb8d284d2138c43c13b57a685b4"><div class="ttname"><a href="declare1_8h.html#a4c02beb8d284d2138c43c13b57a685b4">grid_dx</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real grid_dx</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00047">declare1.h:47</a></div></div>
<div class="ttc" id="declare1_8h_html_aef655e8bd0b6a7a325a3a2e49f069ca9"><div class="ttname"><a href="declare1_8h.html#aef655e8bd0b6a7a325a3a2e49f069ca9">nfp</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer nfp(MAX_FLT)</div></div>
<div class="ttc" id="declare1_8h_html_aa3e140e21e64caab0d9b9c6974bdd63f"><div class="ttname"><a href="declare1_8h.html#aa3e140e21e64caab0d9b9c6974bdd63f">isyn</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer isyn</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00019">declare1.h:19</a></div></div>
<div class="ttc" id="set_rates_8f_html_a59e3a106b280231567cf7a6fa7a23ec7"><div class="ttname"><a href="set_rates_8f.html#a59e3a106b280231567cf7a6fa7a23ec7">set_rates</a></div><div class="ttdeci">subroutine set_rates(sourceType, nParamVar, magRecur, rate, beta</div><div class="ttdef"><b>Definition:</b> <a href="set_rates_8f_source.html#l00004">setRates.f:4</a></div></div>
<div class="ttc" id="declare1_8h_html_acf2c6029872515169abc461fd94ada4c"><div class="ttname"><a href="declare1_8h.html#acf2c6029872515169abc461fd94ada4c">minlat</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real minlat</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00076">declare1.h:76</a></div></div>
<div class="ttc" id="declare1_8h_html_a55c83755b4666c5d58f1be488ac6a9ea"><div class="ttname"><a href="declare1_8h.html#a55c83755b4666c5d58f1be488ac6a9ea">e_bar</a></div><div class="ttdeci">c Declarations for Main file real p1 real e_bar(MAX_PROB, MAX_INTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a3b31dc16594219f46063ccd767c834b9"><div class="ttname"><a href="declare1_8h.html#a3b31dc16594219f46063ccd767c834b9">ftype_wt</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real ftype_wt(MAX_FLT, MAX_N1) real fltGrid_x1(MAXFLT_DD</div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a308a2890c5536099d15bceaf77764e99"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a308a2890c5536099d15bceaf77764e99">inithaz</a></div><div class="ttdeci">subroutine inithaz(Haz)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00029">HAZ_INT.F:29</a></div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a7e34e0feef101f6a2b3b49fdffefe1e3"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a7e34e0feef101f6a2b3b49fdffefe1e3">initrup</a></div><div class="ttdeci">subroutine initrup(sigma, nValue, sigmaMax, step, iFlt)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00113">HAZ_INT.F:113</a></div></div>
<div class="ttc" id="declare1_8h_html_aa679c260b6e1515b7222ae5af951c549"><div class="ttname"><a href="declare1_8h.html#aa679c260b6e1515b7222ae5af951c549">n1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer n1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00019">declare1.h:19</a></div></div>
<div class="ttc" id="_n_p_r_o_b_8_f_html_a497834f5253c714a0f706900a78e1979"><div class="ttname"><a href="_n_p_r_o_b_8_f.html#a497834f5253c714a0f706900a78e1979">rupdimprob</a></div><div class="ttdeci">subroutine rupdimprob(sourceType, mag, coef, sigma, step, sigmaMax, rupDim, prob, iFlt, idim)</div><div class="ttdef"><b>Definition:</b> <a href="_n_p_r_o_b_8_f_source.html#l00114">NPROB.F:114</a></div></div>
<div class="ttc" id="calc_depth_prob_8f_html_af3db8f52363a70523bed3a93f4ce10aa"><div class="ttname"><a href="calc_depth_prob_8f.html#af3db8f52363a70523bed3a93f4ce10aa">calcdepthprob</a></div><div class="ttdeci">subroutine calcdepthprob(iDepthModel, depthParam, iFlt, pLocY, sourceType, nLocY, yStep, top, width, rupWidth, dip</div><div class="ttdef"><b>Definition:</b> <a href="calc_depth_prob_8f_source.html#l00003">calcDepthProb.f:3</a></div></div>
<div class="ttc" id="n_ruptures_8f_html_a0756b081bb6d950b457e511460b4edb4"><div class="ttname"><a href="n_ruptures_8f.html#a0756b081bb6d950b457e511460b4edb4">nlocycells</a></div><div class="ttdeci">subroutine nlocycells(iLocX, n1AS, sourceType, nLocX, distDensity, xStep,</div><div class="ttdef"><b>Definition:</b> <a href="n_ruptures_8f_source.html#l00147">nRuptures.f:147</a></div></div>
<div class="ttc" id="_f_l_t___s_e_g_8_f_html_aab478ba7e68ed436ebbfbdd869dffc8f"><div class="ttname"><a href="_f_l_t___s_e_g_8_f.html#aab478ba7e68ed436ebbfbdd869dffc8f">convertcoordinates2</a></div><div class="ttdeci">subroutine convertcoordinates2(nfp, iFlt, iCoor, grid_n, sourceTy</div><div class="ttdef"><b>Definition:</b> <a href="_f_l_t___s_e_g_8_f_source.html#l00003">FLT_SEG.F:3</a></div></div>
<div class="ttc" id="declare1_8h_html_a5d8d3f66748cf4fe4b0d3197bcd36996"><div class="ttname"><a href="declare1_8h.html#a5d8d3f66748cf4fe4b0d3197bcd36996">fd</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real fd</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00072">declare1.h:72</a></div></div>
<div class="ttc" id="_f_r_i_s_k___i_o_8_f_html_abb532610f97521aa4eea1a5ad080dd24"><div class="ttname"><a href="_f_r_i_s_k___i_o_8_f.html#abb532610f97521aa4eea1a5ad080dd24">output_totalhaz</a></div><div class="ttdeci">subroutine output_totalhaz(isite, sitex, sitey, ati, nInten, nFlt, nAtten, risk, fName, jCalc, sigTrunc, csrflag, attenName, period1, probAct, nWidth, m_bar, d_bar, e_bar, riskBins, nMagBins, nDistBins, nEpsBins, magBins, distBins, epsBins, al_segWt, MinRrup, nAttenType, attenType, segWt1, dirflag, tapflag, intflag, fsys, SourceDist, mMagout, hwflagout, ftype, vs, nmaxmag2, mMagoutwt, specT)</div><div class="ttdef"><b>Definition:</b> <a href="_f_r_i_s_k___i_o_8_f_source.html#l00440">FRISK_IO.F:440</a></div></div>
<div class="ttc" id="declare1_8h_html_ac1240f0c81e82698783a8c47a1a1bd3e"><div class="ttname"><a href="declare1_8h.html#ac1240f0c81e82698783a8c47a1a1bd3e">prock</a></div><div class="ttdeci">c Declarations for Main file real prock</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00004">declare1.h:4</a></div></div>
<div class="ttc" id="declare1_8h_html_a181beca2e69e4992945b0d841e1720ba"><div class="ttname"><a href="declare1_8h.html#a181beca2e69e4992945b0d841e1720ba">file2</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real version character file2</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00110">declare1.h:110</a></div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a67198046cc3c6ac91e0fe39511c77d53"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a67198046cc3c6ac91e0fe39511c77d53">init_temphaz</a></div><div class="ttdeci">subroutine init_temphaz(tempHaz)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00201">HAZ_INT.F:201</a></div></div>
<div class="ttc" id="declare1_8h_html_ac7814e6d7c48d05329788fa63414abf6"><div class="ttname"><a href="declare1_8h.html#ac7814e6d7c48d05329788fa63414abf6">grid_dlat</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real grid_dlat(MAX_FLT)</div></div>
<div class="ttc" id="_c_l_d_i_s_t_8_f_html_ad5235f6539b0c40547cd1a6ba228b7b6"><div class="ttname"><a href="_c_l_d_i_s_t_8_f.html#ad5235f6539b0c40547cd1a6ba228b7b6">calcdistdensity2</a></div><div class="ttdeci">subroutine calcdistdensity2(iFlt, grid_a, grid_n, distDensity2)</div><div class="ttdef"><b>Definition:</b> <a href="_c_l_d_i_s_t_8_f_source.html#l00675">CLDIST.F:675</a></div></div>
<div class="ttc" id="declare1_8h_html_aded0d2d92d2d93d8e0302f5560248f16"><div class="ttname"><a href="declare1_8h.html#aded0d2d92d2d93d8e0302f5560248f16">rx_bar_s</a></div><div class="ttdeci">c Declarations for Main file real p1 real rx_bar_s(MAX_FLT, MAX_PROB, MAX_INTEN)</div></div>
<div class="ttc" id="declare1_8h_html_ab0939c2d307f29c06bf84c21cb9da4d5"><div class="ttname"><a href="declare1_8h.html#ab0939c2d307f29c06bf84c21cb9da4d5">sigflag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer sigflag</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00034">declare1.h:34</a></div></div>
<div class="ttc" id="declare1_8h_html_a406976e84daa9482be427d5e00521349"><div class="ttname"><a href="declare1_8h.html#a406976e84daa9482be427d5e00521349">e_bar_s</a></div><div class="ttdeci">c Declarations for Main file real p1 real e_bar_s(MAX_FLT, MAX_PROB, MAX_INTEN) integer faultFlag(MAX_FLT</div></div>
<div class="ttc" id="declare1_8h_html_aab01ece185838b5e4628d931daf5d322"><div class="ttname"><a href="declare1_8h.html#aab01ece185838b5e4628d931daf5d322">z0</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real z0</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00080">declare1.h:80</a></div></div>
<div class="ttc" id="n_ruptures_8f_html_a7c4d9c5ac09568df519b750d5c23f71e"><div class="ttname"><a href="n_ruptures_8f.html#a7c4d9c5ac09568df519b750d5c23f71e">rupdims</a></div><div class="ttdeci">subroutine rupdims(sourceType, rupWidth, aveWidth, rupArea, faultLen,</div><div class="ttdef"><b>Definition:</b> <a href="n_ruptures_8f_source.html#l00002">nRuptures.f:2</a></div></div>
<div class="ttc" id="declare1_8h_html_aa0f8729ddc30f22e866790f5f9a91301"><div class="ttname"><a href="declare1_8h.html#aa0f8729ddc30f22e866790f5f9a91301">sigvaradd</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real sigvaradd(MAX_PROB, 4, MAX_ATTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a517f907056630086b6af03162cf0be09"><div class="ttname"><a href="declare1_8h.html#a517f907056630086b6af03162cf0be09">tapflag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer tapflag(MAX_PROB)</div></div>
<div class="ttc" id="declare1_8h_html_af620a16f1a6c7fb9dcec16a69b62cb4b"><div class="ttname"><a href="declare1_8h.html#af620a16f1a6c7fb9dcec16a69b62cb4b">ruplen</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real ruplen</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00061">declare1.h:61</a></div></div>
<div class="ttc" id="declare1_8h_html_af336fb56c8a9d14569f2b3400dd2a190"><div class="ttname"><a href="declare1_8h.html#af336fb56c8a9d14569f2b3400dd2a190">depthvs10</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real depthvs10</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00086">declare1.h:86</a></div></div>
<div class="ttc" id="declare1_8h_html_ab3c17a2c36893962139c274f6402f665"><div class="ttname"><a href="declare1_8h.html#ab3c17a2c36893962139c274f6402f665">magbar1</a></div><div class="ttdeci">c Declarations for Main file real magbar1(MAX_INTEN, MAX_PROB, MAX_FLT)</div></div>
<div class="ttc" id="declare1_8h_html_aebf5d3b1e17ff1b7b4565755387ecce4"><div class="ttname"><a href="declare1_8h.html#aebf5d3b1e17ff1b7b4565755387ecce4">wt1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real wt1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00046">declare1.h:46</a></div></div>
<div class="ttc" id="declare1_8h_html_a4993bfeb7bf0592c21f1d024b91c0f37"><div class="ttname"><a href="declare1_8h.html#a4993bfeb7bf0592c21f1d024b91c0f37">synchron</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer synchron(MAX_FLT)</div></div>
<div class="ttc" id="_f_r_i_s_k___i_o_8_f_html_a7b16f282a3c78a2e055eed098ab2acc7"><div class="ttname"><a href="_f_r_i_s_k___i_o_8_f.html#a7b16f282a3c78a2e055eed098ab2acc7">writetemphaz2</a></div><div class="ttdeci">subroutine writetemphaz2(tempHaz2, nInten, nProb, nAtten, natten</div><div class="ttdef"><b>Definition:</b> <a href="_f_r_i_s_k___i_o_8_f_source.html#l00407">FRISK_IO.F:407</a></div></div>
<div class="ttc" id="declare1_8h_html_ac29792c01f0cf1350ba99f381677e728"><div class="ttname"><a href="declare1_8h.html#ac29792c01f0cf1350ba99f381677e728">grid_x</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real grid_x(MAX_GRID)</div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a7ea2090dc25db51c6deaefbc19de656c"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a7ea2090dc25db51c6deaefbc19de656c">inithazbins</a></div><div class="ttdeci">subroutine inithazbins(HazBins)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00069">HAZ_INT.F:69</a></div></div>
<div class="ttc" id="declare1_8h_html_a3e3f1b96bdecca79e0f48ef1827f159f"><div class="ttname"><a href="declare1_8h.html#a3e3f1b96bdecca79e0f48ef1827f159f">grid_n</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer grid_n(MAX_FLT)</div></div>
<div class="ttc" id="declare1_8h_html_a6e15d38345bd553bfd04e7f8aaf3d84d"><div class="ttname"><a href="declare1_8h.html#a6e15d38345bd553bfd04e7f8aaf3d84d">rout</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real rout(MAXPARAM, MAX_WIDTH)</div></div>
<div class="ttc" id="declare1_8h_html_ae2a66bc8686333a036c01f5d16e03357"><div class="ttname"><a href="declare1_8h.html#ae2a66bc8686333a036c01f5d16e03357">sigma1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real sigma1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00046">declare1.h:46</a></div></div>
<div class="ttc" id="declare1_8h_html_a735a90a3885c309c9cf3c9db91b65e74"><div class="ttname"><a href="declare1_8h.html#a735a90a3885c309c9cf3c9db91b65e74">vs30_class</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer vs30_class</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00032">declare1.h:32</a></div></div>
<div class="ttc" id="_f_r_i_s_k___i_o_8_f_html_afb3fd814f0d1fb1f8f21e44ed64464c8"><div class="ttname"><a href="_f_r_i_s_k___i_o_8_f.html#afb3fd814f0d1fb1f8f21e44ed64464c8">writetemphaz1</a></div><div class="ttdeci">subroutine writetemphaz1(tempHaz1, nParamVar, nInten, nProb, nAtten, iFlt, jtype, nfType, iFltWidth, nWi</div><div class="ttdef"><b>Definition:</b> <a href="_f_r_i_s_k___i_o_8_f_source.html#l00378">FRISK_IO.F:378</a></div></div>
<div class="ttc" id="declare1_8h_html_a242f4a7d0c47d4064d14de06cef38bf9"><div class="ttname"><a href="declare1_8h.html#a242f4a7d0c47d4064d14de06cef38bf9">maxlat</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real maxlat</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00056">declare1.h:56</a></div></div>
<div class="ttc" id="declare1_8h_html_ab4688c7156ce33e6010ebd2a44c78548"><div class="ttname"><a href="declare1_8h.html#ab4688c7156ce33e6010ebd2a44c78548">distepi</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real distepi</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00081">declare1.h:81</a></div></div>
<div class="ttc" id="_c_l_d_i_s_t_8_f_html_a897604d95961a1162e0eb5377c74ba39"><div class="ttname"><a href="_c_l_d_i_s_t_8_f.html#a897604d95961a1162e0eb5377c74ba39">set_mindist</a></div><div class="ttdeci">subroutine set_mindist(sourceType, iFlt, iFltWidth, distRup, dist</div><div class="ttdef"><b>Definition:</b> <a href="_c_l_d_i_s_t_8_f_source.html#l00188">CLDIST.F:188</a></div></div>
<div class="ttc" id="declare1_8h_html_ad68a599654b791fd4e905213958feffa"><div class="ttname"><a href="declare1_8h.html#ad68a599654b791fd4e905213958feffa">distmax</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real distmax</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00047">declare1.h:47</a></div></div>
<div class="ttc" id="n_ruptures_8f_html_a95ef26cb609a77ec5e7afa5bf3eaf94a"><div class="ttname"><a href="n_ruptures_8f.html#a95ef26cb609a77ec5e7afa5bf3eaf94a">nlocxcells</a></div><div class="ttdeci">subroutine nlocxcells(sourceType, nLocXAS, grid_n, nfltgrid, fltgrid_w,</div><div class="ttdef"><b>Definition:</b> <a href="n_ruptures_8f_source.html#l00055">nRuptures.f:55</a></div></div>
<div class="ttc" id="_m_a_g_p_r_o_b_8_f_html_a3dba02c8de2d7b38554ec6500773e41e"><div class="ttname"><a href="_m_a_g_p_r_o_b_8_f.html#a3dba02c8de2d7b38554ec6500773e41e">magprob</a></div><div class="ttdeci">subroutine magprob(sourceType, mag, maxMag, minMag, magStep, bet</div><div class="ttdef"><b>Definition:</b> <a href="_m_a_g_p_r_o_b_8_f_source.html#l00003">MAGPROB.F:3</a></div></div>
<div class="ttc" id="declare1_8h_html_ad4740a3e0778226634e81c4b63e0561b"><div class="ttname"><a href="declare1_8h.html#ad4740a3e0778226634e81c4b63e0561b">y0</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real y0</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00080">declare1.h:80</a></div></div>
<div class="ttc" id="declare1_8h_html_ab8dc92f3c64271288e049af5fc767504"><div class="ttname"><a href="declare1_8h.html#ab8dc92f3c64271288e049af5fc767504">hwflagout</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer hwflagout(MAX_FLT)</div></div>
<div class="ttc" id="_c_l_d_i_s_t_8_f_html_aca394a081bb81b3f323377a68c4d563f"><div class="ttname"><a href="_c_l_d_i_s_t_8_f.html#aca394a081bb81b3f323377a68c4d563f">calcdistdensity1</a></div><div class="ttdeci">subroutine calcdistdensity1(iFlt, grid_a, grid_x, grid_y, grid_dx, grid_dy, grid_n, distDensity, dr, nr, x0, y0, step)</div><div class="ttdef"><b>Definition:</b> <a href="_c_l_d_i_s_t_8_f_source.html#l00628">CLDIST.F:628</a></div></div>
<div class="ttc" id="declare1_8h_html_a5497714c5ce92ebf65df0f94d8dc842b"><div class="ttname"><a href="declare1_8h.html#a5497714c5ce92ebf65df0f94d8dc842b">jcalc1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer jcalc1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00026">declare1.h:26</a></div></div>
<div class="ttc" id="declare1_8h_html_a432fec6382568ac38d40b8f38a2d6fb2"><div class="ttname"><a href="declare1_8h.html#a432fec6382568ac38d40b8f38a2d6fb2">wt</a></div><div class="ttdeci">c Declarations for Main file real wt</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00003">declare1.h:3</a></div></div>
<div class="ttc" id="declare1_8h_html_a33109d908fb7f41f9dd35fe856d66d7a"><div class="ttname"><a href="declare1_8h.html#a33109d908fb7f41f9dd35fe856d66d7a">wt2</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real wt2(MAXPARAM)</div></div>
<div class="ttc" id="declare1_8h_html_a71d0af8a6371efa7ae06a5f4c339dbee"><div class="ttname"><a href="declare1_8h.html#a71d0af8a6371efa7ae06a5f4c339dbee">x0</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real x0</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00080">declare1.h:80</a></div></div>
<div class="ttc" id="read_flt_8f_html_afac1d52d6a52371b9cb7c1cce1dc4052"><div class="ttname"><a href="read_flt_8f.html#afac1d52d6a52371b9cb7c1cce1dc4052">rd_fault_data</a></div><div class="ttdeci">subroutine rd_fault_data(nFlt, fName, minMag, magStep, hxStep, hyStep, segModelWt, rateParam, rateParamWt, beta, magRecur, magRecurWt, faultWidth, faultWidthWt, maxMag, maxMagWt, fLong, fLat, fZ, dip, nfp, nMag, ftype, sourceType, nRupArea, coef_area, sigArea, nRupWidth, coef_width, sigWidth, nParamVar, iCoor, minDepth, fIndex, probAct, nWidth, mpdf_param, al_segWt, attenType, sampleStep, grid_a, grid_dlong, grid_dlat, grid_n, grid_long, grid_lat, grid_top, minlat, maxlat, minlong, maxlong, scaleRate, fsys, mMagout, mMagoutWt, fltDirect, synchron, nsyn_Case, synjcalc, synmag, syndistRup, syndistJB, synDistSeismo, synHypo, synftype, synhwflag, synwt, RateType, iDepthModel, depthParam, nMaxMag2, segwt1, faultFlag, nDownDip, nFtype, ftype_wt, segModelFlag, nSegModel0, segModelWt1, syn_dip, syn_zTOR, syn_RupWidth, syn_RX, syn_Ry0, magS7, rateS7, DistS7, DipS7, mechS7, ncountS7, version)</div><div class="ttdef"><b>Definition:</b> <a href="read_flt_8f_source.html#l00018">readFlt.f:18</a></div></div>
<div class="ttc" id="_m_e_d___a_t_t_8_f_html_aea1ab22924576fa6d996e526e3c26455"><div class="ttname"><a href="_m_e_d___a_t_t_8_f.html#aea1ab22924576fa6d996e526e3c26455">meaninten</a></div><div class="ttdeci">subroutine meaninten(rupdist, jbdist, seismodist, hwflag, mag, jcalc, specT, lnY, siga, ftype, attenName, period1, iAtten,</div><div class="ttdef"><b>Definition:</b> <a href="_m_e_d___a_t_t_8_f_source.html#l00004">MED_ATT.F:4</a></div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a60868fa932f81c34d1b97a537b8ab600"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a60868fa932f81c34d1b97a537b8ab600">init_temphaz2</a></div><div class="ttdeci">subroutine init_temphaz2(tempHaz2)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00247">HAZ_INT.F:247</a></div></div>
<div class="ttc" id="declare1_8h_html_aa57cec099c60831e118b2a10f9c02a65"><div class="ttname"><a href="declare1_8h.html#aa57cec099c60831e118b2a10f9c02a65">mag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real mag</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00066">declare1.h:66</a></div></div>
<div class="ttc" id="declare1_8h_html_a818e5f1686e8c24880163724560fc71e"><div class="ttname"><a href="declare1_8h.html#a818e5f1686e8c24880163724560fc71e">disthypo</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real disthypo</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00081">declare1.h:81</a></div></div>
<div class="ttc" id="_f_r_i_s_k___i_o_8_f_html_afa07f976b714e1ede9eb80d916e796da"><div class="ttname"><a href="_f_r_i_s_k___i_o_8_f.html#afa07f976b714e1ede9eb80d916e796da">writetemphaz</a></div><div class="ttdeci">subroutine writetemphaz(tempHaz, nParamVar, nInten, nProb, nAtten, iFlt, jtype, nfType, iFltWidth, nWi</div><div class="ttdef"><b>Definition:</b> <a href="_f_r_i_s_k___i_o_8_f_source.html#l00350">FRISK_IO.F:350</a></div></div>
<div class="ttc" id="declare1_8h_html_af41dfce8deb9feb1269f69c692100d04"><div class="ttname"><a href="declare1_8h.html#af41dfce8deb9feb1269f69c692100d04">rate</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real rate(MAXPARAM, MAX_WIDTH)</div></div>
<div class="ttc" id="declare1_8h_html_afe6b9eb1b76d8b77cb67a3d64ecc8192"><div class="ttname"><a href="declare1_8h.html#afe6b9eb1b76d8b77cb67a3d64ecc8192">r_horiz</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real r_horiz</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00075">declare1.h:75</a></div></div>
<div class="ttc" id="declare1_8h_html_a49efe302003a6b9eae05c142ad7bee68"><div class="ttname"><a href="declare1_8h.html#a49efe302003a6b9eae05c142ad7bee68">synjcalc</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer synjcalc(MAX_FLT)</div></div>
<div class="ttc" id="declare1_8h_html_a109b7250162d39fb6bc1a2dba1ccb63c"><div class="ttname"><a href="declare1_8h.html#a109b7250162d39fb6bc1a2dba1ccb63c">beta</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real beta(MAX_FLT, MAXPARAM, MAX_WIDTH)</div></div>
<div class="ttc" id="declare1_8h_html_a949115b391df95c002a1212b5cc1a93b"><div class="ttname"><a href="declare1_8h.html#a949115b391df95c002a1212b5cc1a93b">xcost</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real xcost</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00072">declare1.h:72</a></div></div>
<div class="ttc" id="declare1_8h_html_af36e952aa7a050a230ac429ad69aa0c9"><div class="ttname"><a href="declare1_8h.html#af36e952aa7a050a230ac429ad69aa0c9">rjb_bar_s</a></div><div class="ttdeci">c Declarations for Main file real p1 real rjb_bar_s(MAX_FLT, MAX_PROB, MAX_INTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a63dc83e22f46d3d373540edf56306151"><div class="ttname"><a href="declare1_8h.html#a63dc83e22f46d3d373540edf56306151">p1_sum</a></div><div class="ttdeci">c Declarations for Main file real p1_sum</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00003">declare1.h:3</a></div></div>
<div class="ttc" id="declare1_8h_html_a4d1fadc3bb143444ccbafd19f9f6608f"><div class="ttname"><a href="declare1_8h.html#a4d1fadc3bb143444ccbafd19f9f6608f">grid_y</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real grid_y(MAX_GRID)</div></div>
<div class="ttc" id="declare1_8h_html_a621b5880f0f69cb2bdcbe9098e03ae68"><div class="ttname"><a href="declare1_8h.html#a621b5880f0f69cb2bdcbe9098e03ae68">grid_lat</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real grid_lat(MAX_FLT, MAX_GRID)</div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_ae0b7146cadcc5f221cb2420fa5e80035"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#ae0b7146cadcc5f221cb2420fa5e80035">setbin</a></div><div class="ttdeci">subroutine setbin(nBins, bins, x, iBin)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00133">HAZ_INT.F:133</a></div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a87f0bcb2ea7a26404b4eca6a5c229166"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a87f0bcb2ea7a26404b4eca6a5c229166">init_temphaz1</a></div><div class="ttdeci">subroutine init_temphaz1(tempHaz1)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00225">HAZ_INT.F:225</a></div></div>
<div class="ttc" id="declare1_8h_html_ad26adc037da6a1a656f973cb1a50c6ea"><div class="ttname"><a href="declare1_8h.html#ad26adc037da6a1a656f973cb1a50c6ea">phi</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real phi</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00046">declare1.h:46</a></div></div>
<div class="ttc" id="declare1_8h_html_a683215e4b6c04196fece3d7aa6101598"><div class="ttname"><a href="declare1_8h.html#a683215e4b6c04196fece3d7aa6101598">synhypo</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real synhypo(MAX_FLT, MAX_SYN)</div></div>
<div class="ttc" id="_f_l_t___s_e_g_8_f_html_acb54bc6f200fd4433a276321b6c766f5"><div class="ttname"><a href="_f_l_t___s_e_g_8_f.html#acb54bc6f200fd4433a276321b6c766f5">calcfltgrid</a></div><div class="ttdeci">subroutine calcfltgrid(xFlt, yFlt, zFlt, npts, nDD, fltGrid_x, f</div><div class="ttdef"><b>Definition:</b> <a href="_f_l_t___s_e_g_8_f_source.html#l00134">FLT_SEG.F:134</a></div></div>
<div class="ttc" id="declare1_8h_html_ae3ac683bf28502a1ef78e8e1913ccd51"><div class="ttname"><a href="declare1_8h.html#ae3ac683bf28502a1ef78e8e1913ccd51">fsys</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer fsys(MAX_FLT)</div></div>
<div class="ttc" id="declare1_8h_html_a13272b35692a94da98328a2080bc28cb"><div class="ttname"><a href="declare1_8h.html#a13272b35692a94da98328a2080bc28cb">scalc1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer scalc1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00029">declare1.h:29</a></div></div>
<div class="ttc" id="declare1_8h_html_a0241efdf3af12d1e4bf3bc94e885e342"><div class="ttname"><a href="declare1_8h.html#a0241efdf3af12d1e4bf3bc94e885e342">tau</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real tau</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00046">declare1.h:46</a></div></div>
<div class="ttc" id="_f_r_i_s_k___i_o_8_f_html_ab38f0aab9bda8d709db93904173085fb"><div class="ttname"><a href="_f_r_i_s_k___i_o_8_f.html#ab38f0aab9bda8d709db93904173085fb">output_sourcedeagg</a></div><div class="ttdeci">subroutine output_sourcedeagg(isite, sitex, sitey, ati, nInten, nFlt, risk, fName, m_bar_s, rrup_bar_s, rjb_bar_s, rx_bar_s, e_bar_s, specT, nProb)</div><div class="ttdef"><b>Definition:</b> <a href="_f_r_i_s_k___i_o_8_f_source.html#l00870">FRISK_IO.F:870</a></div></div>
<div class="ttc" id="_c_l_d_i_s_t_8_f_html_a63f1f22519010ec96c7bf9dca162d235"><div class="ttname"><a href="_c_l_d_i_s_t_8_f.html#a63f1f22519010ec96c7bf9dca162d235">calcdist</a></div><div class="ttdeci">subroutine calcdist(sourceType, pscorflag, nFltGrid, n1AS, iLocX,</div><div class="ttdef"><b>Definition:</b> <a href="_c_l_d_i_s_t_8_f_source.html#l00003">CLDIST.F:3</a></div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a4c0fe0342b61f0175a97ddf8e0b4aff8"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a4c0fe0342b61f0175a97ddf8e0b4aff8">initmindis</a></div><div class="ttdeci">subroutine initmindis(iFlt, nWidth, MinRrup_temp, MinRjb_temp, MinSeismo_temp, SourceDist)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00006">HAZ_INT.F:6</a></div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a5ccff40ae584ce39ba40d72491e00a03"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a5ccff40ae584ce39ba40d72491e00a03">initdeagg</a></div><div class="ttdeci">subroutine initdeagg(m_bar, d_bar, e_bar, Xcost_bar)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00269">HAZ_INT.F:269</a></div></div>
<div class="ttc" id="declare1_8h_html_a4993f66c79e366a66dc779a31d901dc8"><div class="ttname"><a href="declare1_8h.html#a4993f66c79e366a66dc779a31d901dc8">bnum</a></div><div class="ttdeci">c Declarations for Main file real p1 real bnum</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00017">declare1.h:17</a></div></div>
<div class="ttc" id="declare1_8h_html_a10ef7108e44be6f52a2aceba2df4f3d9"><div class="ttname"><a href="declare1_8h.html#a10ef7108e44be6f52a2aceba2df4f3d9">sigfix</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real sigfix(MAX_PROB, 4, MAX_ATTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a3c54f442fbfc3e628e14322e5f5a8525"><div class="ttname"><a href="declare1_8h.html#a3c54f442fbfc3e628e14322e5f5a8525">coeff_width</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real coeff_width(2, MAX_FLT)</div></div>
<div class="ttc" id="declare1_8h_html_ada53fa3b9c8c6ef4223c57edd666b701"><div class="ttname"><a href="declare1_8h.html#ada53fa3b9c8c6ef4223c57edd666b701">grid_dy</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real grid_dy</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00047">declare1.h:47</a></div></div>
<div class="ttc" id="declare1_8h_html_ad12fc187a5753ac695211baa15062ed2"><div class="ttname"><a href="declare1_8h.html#ad12fc187a5753ac695211baa15062ed2">dpp_flag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer dpp_flag</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00019">declare1.h:19</a></div></div>
<div class="ttc" id="declare1_8h_html_af9d535bac255a5f3e7c1d35fd33fff07"><div class="ttname"><a href="declare1_8h.html#af9d535bac255a5f3e7c1d35fd33fff07">grid_top</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real grid_top(MAX_FLT, MAX_GRID)</div></div>
<div class="ttc" id="_f_l_t___s_e_g_8_f_html_a73f366d31b28bc5306b15f004864572b"><div class="ttname"><a href="_f_l_t___s_e_g_8_f.html#a73f366d31b28bc5306b15f004864572b">setfltbottom</a></div><div class="ttdeci">subroutine setfltbottom(iCoor, iFlt, nfp, dip2, faultThick, fZ, flat, flong, nDD)</div><div class="ttdef"><b>Definition:</b> <a href="_f_l_t___s_e_g_8_f_source.html#l00374">FLT_SEG.F:374</a></div></div>
<div class="ttc" id="declare1_8h_html_a7900585ea9bc15e566d138646e355756"><div class="ttname"><a href="declare1_8h.html#a7900585ea9bc15e566d138646e355756">pxceed3</a></div><div class="ttdeci">c Declarations for Main file real p1 real pxceed3</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00008">declare1.h:8</a></div></div>
<div class="ttc" id="_directivity_8f_html_aee7013293458ae5aaff6869e8c0d0897"><div class="ttname"><a href="_directivity_8f.html#aee7013293458ae5aaff6869e8c0d0897">directivity</a></div><div class="ttdeci">subroutine directivity(dirFlag, specT, Rrup, ZTOR, x0, y0, z0, Rx, Ry, Ry0, mag, ftype, RupWidth, RupLength, dipavgd, HWflag, dirMed, dirSigma, fltgrid_x, fltgrid_y, fltgrid_z, n1, n2, fs, fd, dpp_flag, iLocAS, iLocDD)</div><div class="ttdef"><b>Definition:</b> <a href="_directivity_8f_source.html#l00035">Directivity.f:35</a></div></div>
<div class="ttc" id="declare1_8h_html_a41d11388bddf633f294d9e92f029ac8f"><div class="ttname"><a href="declare1_8h.html#a41d11388bddf633f294d9e92f029ac8f">ftype</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real ftype(MAX_FLT, MAX_N1)</div></div>
<div class="ttc" id="_f_r_i_s_k___i_o_8_f_html_af017351a3d205ac37caf9ef1feaba62f"><div class="ttname"><a href="_f_r_i_s_k___i_o_8_f.html#af017351a3d205ac37caf9ef1feaba62f">rdinput</a></div><div class="ttdeci">subroutine rdinput(nProb, nAttenType, nAtten, jcalc, specT, sigT</div><div class="ttdef"><b>Definition:</b> <a href="_f_r_i_s_k___i_o_8_f_source.html#l00003">FRISK_IO.F:3</a></div></div>
<div class="ttc" id="declare1_8h_html_ab0776af43fdd3fefc150053ee1cbeb50"><div class="ttname"><a href="declare1_8h.html#ab0776af43fdd3fefc150053ee1cbeb50">n2</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer n2</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00019">declare1.h:19</a></div></div>
<div class="ttc" id="declare1_8h_html_a483b55ce3bc209449d5ae63e297c5deb"><div class="ttname"><a href="declare1_8h.html#a483b55ce3bc209449d5ae63e297c5deb">d_bar</a></div><div class="ttdeci">c Declarations for Main file real p1 real d_bar(MAX_PROB, MAX_INTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a660eed0839e8efa3f34828c3cec4b74b"><div class="ttname"><a href="declare1_8h.html#a660eed0839e8efa3f34828c3cec4b74b">period1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real period1(4, MAX_PROB)</div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_a2012499d2e334818adbf827174debca1"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#a2012499d2e334818adbf827174debca1">initdeagg2</a></div><div class="ttdeci">subroutine initdeagg2(m_bar_s, rrup_bar_s, rjb_bar_s, rx_bar_s,</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00292">HAZ_INT.F:292</a></div></div>
<div class="ttc" id="declare1_8h_html_ab0ffcf3d88d28e32eab24ea0a9b8d523"><div class="ttname"><a href="declare1_8h.html#ab0ffcf3d88d28e32eab24ea0a9b8d523">sigma2</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real sigma2</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00046">declare1.h:46</a></div></div>
<div class="ttc" id="declare1_8h_html_ae7444da6139dba32972fdea32a60c864"><div class="ttname"><a href="declare1_8h.html#ae7444da6139dba32972fdea32a60c864">vs</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vs</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00073">declare1.h:73</a></div></div>
<div class="ttc" id="declare1_8h_html_ab254a325c9227352c2c928fb8a3ae9dc"><div class="ttname"><a href="declare1_8h.html#ab254a325c9227352c2c928fb8a3ae9dc">amp</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real amp(MAX_AMPMAG, MAX_AMPPER, MAX_AMPGM)</div></div>
<div class="ttc" id="declare1_8h_html_a766f95696bccbc961a17db123ead7eb9"><div class="ttname"><a href="declare1_8h.html#a766f95696bccbc961a17db123ead7eb9">epsilon1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real epsilon1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00071">declare1.h:71</a></div></div>
<div class="ttc" id="declare1_8h_html_af5a1f56d0aa084f97ea066cd3831cc38"><div class="ttname"><a href="declare1_8h.html#af5a1f56d0aa084f97ea066cd3831cc38">temp</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real temp</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00047">declare1.h:47</a></div></div>
<div class="ttc" id="declare1_8h_html_ae137d003ca370f2cdcb9e33a7cf38376"><div class="ttname"><a href="declare1_8h.html#ae137d003ca370f2cdcb9e33a7cf38376">hwflag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer hwflag</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00024">declare1.h:24</a></div></div>
<div class="ttc" id="declare1_8h_html_a61a71fe6610eb2c5afb0acd3b413dab1"><div class="ttname"><a href="declare1_8h.html#a61a71fe6610eb2c5afb0acd3b413dab1">grid_dlong</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real grid_dlong(MAX_FLT)</div></div>
<div class="ttc" id="_f_r_i_s_k___i_o_8_f_html_a384dc1e35a73edd23be722bc9e8f9c8a"><div class="ttname"><a href="_f_r_i_s_k___i_o_8_f.html#a384dc1e35a73edd23be722bc9e8f9c8a">output_hazbins</a></div><div class="ttdeci">subroutine output_hazbins(isite, sitex, sitey, testInten, nInten, nProb, riskBins, jCalc, sigTrunc, csrflag, nMagBins, nDistBins, nEpsBins, magBins, distBins, epsBins, attenName, period1, m_bar, d_bar, e_bar, nAttenType, attenType, Xcost_bar, nXcostBins, XcostBins, RiskBinsX)</div><div class="ttdef"><b>Definition:</b> <a href="_f_r_i_s_k___i_o_8_f_source.html#l00620">FRISK_IO.F:620</a></div></div>
<div class="ttc" id="declare1_8h_html_abff3261f6e5846a446bf1b376826c3d1"><div class="ttname"><a href="declare1_8h.html#abff3261f6e5846a446bf1b376826c3d1">minlong</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real minlong</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00096">declare1.h:96</a></div></div>
<div class="ttc" id="declare1_8h_html_a6de059b03ce46fea2b044778c4cce2b2"><div class="ttname"><a href="declare1_8h.html#a6de059b03ce46fea2b044778c4cce2b2">maxlong</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real maxlong</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00096">declare1.h:96</a></div></div>
<div class="ttc" id="declare1_8h_html_ac1bee4cff2b752e53bed901834cd659e"><div class="ttname"><a href="declare1_8h.html#ac1bee4cff2b752e53bed901834cd659e">t1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real t1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00047">declare1.h:47</a></div></div>
<div class="ttc" id="declare1_8h_html_a9be97e5ce41416ace67ec17d5518fa5c"><div class="ttname"><a href="declare1_8h.html#a9be97e5ce41416ace67ec17d5518fa5c">m_bar</a></div><div class="ttdeci">c Declarations for Main file real p1 real m_bar(MAX_PROB, MAX_INTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a8d2856e4279f9cb76c94192b1fb05671"><div class="ttname"><a href="declare1_8h.html#a8d2856e4279f9cb76c94192b1fb05671">gm_wt</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real gm_wt(MAX_PROB, 4, MAX_ATTEN)</div></div>
<div class="ttc" id="declare1_8h_html_a9368efafd606b3c4a2d53cd65addb2c4"><div class="ttname"><a href="declare1_8h.html#a9368efafd606b3c4a2d53cd65addb2c4">sigma0</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigma0</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00047">declare1.h:47</a></div></div>
<div class="ttc" id="declare1_8h_html_a0803428660b8e9cfe79908b8f2b4ea07"><div class="ttname"><a href="declare1_8h.html#a0803428660b8e9cfe79908b8f2b4ea07">dip</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real dip(MAX_FLT, MAX_WIDTH, MAX_SEG)</div></div>
<div class="ttc" id="declare1_8h_html_a05f375bddbe7c60e72f2a514bc646cf7"><div class="ttname"><a href="declare1_8h.html#a05f375bddbe7c60e72f2a514bc646cf7">file1</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real version character file1</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00110">declare1.h:110</a></div></div>
<div class="ttc" id="declare1_8h_html_ac3732a33ca1b52c1d2ef65e3d0c3a463"><div class="ttname"><a href="declare1_8h.html#ac3732a33ca1b52c1d2ef65e3d0c3a463">depthvs15</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real depthvs15</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00087">declare1.h:87</a></div></div>
<div class="ttc" id="declare1_8h_html_a5c1d5627a6babc1b812270c6c67fc8d8"><div class="ttname"><a href="declare1_8h.html#a5c1d5627a6babc1b812270c6c67fc8d8">isite</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer isite</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00025">declare1.h:25</a></div></div>
<div class="ttc" id="declare1_8h_html_a410bd95b31df40209024ee3bbe23d17e"><div class="ttname"><a href="declare1_8h.html#a410bd95b31df40209024ee3bbe23d17e">jcalc</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer jcalc(MAX_PROB, 4, MAX_ATTEN)</div></div>
<div class="ttc" id="_c_l_d_i_s_t_8_f_html_a147e663185c6a1e545027b6ae1c9de90"><div class="ttname"><a href="_c_l_d_i_s_t_8_f.html#a147e663185c6a1e545027b6ae1c9de90">calcdistdensity</a></div><div class="ttdeci">subroutine calcdistdensity(nPts, xFlt2, yFlt2, distDensity, dr, nr, x0, y0, step)</div><div class="ttdef"><b>Definition:</b> <a href="_c_l_d_i_s_t_8_f_source.html#l00549">CLDIST.F:549</a></div></div>
<div class="ttc" id="declare1_8h_html_abd7f7881d0a05c4b906e3e1c9734d6f0"><div class="ttname"><a href="declare1_8h.html#abd7f7881d0a05c4b906e3e1c9734d6f0">dirflag</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer dirflag(MAX_PROB)</div></div>
<div class="ttc" id="declare1_8h_html_a9fe9aaa1a53974ce93603abe5f18d41f"><div class="ttname"><a href="declare1_8h.html#a9fe9aaa1a53974ce93603abe5f18d41f">cfcoefrrup</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real cfcoefrrup(MAX_ATTEN, 11)</div></div>
<div class="ttc" id="declare1_8h_html_a6c17d53e638d70c9937f813616a6a81a"><div class="ttname"><a href="declare1_8h.html#a6c17d53e638d70c9937f813616a6a81a">syn_dip</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real vrup real syn_dip(MAX_FLT, MAX_SYN)</div></div>
<div class="ttc" id="declare1_8h_html_a95f5f61f5d8cf50c3e5cdd4e0d98bf19"><div class="ttname"><a href="declare1_8h.html#a95f5f61f5d8cf50c3e5cdd4e0d98bf19">grid_long</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real grid_long(MAX_FLT, MAX_GRID)</div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_ab9286506a5078127ed5eb07a04293de7"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#ab9286506a5078127ed5eb07a04293de7">inithazbinsx</a></div><div class="ttdeci">subroutine inithazbinsx(HazBinsX)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00093">HAZ_INT.F:93</a></div></div>
<div class="ttc" id="declare1_8h_html_a91816cd48ef58bc937222bbdd0490818"><div class="ttname"><a href="declare1_8h.html#a91816cd48ef58bc937222bbdd0490818">ibnum</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer ibnum</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00019">declare1.h:19</a></div></div>
<div class="ttc" id="declare1_8h_html_ad69b99d30a7a73ac256ae5f310a4e826"><div class="ttname"><a href="declare1_8h.html#ad69b99d30a7a73ac256ae5f310a4e826">bnumflag</a></div><div class="ttdeci">c Declarations for Main file real p1 real bnumflag</div><div class="ttdef"><b>Definition:</b> <a href="declare1_8h_source.html#l00017">declare1.h:17</a></div></div>
<div class="ttc" id="_h_a_z___m_a_i_n2_8f_html_a5c89e38a3011dfa8bae06bdd27304888"><div class="ttname"><a href="_h_a_z___m_a_i_n2_8f.html#a5c89e38a3011dfa8bae06bdd27304888">haz45_2</a></div><div class="ttdeci">program haz45_2</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___m_a_i_n2_8f_source.html#l00001">HAZ_MAIN2.f:1</a></div></div>
<div class="ttc" id="_h_a_z___i_n_t_8_f_html_adf0595aa69bb8d01b87c844292ce50c1"><div class="ttname"><a href="_h_a_z___i_n_t_8_f.html#adf0595aa69bb8d01b87c844292ce50c1">setbin_eps</a></div><div class="ttdeci">subroutine setbin_eps(nBins, bins, x, iBin)</div><div class="ttdef"><b>Definition:</b> <a href="_h_a_z___i_n_t_8_f_source.html#l00167">HAZ_INT.F:167</a></div></div>
<div class="ttc" id="declare1_8h_html_a2713f4e8b84f0415af10eaa0131d4fad"><div class="ttname"><a href="declare1_8h.html#a2713f4e8b84f0415af10eaa0131d4fad">mpdf_param</a></div><div class="ttdeci">c Declarations for Main file real p1 real rup1_flag integer iAtten integer foreARc integer nn10000 real dipavgd real probSyn real sigfix1 real mpdf_param(MAX_FLT, MAXPARAM, MAX_WIDTH, 6)</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_501bdb11da9e3ff85a05ee91b220e720.html">Git</a></li><li class="navelem"><a class="el" href="dir_fb0652c5df5b9249afd6543e61919164.html">HAZ</a></li><li class="navelem"><a class="el" href="dir_892b289c2f584a2bd261aaf29ea15680.html">HAZ files</a></li><li class="navelem"><a class="el" href="_h_a_z___m_a_i_n2_8f.html">HAZ_MAIN2.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
